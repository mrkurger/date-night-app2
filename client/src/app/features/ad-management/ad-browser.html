<div class="container-fluid ad-browser">
  <div class="row mb-3">
    <div class="col">
      <h2>Browse Ads</h2>
    </div>
    <div class="col text-right">
      <button class="btn btn-outline-primary" ng-click="toggleViewMode()">
        <i class="fa" ng-class="{'fa-th': currentViewMode === viewModes.SWIPE, 'fa-exchange-alt': currentViewMode === viewModes.GRID}"></i>
        {{ currentViewMode === viewModes.GRID ? 'Swipe View' : 'Grid View' }}
      </button>
    </div>
  </div>
  
  <div class="row mb-3">
    <div class="col-md-6">
      <div class="input-group">
        <select class="form-control" ng-model="selectedCounty">
          <option value="">All Counties</option>
          <option ng-repeat="county in counties" value="{{county}}">{{county}}</option>
        </select>
        <div class="input-group-append">
          <button class="btn btn-primary" ng-click="filterByCounty()">Filter</button>
        </div>
      </div>
    </div>
    <div class="col-md-6 text-right">
      <button class="btn btn-info" ng-click="searchNearby()">
        <i class="fa fa-map-marker-alt"></i> Find Nearby
      </button>
    </div>
  </div>
  
  <div ng-if="error" class="alert alert-danger">
    {{ error }}
  </div>
  
  <div ng-if="loading" class="text-center">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>
  
  <!-- Grid view -->
  <div ng-if="currentViewMode === viewModes.GRID && !loading" class="row">
    <div class="col-md-4 col-lg-3 mb-4" ng-repeat="ad in ads">
      <div class="card h-100">
        <img ng-src="{{ ad.profileImage }}" class="card-img-top" alt="{{ ad.title }}">
        <div class="card-body">
          <h5 class="card-title">{{ ad.title }}</h5>
          <p class="card-text text-muted">{{ ad.county }}</p>
          <p class="card-text">{{ ad.description | limitTo: 100 }}{{ ad.description.length > 100 ? '...' : '' }}</p>
        </div>
        <div class="card-footer d-flex justify-content-between">
          <button class="btn btn-sm" ng-class="{'btn-danger': isFavorite(ad), 'btn-outline-danger': !isFavorite(ad)}" ng-click="toggleFavorite(ad)">
            <i class="fa" ng-class="{'fa-heart': isFavorite(ad), 'fa-heart-o': !isFavorite(ad)}"></i>
          </button>
          <button class="btn btn-sm btn-primary" ng-click="viewAdDetails(ad._id)">View Details</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Swipe view -->
  <div ng-if="currentViewMode === viewModes.SWIPE && !loading" class="swipe-container">
    <div ng-if="ads.length === 0" class="text-center my-5">
      <p>No ads available to display.</p>
    </div>
    
    <div ng-if="ads.length > 0" class="swipe-card">
      <img ng-src="{{ getCurrentAd().profileImage }}" class="card-img-top" alt="{{ getCurrentAd().title }}">
      <div class="card-body">
        <h3>{{ getCurrentAd().title }}</h3>
        <p class="text-muted">{{ getCurrentAd().county }}</p>
        <p>{{ getCurrentAd().description }}</p>
      </div>
      <div class="swipe-actions">
        <button class="btn btn-lg btn-outline-danger" ng-click="swipeLeft()">
          <i class="fa fa-times"></i>
        </button>
        <button class="btn btn-lg btn-outline-success" ng-click="swipeRight()">
          <i class="fa fa-heart"></i>
        </button>
      </div>
    </div>
    
    <div class="text-center mt-3">
      <p>Card {{ currentIndex + 1 }} of {{ ads.length }}</p>
    </div>
  </div>
</div>
