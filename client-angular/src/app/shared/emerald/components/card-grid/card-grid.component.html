<!-- Emerald CardGrid Component -->
<!-- Documentation: https://docs-emerald.condorlabs.io/CardGrid -->

<!-- Loading State -->
<div *ngIf="loading" class="emerald-card-grid" [ngStyle]="getGridStyle()">
  <div *ngFor="let i of getSkeletonArray()" class="emerald-card-grid__item" [ngClass]="{'emerald-card-grid__item--animated': animated}">
    <emerald-skeleton-loader type="card" [animated]="true"></emerald-skeleton-loader>
  </div>
</div>

<!-- Netflix Layout -->
<div *ngIf="!loading && layout === 'netflix'" class="emerald-card-grid emerald-card-grid--netflix">
  <div class="emerald-card-grid__netflix-row">
    <div class="emerald-card-grid__netflix-items">
      <div *ngFor="let item of items" 
           class="emerald-card-grid__item emerald-card-grid__item--netflix"
           [ngClass]="{'emerald-card-grid__item--animated': animated}"
           [style.margin-right.px]="gap"
           (click)="onItemClick(item)">
        <ng-container *ngIf="itemTemplate; else defaultTemplate">
          <ng-container *ngTemplateOutlet="itemTemplate; context: { $implicit: item }"></ng-container>
        </ng-container>
        <ng-template #defaultTemplate>
          <emerald-app-card *ngIf="item.title" [ad]="item" layout="netflix"></emerald-app-card>
          <div *ngIf="!item.title" class="emerald-card-grid__default-item">
            {{ item.name || item.label || 'Item' }}
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>

<!-- Grid or Masonry Layout -->
<div *ngIf="!loading && layout !== 'netflix'" 
     class="emerald-card-grid"
     [ngClass]="{'emerald-card-grid--masonry': layout === 'masonry'}"
     [ngStyle]="getGridStyle()">
  <div *ngFor="let item of items" 
       class="emerald-card-grid__item"
       [ngClass]="{'emerald-card-grid__item--animated': animated, 'emerald-card-grid__item--masonry': layout === 'masonry'}"
       (click)="onItemClick(item)">
    <ng-container *ngIf="itemTemplate; else defaultTemplate">
      <ng-container *ngTemplateOutlet="itemTemplate; context: { $implicit: item }"></ng-container>
    </ng-container>
    <ng-template #defaultTemplate>
      <emerald-app-card *ngIf="item.title" [ad]="item" layout="netflix"></emerald-app-card>
      <div *ngIf="!item.title" class="emerald-card-grid__default-item">
        {{ item.name || item.label || 'Item' }}
      </div>
    </ng-template>
  </div>
</div>

<!-- Empty State -->
<div *ngIf="!loading && items.length === 0" class="emerald-card-grid__empty">
  <div class="emerald-card-grid__empty-content">
    <i class="fas fa-search"></i>
    <p>No items found</p>
  </div>
</div>