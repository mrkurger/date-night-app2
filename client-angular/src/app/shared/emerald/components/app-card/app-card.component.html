<!-- Emerald AppCard Component -->
<!-- Documentation: https://docs-emerald.condorlabs.io/AppCard -->

<div
  class="nb-card"
  [ngClass]="{
    'nb-card--tinder': layout === 'tinder',
    'nb-card--netflix': layout === 'netflix',
    'nb-card--list': layout === 'list',
  }"
  (click)="onViewDetails()"
>
  <!-- Card Background Image -->
  <div class="nb-card__media" [style.background-image]="'url(' + backgroundImageUrl + ')'">
    <!-- Online/Offline Status Label -->
    <div
      class="nb-card__status-label"
      [ngClass]="{
        'nb-card__status-label--online': isOnline,
        'nb-card__status-label--offline': !isOnline,
      }"
    >
      <span class="nb-card__status-indicator"></span>
      <span class="nb-card__status-text">{{ isOnline ? 'Online' : 'Offline' }}</span>
    </div>

    <!-- Media Navigation Dots -->
    <div class="nb-card__media-dots" *ngIf="getMediaCount() > 1">
      <div
        *ngFor="let dot of getMediaDots(); let i = index"
        class="nb-card__media-dot"
        [ngClass]="{ 'nb-card__media-dot--active': i === currentMediaIndex }"
        (click)="
          $event.stopPropagation(); currentMediaIndex = i; backgroundImageUrl = getCurrentMediaUrl()
        "
      ></div>
    </div>

    <!-- Media Navigation Buttons -->
    <button
      *ngIf="getMediaCount() > 1"
      class="nb-card__media-nav nb-card__media-nav--prev"
      (click)="prevMedia($event)"
      aria-label="Previous image"
    >
      <i class="fas fa-chevron-left"></i>
    </button>
    <button
      *ngIf="getMediaCount() > 1"
      class="nb-card__media-nav nb-card__media-nav--next"
      (click)="nextMedia($event)"
      aria-label="Next image"
    >
      <i class="fas fa-chevron-right"></i>
    </button>

    <!-- Content Overlay with Blur Effect -->
    <div class="nb-card__content-overlay">
      <div class="nb-card__content">
        <h3 class="nb-card__title" *ngIf="ad">{{ ad.title }}</h3>
        <h3 class="nb-card__title" *ngIf="!ad">Untitled</h3>

        <div class="nb-card__meta" *ngIf="ad">
          <div class="nb-card__location" *ngIf="ad.location">
            <i class="fas fa-map-marker-alt"></i>
            <span>{{ ad.location }}</span>
          </div>

          <div class="nb-card__price" *ngIf="ad.price">
            <i class="fas fa-tag"></i>
            <span>{{ formatPrice(ad.price) }}</span>
          </div>
        </div>

        <p class="nb-card__description" *ngIf="ad && showDescription && ad.description">
          {{ getTruncatedDescription() }}
        </p>
      </div>
    </div>
  </div>

  <!-- Card Actions -->
  <div class="nb-card__actions" *ngIf="showActions">
    <!-- Bottom Left Floating Action Button -->
    <button
      class="nb-card__fab nb-card__fab--left"
      (click)="onLike($event)"
      aria-label="Like"
    >
      <i class="fas fa-heart"></i>
    </button>

    <!-- Bottom Right Floating Action Button -->
    <button
      class="nb-card__fab nb-card__fab--right"
      (click)="onChat($event)"
      aria-label="Chat"
    >
      <i class="fas fa-comment"></i>
    </button>

    <!-- Tinder-specific Swipe Actions -->
    <div class="nb-card__swipe-actions" *ngIf="layout === 'tinder'">
      <button
        class="nb-card__swipe-button nb-card__swipe-button--left"
        (click)="onSwipe('left', $event)"
        aria-label="Swipe left"
      >
        <i class="fas fa-times"></i>
      </button>
      <button
        class="nb-card__swipe-button nb-card__swipe-button--right"
        (click)="onSwipe('right', $event)"
        aria-label="Swipe right"
      >
        <i class="fas fa-heart"></i>
      </button>
    </div>
  </div>
</div>
