@use '@nebular/theme/styles/theming' as *;
@use 'sass:color';

// Floating Action Button Component Styles
// Using Nebular theme variables

// Container for positioning the FAB
.nb-fab-container {
  position: fixed;
  z-index: nb-theme(z-index-fixed);

  // Position variants
  &--bottom-right {
    right: nb-theme(layout-padding);
    bottom: nb-theme(layout-padding);
  }

  &--bottom-left {
    left: nb-theme(layout-padding);
    bottom: nb-theme(layout-padding);
  }

  &--top-right {
    right: nb-theme(layout-padding);
    top: nb-theme(layout-padding);
  }

  &--top-left {
    left: nb-theme(layout-padding);
    top: nb-theme(layout-padding);
  }

  &--center {
    left: 50%;
    bottom: nb-theme(layout-padding);
    transform: translateX(-50%);
  }
}

// Main FAB button
.nb-fab {
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  border: none;
  box-shadow: nb-theme(shadow-md);
  cursor: pointer;
  transition:
    transform 0.3s ease,
    background-color 0.3s ease,
    box-shadow 0.3s ease;
  position: relative;
  z-index: 30;

  // Default size (medium)
  width: 56px;
  height: 56px;

  nb-icon {
    font-size: 1.25rem;
    color: nb-theme(text-control-color);
  }

  // Size variants
  &--small {
    width: 40px;
    height: 40px;

    nb-icon {
      font-size: 1rem;
    }
  }

  &--large {
    width: 72px;
    height: 72px;

    nb-icon {
      font-size: 1.5rem;
    }
  }

  // Color variants
  &--primary {
    background-color: nb-theme(color-primary-500);

    &:hover:not(:disabled) {
      background-color: nb-theme(color-primary-600);
    }
  }

  &--secondary {
    background-color: nb-theme(color-info-500);

    &:hover:not(:disabled) {
      background-color: nb-theme(color-info-600);
    }
  }

  &--success {
    background-color: nb-theme(color-success-500);

    &:hover:not(:disabled) {
      background-color: nb-theme(color-success-600);
    }
  }

  &--danger {
    background-color: nb-theme(color-danger-500);

    &:hover:not(:disabled) {
      background-color: nb-theme(color-danger-600);
    }
  }

  &--warning {
    background-color: nb-theme(color-warning-500);

    &:hover:not(:disabled) {
      background-color: nb-theme(color-warning-600);
    }

    nb-icon {
      color: nb-theme(text-basic-color);
    }
  }

  &--info {
    background-color: nb-theme(color-info-500);

    &:hover:not(:disabled) {
      background-color: nb-theme(color-info-600);
    }
  }

  // Hover and focus states
  &:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: nb-theme(shadow-lg);
  }

  &:focus {
    outline: none;
    box-shadow:
      0 0 0 3px rgba(nb-theme(color-primary-500), 0.3),
      nb-theme(shadow-md);
  }

  // Disabled state
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    box-shadow: nb-theme(shadow-sm);
  }

  // Open state (when menu is open)
  &--open {
    transform: rotate(45deg);

    &:hover {
      transform: rotate(45deg) translateY(-2px);
    }
  }

  // Tooltip is handled by Nebular's nbTooltip directive
}

// FAB Menu
.nb-fab-menu {
  position: absolute;
  display: flex;
  flex-direction: column;
  gap: nb-theme(layout-small-padding);
  z-index: 20;
  pointer-events: none;

  // Position variants
  &--bottom-right,
  &--top-right {
    right: 0;
  }

  &--bottom-left,
  &--top-left {
    left: 0;
  }

  &--bottom-right,
  &--bottom-left {
    bottom: 72px; // Position above the main FAB
  }

  &--top-right,
  &--top-left {
    top: 72px; // Position below the main FAB
  }

  &--center {
    bottom: 72px;
    left: 50%;
    transform: translateX(-50%);
  }

  // Menu items
  &__item {
    display: flex;
    align-items: center;
    padding: nb-theme(button-filled-medium-padding);
    border-radius: nb-theme(btn-round-border-radius);
    border: none;
    background-color: nb-theme(background-basic-color-1);
    color: nb-theme(text-basic-color);
    box-shadow: nb-theme(shadow-sm);
    cursor: pointer;
    transition:
      transform 0.2s ease,
      background-color 0.2s ease;
    opacity: 0;
    transform: scale(0.8) translateY(20px);
    pointer-events: none;

    nb-icon {
      margin-right: nb-theme(layout-small-padding);
    }

    // Color variants
    &--primary {
      nb-icon {
        color: nb-theme(color-primary-500);
      }

      &:hover {
        background-color: rgba(nb-theme(color-primary-500), 0.1);
      }
    }

    &--secondary {
      nb-icon {
        color: nb-theme(color-info-500);
      }

      &:hover {
        background-color: rgba(nb-theme(color-info-500), 0.1);
      }
    }

    &--success {
      nb-icon {
        color: nb-theme(color-success-500);
      }

      &:hover {
        background-color: rgba(nb-theme(color-success-500), 0.1);
      }
    }

    &--danger {
      nb-icon {
        color: nb-theme(color-danger-500);
      }

      &:hover {
        background-color: rgba(nb-theme(color-danger-500), 0.1);
      }
    }

    &--warning {
      nb-icon {
        color: nb-theme(color-warning-500);
      }

      &:hover {
        background-color: rgba(nb-theme(color-warning-500), 0.1);
      }
    }

    &--info {
      nb-icon {
        color: nb-theme(color-info-500);
      }

      &:hover {
        background-color: rgba(nb-theme(color-info-500), 0.1);
      }
    }

    &:hover {
      transform: translateY(-2px);
    }

    &:focus {
      outline: none;
      box-shadow:
        0 0 0 2px rgba(nb-theme(color-primary-500), 0.3),
        nb-theme(shadow-md);
    }
  }

  // Menu item label
  &__item-label {
    font-size: 0.875rem;
    font-weight: 500;
    white-space: nowrap;
  }

  // Open state
  &--open {
    pointer-events: auto;

    .nb-fab-menu__item {
      opacity: 1;
      transform: scale(1) translateY(0);
      pointer-events: auto;

      // Staggered animation for menu items
      @for $i from 1 through 10 {
        &:nth-child(#{$i}) {
          transition-delay: #{$i * 0.05}s;
        }
      }
    }
  }
}

// Backdrop for closing menu when clicking outside
.nb-fab-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 10;
  background-color: transparent;
}

// Responsive adjustments
@media (max-width: 640px) {
  .nb-fab-container {
    &--bottom-right,
    &--bottom-left,
    &--top-right,
    &--top-left {
      margin: nb-theme(layout-small-padding);
    }
  }

  .nb-fab {
    &--large {
      width: 64px;
      height: 64px;
    }
  }

  .nb-fab-menu {
    &__item-label {
      display: none;
    }

    &__item {
      padding: nb-theme(layout-small-padding);

      nb-icon {
        margin-right: 0;
      }
    }
  }
}
