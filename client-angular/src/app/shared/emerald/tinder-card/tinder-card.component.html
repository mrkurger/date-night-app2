<div class="emerald-tinder-card" [ngClass]="{'emerald-tinder-card--like': state === 'like', 'emerald-tinder-card--dislike': state === 'dislike'}">
  <!-- Card Media Section -->
  <div class="emerald-tinder-card__media">
    <!-- Video Media -->
    <div *ngIf="isCurrentMediaVideo()" class="emerald-tinder-card__video-container">
      <video controls>
        <source [src]="getCurrentMediaUrl()" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
    
    <!-- Image Media -->
    <img *ngIf="!isCurrentMediaVideo()" 
         [src]="getCurrentMediaUrl()" 
         [alt]="title" 
         class="emerald-tinder-card__image">

    <!-- Media Navigation Dots -->
    <div class="emerald-tinder-card__media-dots" *ngIf="media && media.length > 1">
      <div *ngFor="let dot of getMediaDots(); let i = index"
           class="emerald-tinder-card__media-dot"
           [ngClass]="{'emerald-tinder-card__media-dot--active': i === currentMediaIndex}"
           (click)="setMediaIndex(i, $event)">
      </div>
    </div>

    <!-- Media Navigation Arrows -->
    <button *ngIf="media && media.length > 1"
            class="emerald-tinder-card__media-nav-button emerald-tinder-card__media-nav-button--prev"
            (click)="prevMedia($event)"
            aria-label="Previous media">
      <i class="fas fa-chevron-left"></i>
    </button>
    <button *ngIf="media && media.length > 1"
            class="emerald-tinder-card__media-nav-button emerald-tinder-card__media-nav-button--next"
            (click)="nextMedia($event)"
            aria-label="Next media">
      <i class="fas fa-chevron-right"></i>
    </button>

    <!-- Like/Dislike Indicators -->
    <div class="emerald-tinder-card__like-indicator">
      <i class="fas fa-heart"></i>
      <span>LIKE</span>
    </div>
    <div class="emerald-tinder-card__dislike-indicator">
      <i class="fas fa-times"></i>
      <span>NOPE</span>
    </div>
  </div>

  <!-- Card Content -->
  <div class="emerald-tinder-card__content">
    <!-- Card Header -->
    <div class="emerald-tinder-card__header">
      <h2 class="emerald-tinder-card__title">
        {{ title }}
        <span class="emerald-tinder-card__age" *ngIf="age">{{ age }}</span>
      </h2>
      <p class="emerald-tinder-card__subtitle" *ngIf="subtitle">
        <i class="fas fa-map-marker-alt"></i> {{ subtitle }}
      </p>
    </div>

    <!-- Card Body -->
    <div class="emerald-tinder-card__body">
      <p class="emerald-tinder-card__description">{{ description }}</p>

      <!-- Tags -->
      <div class="emerald-tinder-card__tags" *ngIf="tags && tags.length">
        <emerald-label *ngFor="let tag of tags.slice(0, 5)"
                      [text]="tag"
                      size="small"
                      color="secondary">
        </emerald-label>
      </div>
    </div>

    <!-- Card Footer with Action Buttons -->
    <div class="emerald-tinder-card__footer">
      <ng-container *ngIf="actions && actions.length; else defaultActions">
        <button *ngFor="let action of actions"
                class="emerald-tinder-card__action-button"
                [ngClass]="'emerald-tinder-card__action-button--' + action.id"
                [title]="action.tooltip || ''"
                (click)="$event.stopPropagation(); onActionClick(action.id)">
          <i [class]="action.icon"></i>
        </button>
      </ng-container>
      
      <ng-template #defaultActions>
        <button class="emerald-tinder-card__action-button emerald-tinder-card__action-button--info"
                title="View Details"
                (click)="$event.stopPropagation(); onActionClick('info')">
          <i class="fas fa-info-circle"></i>
        </button>
        <button class="emerald-tinder-card__action-button emerald-tinder-card__action-button--dislike"
                title="Dislike"
                (click)="$event.stopPropagation(); onSwipe('left')">
          <i class="fas fa-times"></i>
        </button>
        <button class="emerald-tinder-card__action-button emerald-tinder-card__action-button--like"
                title="Like"
                (click)="$event.stopPropagation(); onSwipe('right')">
          <i class="fas fa-heart"></i>
        </button>
        <button class="emerald-tinder-card__action-button emerald-tinder-card__action-button--chat"
                title="Start Chat"
                (click)="$event.stopPropagation(); onActionClick('chat')">
          <i class="fas fa-comment"></i>
        </button>
      </ng-template>
    </div>
  </div>
</div>