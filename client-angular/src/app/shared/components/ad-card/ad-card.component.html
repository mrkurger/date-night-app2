<div
  class="ad-card"
  [ngClass]="{
    'ad-card-list': layout === 'list',
    'ad-card-compact': layout === 'compact',
    'ad-card-featured': isFeatured,
    'ad-card-new': isNew,
    'ad-card-trending': isTrending,
  }"
  (click)="onViewDetails()"
>
  <!-- Card Media Section -->
  <div class="ad-card-media">
    <!-- Primary Image -->
    <img
      [src]="getPrimaryImage()"
      [alt]="ad.title"
      class="ad-card-image"
      (error)="onImageError($event)"
    />

    <!-- Image Count Badge -->
    <div class="image-count" *ngIf="getImageCount() > 1">
      <mat-icon>photo_library</mat-icon>
      <span>{{ getImageCount() }}</span>
    </div>

    <!-- Status Badges -->
    <div class="status-badges" *ngIf="showBadges">
      <span class="badge badge-featured" *ngIf="isFeatured">Featured</span>
      <span class="badge badge-new" *ngIf="isNew">New</span>
      <span class="badge badge-trending" *ngIf="isTrending">Trending</span>
      <span class="badge badge-touring" *ngIf="ad.isTouring">Touring</span>
    </div>

    <!-- Category Badge -->
    <div class="category-badge" *ngIf="ad.category && showBadges">
      <span class="badge">{{ ad.category }}</span>
    </div>

    <!-- Price Badge -->
    <div class="price-badge" *ngIf="ad.price">
      <span class="badge badge-price">{{ formatPrice(ad.price) }}</span>
    </div>
  </div>

  <!-- Card Content Section -->
  <div class="ad-card-content">
    <div class="ad-card-header">
      <h3 class="ad-card-title">{{ ad.title }}</h3>

      <!-- Location -->
      <p class="ad-card-location" *ngIf="ad.location && showLocation">
        <mat-icon>location_on</mat-icon>
        <span>{{ ad.location }}</span>
      </p>
    </div>

    <!-- Description -->
    <p class="ad-card-description" *ngIf="showDescription && ad.description">
      {{ getTruncatedDescription() }}
    </p>

    <!-- Tags -->
    <div class="ad-card-tags" *ngIf="ad.tags && ad.tags.length > 0 && showDescription">
      <span class="tag" *ngFor="let tag of ad.tags.slice(0, 3)">{{ tag }}</span>
      <span class="tag more-tag" *ngIf="ad.tags.length > 3">+{{ ad.tags.length - 3 }}</span>
    </div>

    <!-- Card Footer -->
    <div class="ad-card-footer">
      <!-- Meta Information -->
      <div class="ad-card-meta">
        <span class="ad-card-date" *ngIf="ad.createdAt">
          <mat-icon>access_time</mat-icon>
          {{ getTimeSince() }}
        </span>

        <span class="ad-card-views" *ngIf="ad.viewCount">
          <mat-icon>visibility</mat-icon>
          {{ ad.viewCount }}
        </span>
      </div>

      <!-- Action Buttons -->
      <div class="ad-card-actions" *ngIf="showActions">
        <button mat-icon-button color="primary" matTooltip="View Details" (click)="onViewDetails()">
          <mat-icon>info</mat-icon>
        </button>

        <button
          mat-icon-button
          color="accent"
          matTooltip="Add to Favorites"
          (click)="onLike($event)"
        >
          <mat-icon>favorite_border</mat-icon>
        </button>

        <button mat-icon-button color="primary" matTooltip="Start Chat" (click)="onChat($event)">
          <mat-icon>chat</mat-icon>
        </button>

        <button mat-icon-button matTooltip="Share" (click)="onShare($event)">
          <mat-icon>share</mat-icon>
        </button>
      </div>
    </div>
  </div>
</div>
