<p-panel styleClass="layout-main">
  <!-- Header -->
  <div class="header-container">
    <!-- Logo -->
    <div class="logo-container">
      <a routerLink="/" class="logo"> Sensual<span class="text-pink">Meet</span> </a>
    </div>

    <!-- Desktop Navigation -->
    <nav class="desktop-navigation">
      <p-toolbar>
        <div class="p-d-flex">
          <p-button
            styleClass="p-button-text"
            routerLink="/advertiser-browsing-alt/browse"
            [style]="{ 'margin-right': '.5rem' }"
            routerLinkActive="p-button-secondary"
            label="Browse"
          >
          </p-button>
          <p-button
            styleClass="p-button-text"
            routerLink="/advertiser-browsing-alt/favorites"
            [style]="{ 'margin-right': '.5rem' }"
            routerLinkActive="p-button-secondary"
            label="Favorites"
          >
          </p-button>
          <p-button
            styleClass="p-button-text"
            [style]="{ 'margin-right': '.5rem' }"
            icon="pi pi-chart-bar"
            [pTooltip]="'Rankings'"
            (onClick)="menu.toggle($event)"
          >
            <p-tieredMenu #menu [popup]="true" [model]="rankingsMenu"></p-tieredMenu>
          </p-button>

          <div class="p-ml-auto">
            <!-- User Profile Menu -->
            <div class="user-menu" *ngIf="isLoggedIn; else loginButtons">
              <p-menu #userMenu [popup]="true" [model]="userMenuAccount" appendTo="body"></p-menu>
              <p-button
                styleClass="p-button-text p-button-rounded"
                (onClick)="userMenu.toggle($event)"
              >
                <img [src]="userPicture" class="user-avatar" [alt]="userName" />
                <span class="username">{{ userName }}</span>
              </p-button>
            </div>
            <ng-template #loginButtons>
              <p-button
                styleClass="p-button-text"
                routerLink="/auth/login"
                label="Log In"
              ></p-button>
              <p-button
                styleClass="p-button-outlined"
                routerLink="/auth/signup"
                label="Sign Up"
              ></p-button>
            </ng-template>
          </div>
        </div>
      </p-toolbar>
    </nav>

    <!-- Mobile Navigation -->
    <div class="mobile-navigation">
      <p-button icon="pi pi-bars" styleClass="p-button-text" (onClick)="mobilemenu.toggle($event)">
      </p-button>
      <p-tieredMenu #mobilemenu [popup]="true" [model]="mobileMenuItems"></p-tieredMenu>
    </div>
  </div>

  <!-- Main Content -->
  <div class="layout-content">
    <div class="content-container">
      <div class="search-pane">
        <!-- Search Bar -->
        <form (ngSubmit)="handleSearch($event)" class="search-form">
          <span class="p-float-label">
            <input
              id="search"
              type="text"
              pInputText
              [(ngModel)]="searchQuery"
              name="search"
              (input)="onSearchInput()"
              [style]="{ width: '100%' }"
            />
            <label for="search">Search advertisers...</label>
          </span>
          <p-button
            type="submit"
            icon="pi pi-search"
            styleClass="p-button-rounded p-button-text"
          ></p-button>
          <p-button
            *ngIf="isSearchingResult"
            icon="pi pi-times"
            styleClass="p-button-rounded p-button-text"
            (onClick)="clearSearch()"
            pTooltip="Clear search"
          >
          </p-button>
        </form>

        <!-- Title for search/location -->
        <div *ngIf="pageTitle" class="page-context-title">
          <h2>{{ pageTitle }}</h2>
          <p *ngIf="searchResultCount !== null" class="text-hint">
            Found {{ searchResultCount }} advertisers
          </p>
        </div>

        <!-- Premium Ads Section -->
        <app-alt-premium-ads-section
          [premiumAds]="premiumAds"
          *ngIf="
            premiumAds.length > 0 &&
            (!isSearchingResult || (isSearchingResult && premiumAds.length > 0))
          "
        ></app-alt-premium-ads-section>

        <!-- Dynamic View Content -->
        <p-tabView [(activeIndex)]="activeIndex" (activeIndexChange)="onViewChange($event)">
          <p-tabPanel header="Grid" *ngIf="activeView === 'grid'">
            <app-alt-netflix-view
              [advertisers]="displayedAdvertisers"
              [loading]="isLoading"
              (favorite)="onAdvertiserFavorite($event)"
              (chat)="onAdvertiserChat($event)"
              (viewProfile)="onAdvertiserProfile($event)"
            >
            </app-alt-netflix-view>
          </p-tabPanel>

          <p-tabPanel header="Cards" *ngIf="activeView === 'cards'">
            <app-alt-tinder-view
              [advertisers]="displayedAdvertisers"
              [loading]="isLoading"
              (like)="onAdvertiserLike($event)"
              (nope)="onAdvertiserNope($event)"
              (info)="onAdvertiserProfile($event)"
              (refresh)="onRefreshAdvertisers()"
            >
            </app-alt-tinder-view>
          </p-tabPanel>

          <p-tabPanel header="Map" *ngIf="activeView === 'map'">
            <p class="placeholder-text">Map view is coming soon!</p>
          </p-tabPanel>

          <p-tabPanel header="Nearby" *ngIf="activeView === 'nearby'">
            <p class="placeholder-text">Nearby view is coming soon!</p>
          </p-tabPanel>

          <p-tabPanel header="Featured" *ngIf="activeView === 'featured'">
            <p class="placeholder-text">Featured view is coming soon!</p>
          </p-tabPanel>
        </p-tabView>
      </div>

      <div class="sidebar-pane">
        <app-alt-paid-placement-sidebar [ads]="paidPlacementAds"></app-alt-paid-placement-sidebar>
      </div>
    </div>

    <app-alt-chat-widget></app-alt-chat-widget>
  </div>

  <!-- Footer -->
  <div class="footer-container">
    <p class="footer-copyright-text">Â© {{ currentYear }} HT Services. All rights reserved.</p>
    <div class="footer-links">
      <a routerLink="/terms-alt" class="footer-link">Terms</a>
      <a routerLink="/privacy-alt" class="footer-link">Privacy</a>
      <a routerLink="/contact-alt" class="footer-link">Contact</a>
    </div>
  </div>
</p-panel>
