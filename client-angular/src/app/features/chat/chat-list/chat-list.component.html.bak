<div class="chat-list">
  <!-- Header -->
  <div class="chat-list__header">
    <h1 class="chat-list__title">Messages</h1>
    <button class="chat-list__new-chat" (click)="createNewChat()">
      <i class="icon-add"></i>
      <span>New Chat</span>
    </button>
  </div>

  <!-- Loading State -->
  <div class="chat-list__loading" *ngIf="loading">
    <div class="spinner"></div>
    <div>Loading conversations...</div>
  </div>

  <!-- Error State -->
  <div class="chat-list__error" *ngIf="error && !loading">
    <div class="error-message">
      <i class="icon-error"></i>
      <p>Failed to load conversations</p>
      <button class="btn btn--primary" (click)="loadRooms()">Retry</button>
    </div>
  </div>

  <!-- Empty State -->
  <div class="chat-list__empty" *ngIf="!loading && !error && rooms.length === 0">
    <div class="chat-list__empty-icon">
      <i class="icon-chat"></i>
    </div>
    <div class="chat-list__empty-text">No conversations yet</div>
    <button class="btn btn--primary" (click)="createNewChat()">Start a new conversation</button>
  </div>

  <!-- Room List -->
  <div class="chat-list__rooms" *ngIf="!loading && !error && rooms.length > 0">
    <div
      class="chat-room-item"
      *ngFor="let room of rooms"
      [class.unread]="hasUnreadMessages(room)"
      [class.pinned]="room.pinned"
      (click)="goToRoom(room._id)"
    >
      <!-- Room Avatar -->
      <div class="chat-room-item__avatar">
        <img src="/assets/img/default-profile.jpg" [alt]="getOtherUserName(room)" />
        <span class="chat-room-item__status" [class.online]="true"></span>
      </div>

      <!-- Room Details -->
      <div class="chat-room-item__details">
        <div class="chat-room-item__header">
          <div class="chat-room-item__name">
            {{ getOtherUserName(room) }}
            <span class="chat-room-item__pin-indicator" *ngIf="room.pinned">
              <i class="icon-pin"></i>
            </span>
          </div>
          <div class="chat-room-item__time">
            {{ getLastMessageTime(room) | timeAgo }}
          </div>
        </div>

        <div class="chat-room-item__message">
          {{ getLastMessagePreview(room) }}
        </div>

        <div class="chat-room-item__footer">
          <div class="chat-room-item__encryption" *ngIf="room.encryptionEnabled">
            <i class="icon-lock"></i>
          </div>

          <div class="chat-room-item__badge" *ngIf="hasUnreadMessages(room)">
            {{ room.unreadCount }}
          </div>
        </div>
      </div>

      <!-- Room Actions -->
      <div class="chat-room-item__actions">
        <button
          class="chat-room-item__action-btn"
          [class.active]="room.pinned"
          (click)="togglePin($event, room)"
          title="{{ room.pinned ? 'Unpin' : 'Pin' }}"
        >
          <i class="icon-pin"></i>
        </button>

        <button
          class="chat-room-item__action-btn"
          (click)="archiveRoom($event, room)"
          title="Archive"
        >
          <i class="icon-archive"></i>
        </button>
      </div>
    </div>
  </div>
</div>
