<div class="chat-room">
  <nb-card>
    <nb-card-header>
      <div class="chat-header" *ngIf="contact">
        <nb-user [name]="contact.username" [picture]="contact.avatar" size="medium"> </nb-user>
        <nb-actions size="small">
          <nb-action
            icon="more-vertical-outline"
            [nbContextMenu]="chatActions"
            nbContextMenuTag="chat-actions"
          >
          </nb-action>
        </nb-actions>
      </div>
    </nb-card-header>

    <nb-card-body>
      <div class="messages-container" #messageContainer>
        <div class="message-list">
          <app-chat-message
            *ngFor="let message of messages"
            [message]="message"
            [isOwn]="isOwnMessage(message)"
            [showAvatar]="!isOwnMessage(message)"
          >
          </app-chat-message>
        </div>
        <div class="typing-indicator" *ngIf="isTyping">
          <nb-icon icon="message-typing"></nb-icon>
          <span>Typing...</span>
        </div>
      </div>
    </nb-card-body>

    <nb-card-footer>
      <form [formGroup]="messageForm" (ngSubmit)="sendMessage()">
        <nb-form-field>
          <input
            nbInput
            fullWidth
            formControlName="message"
            placeholder="Type a message..."
            [status]="messageForm.get('message')?.errors ? 'danger' : 'basic'"
          />
          <button nbButton type="submit" status="primary" [disabled]="!messageForm.valid" nbSuffix>
            <nb-icon icon="paper-plane-outline"></nb-icon>
          </button>
        </nb-form-field>
      </form>
    </nb-card-footer>
  </nb-card>
</div>
