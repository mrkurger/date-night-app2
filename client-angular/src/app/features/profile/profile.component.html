<div class="profile-container">
  <h2>My Profile</h2>
  
  <div *ngIf="isLoading" class="loading-spinner">
    <mat-spinner diameter="40"></mat-spinner>
  </div>
  
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>
  
  <div *ngIf="successMessage" class="success-message">
    {{ successMessage }}
  </div>
  
  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" *ngIf="userProfile">
    <div class="profile-image-container">
      <img 
        [src]="userProfile.profileImage || 'assets/images/default-profile.png'" 
        alt="Profile Image"
        class="profile-image"
      >
      <div class="image-upload">
        <label for="profileImage" class="upload-button">Change Photo</label>
        <input type="file" id="profileImage" accept="image/*" hidden>
      </div>
    </div>
    
    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>First Name</mat-label>
        <input matInput formControlName="firstName">
        <mat-error *ngIf="profileForm.get('firstName')?.hasError('required')">
          First name is required
        </mat-error>
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Last Name</mat-label>
        <input matInput formControlName="lastName">
        <mat-error *ngIf="profileForm.get('lastName')?.hasError('required')">
          Last name is required
        </mat-error>
      </mat-form-field>
    </div>
    
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Bio</mat-label>
      <textarea matInput formControlName="bio" rows="4"></textarea>
    </mat-form-field>
    
    <mat-form-field appearance="outline">
      <mat-label>Phone Number</mat-label>
      <input matInput formControlName="phoneNumber">
    </mat-form-field>
    
    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>City</mat-label>
        <input matInput formControlName="location.city">
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <input matInput formControlName="location.country">
      </mat-form-field>
    </div>
    
    <div class="preferences-section">
      <h3>Preferences</h3>
      
      <mat-slide-toggle formControlName="preferences.notifications">
        Enable Notifications
      </mat-slide-toggle>
      
      <mat-form-field appearance="outline">
        <mat-label>Privacy Setting</mat-label>
        <mat-select formControlName="preferences.privacy">
          <mat-option value="public">Public</mat-option>
          <mat-option value="private">Private</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div class="form-actions">
      <button mat-button type="button" routerLink="/dashboard">Cancel</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="profileForm.invalid || isLoading">
        Save Changes
      </button>
    </div>
  </form>
</div>
