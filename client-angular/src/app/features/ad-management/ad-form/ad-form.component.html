<div class="ad-form-container">
  <h2>{{ isEditMode ? 'Edit Advertisement' : 'Create New Advertisement' }}</h2>

  <div *ngIf="loading" class="loading-spinner">
    <nb-spinner status="primary" size="large"></nb-spinner>
  </div>

  <nb-card>
    <nb-card-header>
      <h3>{{ isEditMode ? 'Edit' : 'Create' }} Advertisement</h3>
    </nb-card-header>
    <nb-card-body>
      <form [formGroup]="adForm" (ngSubmit)="onSubmit()" *ngIf="!loading">
        <div class="form-group">
          <label for="title" class="label">Title</label>
          <nb-form-field>
            <input nbInput fullWidth id="title" formControlName="title" placeholder="Enter title" />
            <nb-icon nbPrefix icon="edit-2-outline"></nb-icon>
            <nb-error *ngIf="f.title.errors?.required && (f.title.dirty || f.title.touched)">
              Title is required
            </nb-error>
            <nb-error *ngIf="f.title.errors?.maxlength">
              Title must be less than 100 characters
            </nb-error>
          </nb-form-field>
        </div>

        <div class="form-group">
          <label for="description" class="label">Description</label>
          <nb-form-field>
            <textarea
              nbInput
              fullWidth
              id="description"
              formControlName="description"
              placeholder="Enter description"
              rows="4"
            ></textarea>
            <nb-error
              *ngIf="
                f.description.errors?.required && (f.description.dirty || f.description.touched)
              "
            >
              Description is required
            </nb-error>
            <nb-error *ngIf="f.description.errors?.maxlength">
              Description must be less than 1000 characters
            </nb-error>
          </nb-form-field>
        </div>

        <div class="form-group">
          <label for="price" class="label">Price</label>
          <nb-form-field>
            <input
              nbInput
              fullWidth
              type="number"
              id="price"
              formControlName="price"
              placeholder="Enter price"
            />
            <nb-icon nbPrefix icon="pricetags-outline"></nb-icon>
            <nb-error *ngIf="f.price.errors?.required && (f.price.dirty || f.price.touched)">
              Price is required
            </nb-error>
            <nb-error *ngIf="f.price.errors?.min"> Price must be greater than 0 </nb-error>
          </nb-form-field>
        </div>

        <div class="form-group">
          <label for="location" class="label">Location</label>
          <nb-form-field>
            <nb-select
              fullWidth
              id="location"
              formControlName="location"
              placeholder="Select location"
            >
              <nb-option *ngFor="let county of counties" [value]="county">{{ county }}</nb-option>
            </nb-select>
            <nb-error
              *ngIf="f.location.errors?.required && (f.location.dirty || f.location.touched)"
            >
              Location is required
            </nb-error>
          </nb-form-field>
        </div>

        <div class="form-group">
          <label for="category" class="label">Category</label>
          <nb-form-field>
            <nb-select
              fullWidth
              id="category"
              formControlName="category"
              placeholder="Select category"
            >
              <nb-option *ngFor="let category of categories" [value]="category.toLowerCase()">
                {{ category }}
              </nb-option>
            </nb-select>
            <nb-error
              *ngIf="f.category.errors?.required && (f.category.dirty || f.category.touched)"
            >
              Category is required
            </nb-error>
          </nb-form-field>
        </div>

        <div class="form-group">
          <label for="contactInfo" class="label">Contact Information</label>
          <nb-form-field>
            <input
              nbInput
              fullWidth
              id="contactInfo"
              formControlName="contactInfo"
              placeholder="Enter contact information"
            />
            <nb-icon nbPrefix icon="phone-outline"></nb-icon>
            <nb-error
              *ngIf="
                f.contactInfo.errors?.required && (f.contactInfo.dirty || f.contactInfo.touched)
              "
            >
              Contact information is required
            </nb-error>
          </nb-form-field>
        </div>

        <div class="form-group">
          <nb-checkbox formControlName="isActive">Active</nb-checkbox>
        </div>

        <div class="form-group">
          <nb-checkbox formControlName="isTouring">Touring</nb-checkbox>
        </div>

        <div class="form-actions">
          <button nbButton status="primary" size="large" [disabled]="!adForm.valid" type="submit">
            {{ isEditMode ? 'Update' : 'Create' }} Advertisement
          </button>
        </div>
      </form>
    </nb-card-body>
  </nb-card>
</div>
