#!/usr/bin/env bash
# run-pentest.sh
# This script runs a basic OWASP ZAP scan against a given URL and stores the HTML report.
# Usage: ./run-pentest.sh https://your-app-url.com

set -euo pipefail

TARGET_URL="${1:-}"
REPORT_DIR="pentest-reports"
REPORT_FILE="$REPORT_DIR/zap-report-$(date +%Y%m%d%H%M%S).html"

if [[ -z "$TARGET_URL" ]]; then
  echo "Usage: $0 <target-url>"
  exit 1
fi

mkdir -p "$REPORT_DIR"

# Run ZAP baseline scan (assumes zap-baseline.py is installed and in PATH)
zap-baseline.py -t "$TARGET_URL" -r "$REPORT_FILE"

echo "[run-pentest.sh] Pentest complete. Report at $REPORT_FILE"