/*!
 * jQuery Form Plugin
 * version: 3.51.0-2014.06.20
 * Requires jQuery v1.5 or later
 * Copyright (c) 2014 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):n(typeof jQuery!="undefined"?jQuery:window.Zepto)})(function(n){"use strict";function u(t){var i=t.data;t.isDefaultPrevented()||(t.preventDefault(),n(t.target).ajaxSubmit(i))}function f(t){var r=t.target,u=n(r),f,i,e;if(!u.is("[type=submit],[type=image]")){if(f=u.closest("[type=submit]"),f.length===0)return;r=f[0]}i=this;i.clk=r;r.type=="image"&&(t.offsetX!==undefined?(i.clk_x=t.offsetX,i.clk_y=t.offsetY):typeof n.fn.offset=="function"?(e=u.offset(),i.clk_x=t.pageX-e.left,i.clk_y=t.pageY-e.top):(i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop));setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function t(){if(n.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}var i={},r;i.fileapi=n("<input type='file'/>").get(0).files!==undefined;i.formdata=window.FormData!==undefined;r=!!n.fn.prop;n.fn.attr2=function(){if(!r)return this.attr.apply(this,arguments);var n=this.prop.apply(this,arguments);return n&&n.jquery||typeof n=="string"?n:this.attr.apply(this,arguments)};n.fn.ajaxSubmit=function(u){function ot(t){for(var r=n.param(t,u.traditional).split("&"),o=r.length,e=[],f,i=0;i<o;i++)r[i]=r[i].replace(/\+/g," "),f=r[i].split("="),e.push([decodeURIComponent(f[0]),decodeURIComponent(f[1])]);return e}function st(t){for(var f,r,s,o=new FormData,i=0;i<t.length;i++)o.append(t[i].name,t[i].value);if(u.extraData)for(f=ot(u.extraData),i=0;i<f.length;i++)f[i]&&o.append(f[i][0],f[i][1]);return u.data=null,r=n.extend(!0,{},n.ajaxSettings,u,{contentType:!1,processData:!1,cache:!1,type:e||"POST"}),u.uploadProgress&&(r.xhr=function(){var t=n.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(n){var t=0,i=n.loaded||n.position,r=n.total;n.lengthComputable&&(t=Math.ceil(i/r*100));u.uploadProgress(n,i,r,t)},!1),t}),r.data=null,s=r.beforeSend,r.beforeSend=function(n,t){t.data=u.formData?u.formData:o;s&&s.call(this,n,t)},n.ajax(r)}function ft(i){function ot(n){var i=null;try{n.contentWindow&&(i=n.contentWindow.document)}catch(r){t("cannot get iframe.contentWindow document: "+r)}if(i)return i;try{i=n.contentDocument?n.contentDocument:n.document}catch(r){t("cannot get iframe.contentDocument: "+r);i=n.document}return i}function st(){function h(){try{var n=ot(a).readyState;t("state = "+n);n&&n.toLowerCase()=="uninitialized"&&setTimeout(h,50)}catch(i){t("Server abort: ",i," (",i.name,")");b(tt);g&&clearTimeout(g);g=undefined}}var u=f.attr2("target"),s=f.attr2("action"),y=f.attr("enctype")||f.attr("encoding")||"multipart/form-data",r,i,c;l.setAttribute("target",d);(!e||/post/i.test(e))&&l.setAttribute("method","POST");s!=o.url&&l.setAttribute("action",o.url);o.skipEncodingOverride||e&&!/post/i.test(e)||f.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});o.timeout&&(g=setTimeout(function(){rt=!0;b(ut)},o.timeout));r=[];try{if(o.extraData)for(i in o.extraData)o.extraData.hasOwnProperty(i)&&(n.isPlainObject(o.extraData[i])&&o.extraData[i].hasOwnProperty("name")&&o.extraData[i].hasOwnProperty("value")?r.push(n('<input type="hidden" name="'+o.extraData[i].name+'">').val(o.extraData[i].value).appendTo(l)[0]):r.push(n('<input type="hidden" name="'+i+'">').val(o.extraData[i]).appendTo(l)[0]));o.iframeTarget||v.appendTo("body");a.attachEvent?a.attachEvent("onload",b):a.addEventListener("load",b,!1);setTimeout(h,15);try{l.submit()}catch(p){c=document.createElement("form").submit;c.apply(l)}}finally{l.setAttribute("action",s);l.setAttribute("enctype",y);u?l.setAttribute("target",u):f.removeAttr("target");n(r).remove()}}function b(i){var r,u,w,f,k,d,e,c,l;if(!s.aborted&&!lt){if(h=ot(a),h||(t("cannot access response document"),i=tt),i===ut&&s){s.abort("timeout");y.reject(s,"timeout");return}if(i==tt&&s){s.abort("server abort");y.reject(s,"error","server abort");return}if(h&&h.location.href!=o.iframeSrc||rt){a.detachEvent?a.detachEvent("onload",b):a.removeEventListener("load",b,!1);r="success";try{if(rt)throw"timeout";if(w=o.dataType=="xml"||h.XMLDocument||n.isXMLDoc(h),t("isXml="+w),!w&&window.opera&&(h.body===null||!h.body.innerHTML)&&--ct){t("requeing onLoad callback, DOM not available");setTimeout(b,250);return}f=h.body?h.body:h.documentElement;s.responseText=f?f.innerHTML:null;s.responseXML=h.XMLDocument?h.XMLDocument:h;w&&(o.dataType="xml");s.getResponseHeader=function(n){var t={"content-type":o.dataType};return t[n.toLowerCase()]};f&&(s.status=Number(f.getAttribute("status"))||s.status,s.statusText=f.getAttribute("statusText")||s.statusText);k=(o.dataType||"").toLowerCase();d=/(json|script|text)/.test(k);d||o.textarea?(e=h.getElementsByTagName("textarea")[0],e?(s.responseText=e.value,s.status=Number(e.getAttribute("status"))||s.status,s.statusText=e.getAttribute("statusText")||s.statusText):d&&(c=h.getElementsByTagName("pre")[0],l=h.getElementsByTagName("body")[0],c?s.responseText=c.textContent?c.textContent:c.innerText:l&&(s.responseText=l.textContent?l.textContent:l.innerText))):k=="xml"&&!s.responseXML&&s.responseText&&(s.responseXML=at(s.responseText));try{ht=yt(s,k,o)}catch(nt){r="parsererror";s.error=u=nt||r}}catch(nt){t("error caught: ",nt);r="error";s.error=u=nt||r}s.aborted&&(t("upload aborted"),r=null);s.status&&(r=s.status>=200&&s.status<300||s.status===304?"success":"error");r==="success"?(o.success&&o.success.call(o.context,ht,"success",s),y.resolve(s.responseText,"success",s),p&&n.event.trigger("ajaxSuccess",[s,o])):r&&(u===undefined&&(u=s.statusText),o.error&&o.error.call(o.context,s,r,u),y.reject(s,"error",u),p&&n.event.trigger("ajaxError",[s,o,u]));p&&n.event.trigger("ajaxComplete",[s,o]);p&&!--n.active&&n.event.trigger("ajaxStop");o.complete&&o.complete.call(o.context,s,r);lt=!0;o.timeout&&clearTimeout(g);setTimeout(function(){o.iframeTarget?v.attr("src",o.iframeSrc):v.remove();s.responseXML=null},100)}}}var l=f[0],it,nt,o,p,d,v,a,s,k,w,rt,g,y=n.Deferred(),ut,tt,ft,et,ht,h,ct,lt;if(y.abort=function(n){s.abort(n)},i)for(nt=0;nt<c.length;nt++)it=n(c[nt]),r?it.prop("disabled",!1):it.removeAttr("disabled");if(o=n.extend(!0,{},n.ajaxSettings,u),o.context=o.context||o,d="jqFormIO"+(new Date).getTime(),o.iframeTarget?(v=n(o.iframeTarget),w=v.attr2("name"),w?d=w:v.attr2("name",d)):(v=n('<iframe name="'+d+'" src="'+o.iframeSrc+'" />'),v.css({position:"absolute",top:"-1000px",left:"-1000px"})),a=v[0],s={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(i){var r=i==="timeout"?"timeout":"aborted";t("aborting upload... "+r);this.aborted=1;try{a.contentWindow.document.execCommand&&a.contentWindow.document.execCommand("Stop")}catch(u){}v.attr("src",o.iframeSrc);s.error=r;o.error&&o.error.call(o.context,s,r,i);p&&n.event.trigger("ajaxError",[s,o,r]);o.complete&&o.complete.call(o.context,s,r)}},p=o.global,p&&0==n.active++&&n.event.trigger("ajaxStart"),p&&n.event.trigger("ajaxSend",[s,o]),o.beforeSend&&o.beforeSend.call(o.context,s,o)===!1)return o.global&&n.active--,y.reject(),y;if(s.aborted)return y.reject(),y;k=l.clk;k&&(w=k.name,w&&!k.disabled&&(o.extraData=o.extraData||{},o.extraData[w]=k.value,k.type=="image"&&(o.extraData[w+".x"]=l.clk_x,o.extraData[w+".y"]=l.clk_y)));ut=1;tt=2;ft=n("meta[name=csrf-token]").attr("content");et=n("meta[name=csrf-param]").attr("content");et&&ft&&(o.extraData=o.extraData||{},o.extraData[et]=ft);o.forceSync?st():setTimeout(st,10);ct=50;var at=n.parseXML||function(n,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)):t=(new DOMParser).parseFromString(n,"text/xml"),t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},vt=n.parseJSON||function(n){return window.eval("("+n+")")},yt=function(t,i,r){var f=t.getResponseHeader("content-type")||"",e=i==="xml"||!i&&f.indexOf("xml")>=0,u=e?t.responseXML:t.responseText;return e&&u.documentElement.nodeName==="parsererror"&&n.error&&n.error("parsererror"),r&&r.dataFilter&&(u=r.dataFilter(u,i)),typeof u=="string"&&(i==="json"||!i&&f.indexOf("json")>=0?u=vt(u):(i==="script"||!i&&f.indexOf("javascript")>=0)&&n.globalEval(u)),u};return y}var e,b,o,f,a,v,c,y,s,l,h,d,g,nt,ut,p,w;if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;if(f=this,typeof u=="function"?u={success:u}:u===undefined&&(u={}),e=u.type||this.attr2("method"),b=u.url||this.attr2("action"),o=typeof b=="string"?n.trim(b):"",o=o||window.location.href||"",o&&(o=(o.match(/^([^#]+)/)||[])[1]),u=n.extend(!0,{url:o,success:n.ajaxSettings.success,type:e||n.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},u),a={},this.trigger("form-pre-serialize",[this,u,a]),a.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(u.beforeSerialize&&u.beforeSerialize(this,u)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;if(v=u.traditional,v===undefined&&(v=n.ajaxSettings.traditional),c=[],s=this.formToArray(u.semantic,c),u.data&&(u.extraData=u.data,y=n.param(u.data,v)),u.beforeSubmit&&u.beforeSubmit(s,this,u)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[s,this,u,a]),a.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;l=n.param(s,v);y&&(l=l?l+"&"+y:y);u.type.toUpperCase()=="GET"?(u.url+=(u.url.indexOf("?")>=0?"&":"?")+l,u.data=null):u.data=l;h=[];u.resetForm&&h.push(function(){f.resetForm()});u.clearForm&&h.push(function(){f.clearForm(u.includeHidden)});!u.dataType&&u.target?(d=u.success||function(){},h.push(function(t){var i=u.replaceTarget?"replaceWith":"html";n(u.target)[i](t).each(d,arguments)})):u.success&&h.push(u.success);u.success=function(n,t,i){for(var e=u.context||this,r=0,o=h.length;r<o;r++)h[r].apply(e,[n,t,i||f,f])};u.error&&(g=u.error,u.error=function(n,t,i){var r=u.context||this;g.apply(r,[n,t,i,f])});u.complete&&(nt=u.complete,u.complete=function(n,t){var i=u.context||this;nt.apply(i,[n,t,f])});var et=n("input[type=file]:enabled",this).filter(function(){return n(this).val()!==""}),tt=et.length>0,it="multipart/form-data",rt=f.attr("enctype")==it||f.attr("encoding")==it,k=i.fileapi&&i.formdata;for(t("fileAPI :"+k),ut=(tt||rt)&&!k,u.iframe!==!1&&(u.iframe||ut)?u.closeKeepAlive?n.get(u.closeKeepAlive,function(){p=ft(s)}):p=ft(s):p=(tt||rt)&&k?st(s):n.ajax(u),f.removeData("jqxhr").data("jqxhr",p),w=0;w<c.length;w++)c[w]=null;return this.trigger("form-submit-notify",[this,u]),this};n.fn.ajaxForm=function(i){if(i=i||{},i.delegation=i.delegation&&n.isFunction(n.fn.on),!i.delegation&&this.length===0){var r={s:this.selector,c:this.context};return!n.isReady&&r.s?(t("DOM not ready, queuing ajaxForm"),n(function(){n(r.s,r.c).ajaxForm(i)}),this):(t("terminating; zero elements found by selector"+(n.isReady?"":" (DOM not ready)")),this)}if(i.delegation){n(document).off("submit.form-plugin",this.selector,u).off("click.form-plugin",this.selector,f).on("submit.form-plugin",this.selector,i,u).on("click.form-plugin",this.selector,i,f);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",i,u).bind("click.form-plugin",i,f)};n.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};n.fn.formToArray=function(t,r){var e=[],l,h,f,c,u,b,k,a,p,v;if(this.length===0)return e;var o=this[0],w=this.attr("id"),s=t?o.getElementsByTagName("*"):o.elements,y;if(s&&!/MSIE [678]/.test(navigator.userAgent)&&(s=n(s).get()),w&&(y=n(':input[form="'+w+'"]').get(),y.length&&(s=(s||[]).concat(y))),!s||!s.length)return e;for(l=0,b=s.length;l<b;l++)if(u=s[l],f=u.name,f&&!u.disabled){if(t&&o.clk&&u.type=="image"){o.clk==u&&(e.push({name:f,value:n(u).val(),type:u.type}),e.push({name:f+".x",value:o.clk_x},{name:f+".y",value:o.clk_y}));continue}if(c=n.fieldValue(u,!0),c&&c.constructor==Array)for(r&&r.push(u),h=0,k=c.length;h<k;h++)e.push({name:f,value:c[h]});else if(i.fileapi&&u.type=="file")if(r&&r.push(u),a=u.files,a.length)for(h=0;h<a.length;h++)e.push({name:f,value:a[h],type:u.type});else e.push({name:f,value:"",type:u.type});else c!==null&&typeof c!="undefined"&&(r&&r.push(u),e.push({name:f,value:c,type:u.type,required:u.required}))}return!t&&o.clk&&(p=n(o.clk),v=p[0],f=v.name,f&&!v.disabled&&v.type=="image"&&(e.push({name:f,value:p.val()}),e.push({name:f+".x",value:o.clk_x},{name:f+".y",value:o.clk_y}))),e};n.fn.formSerialize=function(t){return n.param(this.formToArray(t))};n.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var f=this.name,r,u,e;if(f)if(r=n.fieldValue(this,t),r&&r.constructor==Array)for(u=0,e=r.length;u<e;u++)i.push({name:f,value:r[u]});else r!==null&&typeof r!="undefined"&&i.push({name:this.name,value:r})}),n.param(i)};n.fn.fieldValue=function(t){for(var f,i,r=[],u=0,e=this.length;u<e;u++)(f=this[u],i=n.fieldValue(f,t),i!==null&&typeof i!="undefined"&&(i.constructor!=Array||i.length))&&(i.constructor==Array?n.merge(r,i):r.push(i));return r};n.fieldValue=function(t,i){var a=t.name,u=t.type,h=t.tagName.toLowerCase(),e,o,r,f;if(i===undefined&&(i=!0),i&&(!a||t.disabled||u=="reset"||u=="button"||(u=="checkbox"||u=="radio")&&!t.checked||(u=="submit"||u=="image")&&t.form&&t.form.clk!=t||h=="select"&&t.selectedIndex==-1))return null;if(h=="select"){if(e=t.selectedIndex,e<0)return null;var c=[],l=t.options,s=u=="select-one",v=s?e+1:l.length;for(o=s?e:0;o<v;o++)if(r=l[o],r.selected){if(f=r.value,f||(f=r.attributes&&r.attributes.value&&!r.attributes.value.specified?r.text:r.value),s)return f;c.push(f)}return c}return n(t).val()};n.fn.clearForm=function(t){return this.each(function(){n("input,select,textarea",this).clearFields(t)})};n.fn.clearFields=n.fn.clearInputs=function(t){var i=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,u=this.tagName.toLowerCase();i.test(r)||u=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:u=="select"?this.selectedIndex=-1:r=="file"?/MSIE/.test(navigator.userAgent)?n(this).replaceWith(n(this).clone(!0)):n(this).val(""):t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&n(this).is(t))&&(this.value="")})};n.fn.resetForm=function(){return this.each(function(){typeof this.reset!="function"&&(typeof this.reset!="object"||this.reset.nodeType)||this.reset()})};n.fn.enable=function(n){return n===undefined&&(n=!0),this.each(function(){this.disabled=!n})};n.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var r=this.type,i;r=="checkbox"||r=="radio"?this.checked=t:this.tagName.toLowerCase()=="option"&&(i=n(this).parent("select"),t&&i[0]&&i[0].type=="select-one"&&i.find("option").selected(!1),this.selected=t)})};n.fn.ajaxSubmit.debug=!1});
//! moment.js
//! version : 2.17.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):n.moment=t()})(this,function(){"use strict";function t(){return ff.apply(null,arguments)}function ks(n){ff=n}function at(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function pi(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function ds(n){for(var t in n)return!1;return!0}function dt(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function wi(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function ef(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function l(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function vt(n,t){for(var i in t)l(t,i)&&(n[i]=t[i]);return l(t,"toString")&&(n.toString=t.toString),l(t,"valueOf")&&(n.valueOf=t.valueOf),n}function rt(n,t,i,r){return ao(n,t,i,r,!0).utc()}function gs(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function u(n){return n._pf==null&&(n._pf=gs()),n._pf}function wr(n){if(n._isValid==null){var t=u(n),r=hf.call(t.parsedDateParts,function(n){return n!=null}),i=!isNaN(n._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(n._strict&&(i=i&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined),Object.isFrozen!=null&&Object.isFrozen(n))return i;n._isValid=i}return n._isValid}function bi(n){var t=rt(NaN);return n!=null?vt(u(t),n):u(t).userInvalidated=!0,t}function b(n){return n===void 0}function br(n,t){var f,i,r;if(b(t._isAMomentObject)||(n._isAMomentObject=t._isAMomentObject),b(t._i)||(n._i=t._i),b(t._f)||(n._f=t._f),b(t._l)||(n._l=t._l),b(t._strict)||(n._strict=t._strict),b(t._tzm)||(n._tzm=t._tzm),b(t._isUTC)||(n._isUTC=t._isUTC),b(t._offset)||(n._offset=t._offset),b(t._pf)||(n._pf=u(t)),b(t._locale)||(n._locale=t._locale),ki.length>0)for(f in ki)i=ki[f],r=t[i],b(r)||(n[i]=r);return n}function hi(n){br(this,n);this._d=new Date(n._d!=null?n._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));di===!1&&(di=!0,t.updateOffset(this),di=!1)}function yt(n){return n instanceof hi||n!=null&&n._isAMomentObject!=null}function k(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function f(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=k(t)),i}function cf(n,t,i){for(var e=Math.min(n.length,t.length),o=Math.abs(n.length-t.length),u=0,r=0;r<e;r++)(i&&n[r]!==t[r]||!i&&f(n[r])!==f(t[r]))&&u++;return u+o}function lf(n){t.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+n)}function d(n,i){var r=!0;return vt(function(){var e,u,f,o;if(t.deprecationHandler!=null&&t.deprecationHandler(null,n),r){for(e=[],f=0;f<arguments.length;f++){if(u="",typeof arguments[f]=="object"){u+="\n["+f+"] ";for(o in arguments[0])u+=o+": "+arguments[0][o]+", ";u=u.slice(0,-2)}else u=arguments[f];e.push(u)}lf(n+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);r=!1}return i.apply(this,arguments)},i)}function af(n,i){t.deprecationHandler!=null&&t.deprecationHandler(n,i);kr[n]||(lf(i),kr[n]=!0)}function et(n){return n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function nh(n){var t;for(var i in n)t=n[i],et(t)?this[i]=t:this["_"+i]=t;this._config=n;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function vf(n,t){var r=vt({},n);for(var i in t)l(t,i)&&(pi(n[i])&&pi(t[i])?(r[i]={},vt(r[i],n[i]),vt(r[i],t[i])):t[i]!=null?r[i]=t[i]:delete r[i]);for(i in n)l(n,i)&&!l(t,i)&&pi(n[i])&&(r[i]=vt({},r[i]));return r}function dr(n){n!=null&&this.set(n)}function th(n,t,i){var r=this._calendar[n]||this._calendar.sameElse;return et(r)?r.call(t,i):r}function ih(n){var t=this._longDateFormat[n],i=this._longDateFormat[n.toUpperCase()];return t||!i?t:(this._longDateFormat[n]=i.replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n])}function rh(){return this._invalidDate}function uh(n){return this._ordinal.replace("%d",n)}function fh(n,t,i,r){var u=this._relativeTime[i];return et(u)?u(n,t,i,r):u.replace(/%d/i,n)}function eh(n,t){var i=this._relativeTime[n>0?"future":"past"];return et(i)?i(t):i.replace(/%s/i,t)}function p(n,t){var i=n.toLowerCase();ui[i]=ui[i+"s"]=ui[t]=n}function g(n){return typeof n=="string"?ui[n]||ui[n.toLowerCase()]:undefined}function gr(n){var r={},t;for(var i in n)l(n,i)&&(t=g(i),t&&(r[t]=n[i]));return r}function w(n,t){nu[n]=t}function oh(n){var t=[];for(var i in n)t.push({unit:i,priority:nu[i]});return t.sort(function(n,t){return n.priority-t.priority}),t}function fi(n,i){return function(r){return r!=null?(te(this,n,r),t.updateOffset(this,i),this):gi(this,n)}}function gi(n,t){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+t]():NaN}function te(n,t,i){n.isValid()&&n._d["set"+(n._isUTC?"UTC":"")+t](i)}function sh(n){return(n=g(n),et(this[n]))?this[n]():this}function hh(n,t){var r,i;if(typeof n=="object")for(n=gr(n),r=oh(n),i=0;i<r.length;i++)this[r[i].unit](n[r[i].unit]);else if(n=g(n),et(this[n]))return this[n](t);return this}function ot(n,t,i){var r=""+Math.abs(n),u=t-r.length,f=n>=0;return(f?i?"+":"":"-")+Math.pow(10,Math.max(0,u)).toString().substr(1)+r}function r(n,t,i,r){var u=r;typeof r=="string"&&(u=function(){return this[r]()});n&&(ei[n]=u);t&&(ei[t[0]]=function(){return ot(u.apply(this,arguments),t[1],t[2])});i&&(ei[i]=function(){return this.localeData().ordinal(u.apply(this,arguments),n)})}function ch(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function lh(n){for(var t=n.match(ie),i=0,r=t.length;i<r;i++)t[i]=ei[t[i]]?ei[t[i]]:ch(t[i]);return function(i){for(var f="",u=0;u<r;u++)f+=t[u]instanceof Function?t[u].call(i,n):t[u];return f}}function iu(n,t){return n.isValid()?(t=re(t,n.localeData()),tu[t]=tu[t]||lh(t),tu[t](n)):n.localeData().invalidDate()}function re(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(nr.lastIndex=0;i>=0&&nr.test(n);)n=n.replace(nr,r),nr.lastIndex=0,i-=1;return n}function i(n,t,i){fu[n]=et(t)?t:function(n){return n&&i?i:t}}function vh(n,t){return l(fu,n)?fu[n](t._strict,t._locale):new RegExp(yh(n))}function yh(n){return gt(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u}))}function gt(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(n,t){var i,r=t;for(typeof n=="string"&&(n=[n]),dt(t)&&(r=function(n,i){i[t]=f(n)}),i=0;i<n.length;i++)er[n[i]]=r}function li(n,t){s(n,function(n,i,r,u){r._w=r._w||{};t(n,r._w,r,u)})}function ph(n,t,i){t!=null&&l(er,n)&&er[n](t,i._a,i,n)}function eu(n,t){return new Date(Date.UTC(n,t+1,0)).getUTCDate()}function kh(n,t){return n?at(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||ou).test(t)?"format":"standalone"][n.month()]:this._months}function dh(n,t){return n?at(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[ou.test(t)?"format":"standalone"][n.month()]:this._monthsShort}function gh(n,t,i){var u,r,e,f=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],u=0;u<12;++u)e=rt([2e3,u]),this._shortMonthsParse[u]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[u]=this.months(e,"").toLocaleLowerCase();return i?t==="MMM"?(r=v.call(this._shortMonthsParse,f),r!==-1?r:null):(r=v.call(this._longMonthsParse,f),r!==-1?r:null):t==="MMM"?(r=v.call(this._shortMonthsParse,f),r!==-1)?r:(r=v.call(this._longMonthsParse,f),r!==-1?r:null):(r=v.call(this._longMonthsParse,f),r!==-1)?r:(r=v.call(this._shortMonthsParse,f),r!==-1?r:null)}function nc(n,t,i){var r,u,f;if(this._monthsParseExact)return gh.call(this,n,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if((u=rt([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(u,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(u,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(f="^"+this.months(u,"")+"|^"+this.monthsShort(u,""),this._monthsParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="MMMM"&&this._longMonthsParse[r].test(n))||i&&t==="MMM"&&this._shortMonthsParse[r].test(n)||!i&&this._monthsParse[r].test(n))return r}function le(n,t){var i;if(!n.isValid())return n;if(typeof t=="string")if(/^\d+$/.test(t))t=f(t);else if(t=n.localeData().monthsParse(t),!dt(t))return n;return i=Math.min(n.date(),eu(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n}function ae(n){return n!=null?(le(this,n),t.updateOffset(this,!0),this):gi(this,"Month")}function tc(){return eu(this.year(),this.month())}function ic(n){return this._monthsParseExact?(l(this,"_monthsRegex")||pe.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=ve),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function rc(n){return this._monthsParseExact?(l(this,"_monthsRegex")||pe.call(this),n?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=ye),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function pe(){function f(n,t){return t.length-n.length}for(var i=[],r=[],t=[],u,n=0;n<12;n++)u=rt([2e3,n]),i.push(this.monthsShort(u,"")),r.push(this.months(u,"")),t.push(this.months(u,"")),t.push(this.monthsShort(u,""));for(i.sort(f),r.sort(f),t.sort(f),n=0;n<12;n++)i[n]=gt(i[n]),r[n]=gt(r[n]);for(n=0;n<24;n++)t[n]=gt(t[n]);this._monthsRegex=new RegExp("^("+t.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function ai(n){return we(n)?366:365}function we(n){return n%4==0&&n%100!=0||n%400==0}function uc(){return we(this.year())}function fc(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<100&&n>=0&&isFinite(o.getFullYear())&&o.setFullYear(n),o}function or(n){var t=new Date(Date.UTC.apply(null,arguments));return n<100&&n>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(n),t}function sr(n,t,i){var r=7+t-i,u=(7+or(n,0,r).getUTCDay()-t)%7;return-u+r-1}function be(n,t,i,r,u){var s=(7+i-r)%7,h=sr(n,r,u),f=1+7*(t-1)+s+h,e,o;return f<=0?(e=n-1,o=ai(e)+f):f>ai(n)?(e=n+1,o=f-ai(n)):(e=n,o=f),{year:e,dayOfYear:o}}function vi(n,t,i){var e=sr(n.year(),t,i),r=Math.floor((n.dayOfYear()-e-1)/7)+1,f,u;return r<1?(u=n.year()-1,f=r+ti(u,t,i)):r>ti(n.year(),t,i)?(f=r-ti(n.year(),t,i),u=n.year()+1):(u=n.year(),f=r),{week:f,year:u}}function ti(n,t,i){var r=sr(n,t,i),u=sr(n+1,t,i);return(ai(n)-r+u)/7}function ec(n){return vi(n,this._week.dow,this._week.doy).week}function oc(){return this._week.dow}function sc(){return this._week.doy}function hc(n){var t=this.localeData().week(this);return n==null?t:this.add((n-t)*7,"d")}function cc(n){var t=vi(this,1,4).week;return n==null?t:this.add((n-t)*7,"d")}function lc(n,t){return typeof n!="string"?n:isNaN(n)?(n=t.weekdaysParse(n),typeof n=="number")?n:null:parseInt(n,10)}function ac(n,t){return typeof n=="string"?t.weekdaysParse(n)%7||7:isNaN(n)?null:n}function vc(n,t){return n?at(this._weekdays)?this._weekdays[n.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][n.day()]:this._weekdays}function yc(n){return n?this._weekdaysShort[n.day()]:this._weekdaysShort}function pc(n){return n?this._weekdaysMin[n.day()]:this._weekdaysMin}function wc(n,t,i){var f,r,e,u=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],f=0;f<7;++f)e=rt([2e3,1]).day(f),this._minWeekdaysParse[f]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[f]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[f]=this.weekdays(e,"").toLocaleLowerCase();return i?t==="dddd"?(r=v.call(this._weekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=v.call(this._shortWeekdaysParse,u),r!==-1?r:null):(r=v.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="dddd"?(r=v.call(this._weekdaysParse,u),r!==-1)?r:(r=v.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=v.call(this._minWeekdaysParse,u),r!==-1?r:null):t==="ddd"?(r=v.call(this._shortWeekdaysParse,u),r!==-1)?r:(r=v.call(this._weekdaysParse,u),r!==-1)?r:(r=v.call(this._minWeekdaysParse,u),r!==-1?r:null):(r=v.call(this._minWeekdaysParse,u),r!==-1)?r:(r=v.call(this._weekdaysParse,u),r!==-1)?r:(r=v.call(this._shortWeekdaysParse,u),r!==-1?r:null)}function bc(n,t,i){var r,u,f;if(this._weekdaysParseExact)return wc.call(this,n,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++)if((u=rt([2e3,1]).day(r),i&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(u,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(u,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(u,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(f="^"+this.weekdays(u,"")+"|^"+this.weekdaysShort(u,"")+"|^"+this.weekdaysMin(u,""),this._weekdaysParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="dddd"&&this._fullWeekdaysParse[r].test(n))||i&&t==="ddd"&&this._shortWeekdaysParse[r].test(n)||i&&t==="dd"&&this._minWeekdaysParse[r].test(n)||!i&&this._weekdaysParse[r].test(n))return r}function kc(n){if(!this.isValid())return n!=null?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=lc(n,this.localeData()),this.add(n-t,"d")):t}function dc(n){if(!this.isValid())return n!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return n==null?t:this.add(n-t,"d")}function gc(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var t=ac(n,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function nl(n){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||hu.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=to),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function tl(n){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||hu.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=io),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function il(n){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||hu.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ro),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function hu(){function u(n,t){return t.length-n.length}for(var e=[],i=[],r=[],t=[],f,o,s,h,n=0;n<7;n++)f=rt([2e3,1]).day(n),o=this.weekdaysMin(f,""),s=this.weekdaysShort(f,""),h=this.weekdays(f,""),e.push(o),i.push(s),r.push(h),t.push(o),t.push(s),t.push(h);for(e.sort(u),i.sort(u),r.sort(u),t.sort(u),n=0;n<7;n++)i[n]=gt(i[n]),r[n]=gt(r[n]),t[n]=gt(t[n]);this._weekdaysRegex=new RegExp("^("+t.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function cu(){return this.hours()%12||12}function rl(){return this.hours()||24}function uo(n,t){r(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function fo(n,t){return t._meridiemParse}function ul(n){return(n+"").toLowerCase().charAt(0)==="p"}function fl(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"}function so(n){return n?n.toLowerCase().replace("_","-"):n}function ol(n){for(var r=0,i,t,f,u;r<n.length;){for(u=so(n[r]).split("-"),i=u.length,t=so(n[r+1]),t=t?t.split("-"):null;i>0;){if(f=ho(u.slice(0,i).join("-")),f)return f;if(t&&t.length>=i&&cf(u,t,!0)>=i-1)break;i--}r++}return null}function ho(n){var t=null;if(!a[n]&&typeof module!="undefined"&&module&&module.exports)try{t=hr._abbr;require("./locale/"+n);oi(t)}catch(i){}return a[n]}function oi(n,t){var i;return n&&(i=b(t)?pt(n):lu(n,t),i&&(hr=i)),hr._abbr}function lu(n,t){if(t!==null){var i=oo;if(t.abbr=n,a[n]!=null)af("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=a[n]._config;else if(t.parentLocale!=null)if(a[t.parentLocale]!=null)i=a[t.parentLocale]._config;else return yi[t.parentLocale]||(yi[t.parentLocale]=[]),yi[t.parentLocale].push({name:n,config:t}),null;return a[n]=new dr(vf(i,t)),yi[n]&&yi[n].forEach(function(n){lu(n.name,n.config)}),oi(n),a[n]}return delete a[n],null}function sl(n,t){if(t!=null){var i,r=oo;a[n]!=null&&(r=a[n]._config);t=vf(r,t);i=new dr(t);i.parentLocale=a[n];a[n]=i;oi(n)}else a[n]!=null&&(a[n].parentLocale!=null?a[n]=a[n].parentLocale:a[n]!=null&&delete a[n]);return a[n]}function pt(n){var t;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return hr;if(!at(n)){if(t=ho(n),t)return t;n=[n]}return ol(n)}function hl(){return pf(a)}function au(n){var i,t=n._a;return t&&u(n).overflow===-2&&(i=t[st]<0||t[st]>11?st:t[ut]<1||t[ut]>eu(t[tt],t[st])?ut:t[y]<0||t[y]>24||t[y]===24&&(t[it]!==0||t[ht]!==0||t[ni]!==0)?y:t[it]<0||t[it]>59?it:t[ht]<0||t[ht]>59?ht:t[ni]<0||t[ni]>999?ni:-1,u(n)._overflowDayOfYear&&(i<tt||i>ut)&&(i=ut),u(n)._overflowWeeks&&i===-1&&(i=wh),u(n)._overflowWeekday&&i===-1&&(i=bh),u(n).overflow=i),n}function co(n){var t,r,o=n._i,i=cl.exec(o)||ll.exec(o),s,e,f,h;if(i){for(u(n).iso=!0,t=0,r=cr.length;t<r;t++)if(cr[t][1].exec(i[1])){e=cr[t][0];s=cr[t][2]!==!1;break}if(e==null){n._isValid=!1;return}if(i[3]){for(t=0,r=vu.length;t<r;t++)if(vu[t][1].exec(i[3])){f=(i[2]||" ")+vu[t][0];break}if(f==null){n._isValid=!1;return}}if(!s&&f!=null){n._isValid=!1;return}if(i[4])if(al.exec(i[4]))h="Z";else{n._isValid=!1;return}n._f=e+(f||"")+(h||"");pu(n)}else n._isValid=!1}function yl(n){var i=vl.exec(n._i);if(i!==null){n._d=new Date(+i[1]);return}co(n);n._isValid===!1&&(delete n._isValid,t.createFromInputFallback(n))}function si(n,t,i){return n!=null?n:t!=null?t:i}function pl(n){var i=new Date(t.now());return n._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function yu(n){var t,i,r=[],f,e;if(!n._d){for(f=pl(n),n._w&&n._a[ut]==null&&n._a[st]==null&&wl(n),n._dayOfYear&&(e=si(n._a[tt],f[tt]),n._dayOfYear>ai(e)&&(u(n)._overflowDayOfYear=!0),i=or(e,0,n._dayOfYear),n._a[st]=i.getUTCMonth(),n._a[ut]=i.getUTCDate()),t=0;t<3&&n._a[t]==null;++t)n._a[t]=r[t]=f[t];for(;t<7;t++)n._a[t]=r[t]=n._a[t]==null?t===2?1:0:n._a[t];n._a[y]===24&&n._a[it]===0&&n._a[ht]===0&&n._a[ni]===0&&(n._nextDay=!0,n._a[y]=0);n._d=(n._useUTC?or:fc).apply(null,r);n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[y]=24)}}function wl(n){var t,o,f,i,r,e,h,s,l;t=n._w;t.GG!=null||t.W!=null||t.E!=null?(r=1,e=4,o=si(t.GG,n._a[tt],vi(c(),1,4).year),f=si(t.W,1),i=si(t.E,1),(i<1||i>7)&&(s=!0)):(r=n._locale._week.dow,e=n._locale._week.doy,l=vi(c(),r,e),o=si(t.gg,n._a[tt],l.year),f=si(t.w,l.week),t.d!=null?(i=t.d,(i<0||i>6)&&(s=!0)):t.e!=null?(i=t.e+r,(t.e<0||t.e>6)&&(s=!0)):i=r);f<1||f>ti(o,r,e)?u(n)._overflowWeeks=!0:s!=null?u(n)._overflowWeekday=!0:(h=be(o,f,i,r,e),n._a[tt]=h.year,n._dayOfYear=h.dayOfYear)}function pu(n){if(n._f===t.ISO_8601){co(n);return}n._a=[];u(n).empty=!0;for(var i=""+n._i,r,f,s,c=i.length,h=0,o=re(n._f,n._locale).match(ie)||[],e=0;e<o.length;e++)f=o[e],r=(i.match(vh(f,n))||[])[0],r&&(s=i.substr(0,i.indexOf(r)),s.length>0&&u(n).unusedInput.push(s),i=i.slice(i.indexOf(r)+r.length),h+=r.length),ei[f]?(r?u(n).empty=!1:u(n).unusedTokens.push(f),ph(f,r,n)):n._strict&&!r&&u(n).unusedTokens.push(f);u(n).charsLeftOver=c-h;i.length>0&&u(n).unusedInput.push(i);n._a[y]<=12&&u(n).bigHour===!0&&n._a[y]>0&&(u(n).bigHour=undefined);u(n).parsedDateParts=n._a.slice(0);u(n).meridiem=n._meridiem;n._a[y]=bl(n._locale,n._a[y],n._meridiem);yu(n);au(n)}function bl(n,t,i){var r;return i==null?t:n.meridiemHour!=null?n.meridiemHour(t,i):n.isPM!=null?(r=n.isPM(i),r&&t<12&&(t+=12),r||t!==12||(t=0),t):t}function kl(n){var t,e,f,r,i;if(n._f.length===0){u(n).invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=br({},n),n._useUTC!=null&&(t._useUTC=n._useUTC),t._f=n._f[r],pu(t),wr(t))&&(i+=u(t).charsLeftOver,i+=u(t).unusedTokens.length*10,u(t).score=i,(f==null||i<f)&&(f=i,e=t));vt(n,e||t)}function dl(n){if(!n._d){var t=gr(n._i);n._a=ef([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)});yu(n)}}function gl(n){var t=new hi(au(lo(n)));return t._nextDay&&(t.add(1,"d"),t._nextDay=undefined),t}function lo(n){var t=n._i,i=n._f;return(n._locale=n._locale||pt(n._l),t===null||i===undefined&&t==="")?bi({nullInput:!0}):(typeof t=="string"&&(n._i=t=n._locale.preparse(t)),yt(t))?new hi(au(t)):(wi(t)?n._d=t:at(i)?kl(n):i?pu(n):na(n),wr(n)||(n._d=null),n)}function na(n){var i=n._i;i===undefined?n._d=new Date(t.now()):wi(i)?n._d=new Date(i.valueOf()):typeof i=="string"?yl(n):at(i)?(n._a=ef(i.slice(0),function(n){return parseInt(n,10)}),yu(n)):typeof i=="object"?dl(n):dt(i)?n._d=new Date(i):t.createFromInputFallback(n)}function ao(n,t,i,r,u){var f={};return(i===!0||i===!1)&&(r=i,i=undefined),(pi(n)&&ds(n)||at(n)&&n.length===0)&&(n=undefined),f._isAMomentObject=!0,f._useUTC=f._isUTC=u,f._l=i,f._i=n,f._f=t,f._strict=r,gl(f)}function c(n,t,i,r){return ao(n,t,i,r,!1)}function po(n,t){var r,i;if(t.length===1&&at(t[0])&&(t=t[0]),!t.length)return c();for(r=t[0],i=1;i<t.length;++i)(!t[i].isValid()||t[i][n](r))&&(r=t[i]);return r}function ta(){var n=[].slice.call(arguments,0);return po("isBefore",n)}function ia(){var n=[].slice.call(arguments,0);return po("isAfter",n)}function lr(n){var t=gr(n),i=t.year||0,r=t.quarter||0,u=t.month||0,f=t.week||0,e=t.day||0,o=t.hour||0,s=t.minute||0,h=t.second||0,c=t.millisecond||0;this._milliseconds=+c+h*1e3+s*6e4+o*36e5;this._days=+e+f*7;this._months=+u+r*3+i*12;this._data={};this._locale=pt();this._bubble()}function wu(n){return n instanceof lr}function bu(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function bo(n,t){r(n,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+ot(~~(n/60),2)+t+ot(~~n%60,2)})}function ku(n,t){var i=(t||"").match(n);if(i===null)return null;var e=i[i.length-1]||[],r=(e+"").match(ko)||["-",0,0],u=+(r[1]*60)+f(r[2]);return u===0?0:r[0]==="+"?u:-u}function du(n,i){var r,u;return i._isUTC?(r=i.clone(),u=(yt(n)||wi(n)?n.valueOf():c(n).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+u),t.updateOffset(r,!1),r):c(n).local()}function gu(n){return-Math.round(n._d.getTimezoneOffset()/15)*15}function ra(n,i){var r=this._offset||0,u;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=ku(fr,n),n===null)return this}else Math.abs(n)<16&&(n=n*60);return!this._isUTC&&i&&(u=gu(this)),this._offset=n,this._isUTC=!0,u!=null&&this.add(u,"m"),r!==n&&(!i||this._changeInProgress?us(this,wt(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:gu(this)}function ua(n,t){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}function fa(n){return this.utcOffset(0,n)}function ea(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(gu(this),"m")),this}function oa(){if(this._tzm!=null)this.utcOffset(this._tzm);else if(typeof this._i=="string"){var n=ku(ah,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function sa(n){return this.isValid()?(n=n?c(n).utcOffset():0,(this.utcOffset()-n)%60==0):!1}function ha(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function ca(){var n,t;return b(this._isDSTShifted)?(n={},br(n,this),n=lo(n),n._a?(t=n._isUTC?rt(n._a):c(n._a),this._isDSTShifted=this.isValid()&&cf(n._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted):this._isDSTShifted}function la(){return this.isValid()?!this._isUTC:!1}function aa(){return this.isValid()?this._isUTC:!1}function go(){return this.isValid()?this._isUTC&&this._offset===0:!1}function wt(n,t){var i=n,r=null,u,e,o;return wu(n)?i={ms:n._milliseconds,d:n._days,M:n._months}:dt(n)?(i={},t?i[t]=n:i.milliseconds=n):(r=ns.exec(n))?(u=r[1]==="-"?-1:1,i={y:0,d:f(r[ut])*u,h:f(r[y])*u,m:f(r[it])*u,s:f(r[ht])*u,ms:f(bu(r[ni]*1e3))*u}):(r=ts.exec(n))?(u=r[1]==="-"?-1:1,i={y:ii(r[2],u),M:ii(r[3],u),w:ii(r[4],u),d:ii(r[5],u),h:ii(r[6],u),m:ii(r[7],u),s:ii(r[8],u)}):i==null?i={}:typeof i=="object"&&("from"in i||"to"in i)&&(o=va(c(i.from),c(i.to)),i={},i.ms=o.milliseconds,i.M=o.months),e=new lr(i),wu(n)&&l(n,"_locale")&&(e._locale=n._locale),e}function ii(n,t){var i=n&&parseFloat(n.replace(",","."));return(isNaN(i)?0:i)*t}function is(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+(t.year()-n.year())*12,n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function va(n,t){var i;return(n.isValid()&&t.isValid())?(t=du(t,n),n.isBefore(t)?i=is(n,t):(i=is(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function rs(n,t){return function(i,r){var u,f;return r===null||isNaN(+r)||(af(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),f=i,i=r,r=f),i=typeof i=="string"?+i:i,u=wt(i,r),us(this,u,n),this}}function us(n,i,r,u){var o=i._milliseconds,f=bu(i._days),e=bu(i._months);n.isValid()&&(u=u==null?!0:u,o&&n._d.setTime(n._d.valueOf()+o*r),f&&te(n,"Date",gi(n,"Date")+f*r),e&&le(n,gi(n,"Month")+e*r),u&&t.updateOffset(n,f||e))}function ya(n,t){var i=n.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function pa(n,i){var u=n||c(),f=du(u,this).startOf("day"),r=t.calendarFormat(this,f)||"sameElse",e=i&&(et(i[r])?i[r].call(this,u):i[r]);return this.format(e||this.localeData().calendar(r,this,c(u)))}function wa(){return new hi(this)}function ba(n,t){var i=yt(n)?n:c(n);return(this.isValid()&&i.isValid())?(t=g(b(t)?"millisecond":t),t==="millisecond"?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf()):!1}function ka(n,t){var i=yt(n)?n:c(n);return(this.isValid()&&i.isValid())?(t=g(b(t)?"millisecond":t),t==="millisecond"?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf()):!1}function da(n,t,i,r){return r=r||"()",(r[0]==="("?this.isAfter(n,i):!this.isBefore(n,i))&&(r[1]===")"?this.isBefore(t,i):!this.isAfter(t,i))}function ga(n,t){var i=yt(n)?n:c(n),r;return(this.isValid()&&i.isValid())?(t=g(t||"millisecond"),t==="millisecond"?this.valueOf()===i.valueOf():(r=i.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf())):!1}function nv(n,t){return this.isSame(n,t)||this.isAfter(n,t)}function tv(n,t){return this.isSame(n,t)||this.isBefore(n,t)}function iv(n,t,i){var f,e,u,r;return this.isValid()?(f=du(n,this),!f.isValid())?NaN:(e=(f.utcOffset()-this.utcOffset())*6e4,t=g(t),t==="year"||t==="month"||t==="quarter"?(r=rv(this,f),t==="quarter"?r=r/3:t==="year"&&(r=r/12)):(u=this-f,r=t==="second"?u/1e3:t==="minute"?u/6e4:t==="hour"?u/36e5:t==="day"?(u-e)/864e5:t==="week"?(u-e)/6048e5:u),i?r:k(r)):NaN}function rv(n,t){var r=(t.year()-n.year())*12+(t.month()-n.month()),i=n.clone().add(r,"months"),u,f;return t-i<0?(u=n.clone().add(r-1,"months"),f=(t-i)/(i-u)):(u=n.clone().add(r+1,"months"),f=(t-i)/(u-i)),-(r+f)||0}function uv(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function fv(){var n=this.clone().utc();return 0<n.year()&&n.year()<=9999?et(Date.prototype.toISOString)?this.toDate().toISOString():iu(n,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):iu(n,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ev(){var n,t;if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";n="moment";t="";this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z");var i="["+n+'("]',r=0<this.year()&&this.year()<=9999?"YYYY":"YYYYYY",u=t+'[")]';return this.format(i+r+"-MM-DD[T]HH:mm:ss.SSS"+u)}function ov(n){n||(n=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var i=iu(this,n);return this.localeData().postformat(i)}function sv(n,t){return this.isValid()&&(yt(n)&&n.isValid()||c(n).isValid())?wt({to:this,from:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function hv(n){return this.from(c(),n)}function cv(n,t){return this.isValid()&&(yt(n)&&n.isValid()||c(n).isValid())?wt({from:this,to:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function lv(n){return this.to(c(),n)}function os(n){var t;return n===undefined?this._locale._abbr:(t=pt(n),t!=null&&(this._locale=t),this)}function ss(){return this._locale}function av(n){n=g(n);switch(n){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"&&this.weekday(0),n==="isoWeek"&&this.isoWeekday(1),n==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function vv(n){return(n=g(n),n===undefined||n==="millisecond")?this:(n==="date"&&(n="day"),this.startOf(n).add(1,n==="isoWeek"?"week":n).subtract(1,"ms"))}function yv(){return this._d.valueOf()-(this._offset||0)*6e4}function pv(){return Math.floor(this.valueOf()/1e3)}function wv(){return new Date(this.valueOf())}function bv(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function kv(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function dv(){return this.isValid()?this.toISOString():null}function gv(){return wr(this)}function ny(){return vt({},u(this))}function ty(){return u(this).overflow}function iy(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function ar(n,t){r(0,[n,n.length],0,t)}function ry(n){return hs.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function uy(n){return hs.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function fy(){return ti(this.year(),1,4)}function ey(){var n=this.localeData()._week;return ti(this.year(),n.dow,n.doy)}function hs(n,t,i,r,u){var f;return n==null?vi(this,r,u).year:(f=ti(n,r,u),t>f&&(t=f),oy.call(this,n,t,i,r,u))}function oy(n,t,i,r,u){var e=be(n,t,i,r,u),f=or(e.year,0,e.dayOfYear);return this.year(f.getUTCFullYear()),this.month(f.getUTCMonth()),this.date(f.getUTCDate()),this}function sy(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}function hy(n){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?t:this.add(n-t,"d")}function cy(n,t){t[ni]=f(("0."+n)*1e3)}function ly(){return this._isUTC?"UTC":""}function ay(){return this._isUTC?"Coordinated Universal Time":""}function vy(n){return c(n*1e3)}function yy(){return c.apply(null,arguments).parseZone()}function vs(n){return n}function vr(n,t,i,r){var u=pt(),f=rt().set(r,t);return u[i](f,n)}function ys(n,t,i){if(dt(n)&&(t=n,n=undefined),n=n||"",t!=null)return vr(n,t,i,"month");for(var u=[],r=0;r<12;r++)u[r]=vr(n,r,i,"month");return u}function rf(n,t,i,r){var o,f,u,e;if(typeof n=="boolean"?(dt(t)&&(i=t,t=undefined),t=t||""):(t=n,i=t,n=!1,dt(t)&&(i=t,t=undefined),t=t||""),o=pt(),f=n?o._week.dow:0,i!=null)return vr(t,(i+f)%7,r,"day");for(e=[],u=0;u<7;u++)e[u]=vr(t,(u+f)%7,r,"day");return e}function py(n,t){return ys(n,t,"months")}function wy(n,t){return ys(n,t,"monthsShort")}function by(n,t,i){return rf(n,t,i,"weekdays")}function ky(n,t,i){return rf(n,t,i,"weekdaysShort")}function dy(n,t,i){return rf(n,t,i,"weekdaysMin")}function gy(){var n=this._data;return this._milliseconds=ft(this._milliseconds),this._days=ft(this._days),this._months=ft(this._months),n.milliseconds=ft(n.milliseconds),n.seconds=ft(n.seconds),n.minutes=ft(n.minutes),n.hours=ft(n.hours),n.months=ft(n.months),n.years=ft(n.years),this}function ps(n,t,i,r){var u=wt(t,i);return n._milliseconds+=r*u._milliseconds,n._days+=r*u._days,n._months+=r*u._months,n._bubble()}function np(n,t){return ps(this,n,t,1)}function tp(n,t){return ps(this,n,t,-1)}function ws(n){return n<0?Math.floor(n):Math.ceil(n)}function ip(){var r=this._milliseconds,n=this._days,t=this._months,i=this._data,u,f,e,s,o;return r>=0&&n>=0&&t>=0||r<=0&&n<=0&&t<=0||(r+=ws(uf(t)+n)*864e5,n=0,t=0),i.milliseconds=r%1e3,u=k(r/1e3),i.seconds=u%60,f=k(u/60),i.minutes=f%60,e=k(f/60),i.hours=e%24,n+=k(e/24),o=k(bs(n)),t+=o,n-=ws(uf(o)),s=k(t/12),t%=12,i.days=n,i.months=t,i.years=s,this}function bs(n){return n*4800/146097}function uf(n){return n*146097/4800}function rp(n){var t,r,i=this._milliseconds;if(n=g(n),n==="month"||n==="year")return t=this._days+i/864e5,r=this._months+bs(t),n==="month"?r:r/12;t=this._days+Math.round(uf(this._months));switch(n){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return t*24+i/36e5;case"minute":return t*1440+i/6e4;case"second":return t*86400+i/1e3;case"millisecond":return Math.floor(t*864e5)+i;default:throw new Error("Unknown unit "+n);}}function up(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+f(this._months/12)*31536e6}function kt(n){return function(){return this.as(n)}}function vp(n){return n=g(n),this[n+"s"]()}function ri(n){return function(){return this._data[n]}}function nw(){return k(this.days()/7)}function tw(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function iw(n,t,i){var r=wt(n).abs(),h=ct(r.as("s")),f=ct(r.as("m")),e=ct(r.as("h")),o=ct(r.as("d")),s=ct(r.as("M")),c=ct(r.as("y")),u=h<lt.s&&["s",h]||f<=1&&["m"]||f<lt.m&&["mm",f]||e<=1&&["h"]||e<lt.h&&["hh",e]||o<=1&&["d"]||o<lt.d&&["dd",o]||s<=1&&["M"]||s<lt.M&&["MM",s]||c<=1&&["y"]||["yy",c];return u[2]=t,u[3]=+n>0,u[4]=i,tw.apply(null,u)}function rw(n){return n===undefined?ct:typeof n=="function"?(ct=n,!0):!1}function uw(n,t){return lt[n]===undefined?!1:t===undefined?lt[n]:(lt[n]=t,!0)}function fw(n){var t=this.localeData(),i=iw(this,!n,t);return n&&(i=t.pastFuture(+this,i)),t.postformat(i)}function pr(){var t=yr(this._milliseconds)/1e3,a=yr(this._days),i=yr(this._months),n,e,o;n=k(t/60);e=k(n/60);t%=60;n%=60;o=k(i/12);i%=12;var s=o,h=i,c=a,r=e,u=n,f=t,l=this.asSeconds();return l?(l<0?"-":"")+"P"+(s?s+"Y":"")+(h?h+"M":"")+(c?c+"D":"")+(r||u||f?"T":"")+(r?r+"H":"")+(u?u+"M":"")+(f?f+"S":""):"P0D"}var ff,sf,hf,ki,di,kr,yf,pf,wf,bf,kf,df,gf,ne,ui,nu,er,v,ou,he,ce,ve,ye,su,ke,de,ge,no,to,io,ro,eo,vo,yo,wo,ko,ns,ts,fs,es,nf,tf,cs,ls,bt,as,n,o,ft,ct,lt,yr,e;sf=Array.prototype.some?Array.prototype.some:function(n){for(var i=Object(this),r=i.length>>>0,t=0;t<r;t++)if(t in i&&n.call(this,i[t],t,i))return!0;return!1};hf=sf;ki=t.momentProperties=[];di=!1;kr={};t.suppressDeprecationWarnings=!1;t.deprecationHandler=null;yf=Object.keys?Object.keys:function(n){var t,i=[];for(t in n)l(n,t)&&i.push(t);return i};pf=yf;wf={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};bf={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};kf="Invalid date";df="%d";gf=/\d{1,2}/;ne={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};ui={};nu={};var ie=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,nr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,tu={},ei={};var ue=/\d/,nt=/\d\d/,fe=/\d{3}/,ru=/\d{4}/,tr=/[+-]?\d{6}/,h=/\d\d?/,ee=/\d\d\d\d?/,oe=/\d\d\d\d\d\d?/,ir=/\d{1,3}/,uu=/\d{1,4}/,rr=/[+-]?\d{1,6}/,ur=/[+-]?\d+/,ah=/Z|[+-]\d\d:?\d\d/gi,fr=/Z|[+-]\d\d(?::?\d\d)?/gi,ci=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,fu={};er={};var tt=0,st=1,ut=2,y=3,it=4,ht=5,ni=6,wh=7,bh=8,se;se=Array.prototype.indexOf?Array.prototype.indexOf:function(n){for(var t=0;t<this.length;++t)if(this[t]===n)return t;return-1};v=se;r("M",["MM",2],"Mo",function(){return this.month()+1});r("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});r("MMMM",0,0,function(n){return this.localeData().months(this,n)});p("month","M");w("month",8);i("M",h);i("MM",h,nt);i("MMM",function(n,t){return t.monthsShortRegex(n)});i("MMMM",function(n,t){return t.monthsRegex(n)});s(["M","MM"],function(n,t){t[st]=f(n)-1});s(["MMM","MMMM"],function(n,t,i,r){var f=i._locale.monthsParse(n,r,i._strict);f!=null?t[st]=f:u(i).invalidMonth=n});ou=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;he="January_February_March_April_May_June_July_August_September_October_November_December".split("_");ce="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");ve=ci;ye=ci;r("Y",0,0,function(){var n=this.year();return n<=9999?""+n:"+"+n});r(0,["YY",2],0,function(){return this.year()%100});r(0,["YYYY",4],0,"year");r(0,["YYYYY",5],0,"year");r(0,["YYYYYY",6,!0],0,"year");p("year","y");w("year",1);i("Y",ur);i("YY",h,nt);i("YYYY",uu,ru);i("YYYYY",rr,tr);i("YYYYYY",rr,tr);s(["YYYYY","YYYYYY"],tt);s("YYYY",function(n,i){i[tt]=n.length===2?t.parseTwoDigitYear(n):f(n)});s("YY",function(n,i){i[tt]=t.parseTwoDigitYear(n)});s("Y",function(n,t){t[tt]=parseInt(n,10)});t.parseTwoDigitYear=function(n){return f(n)+(f(n)>68?1900:2e3)};su=fi("FullYear",!0);r("w",["ww",2],"wo","week");r("W",["WW",2],"Wo","isoWeek");p("week","w");p("isoWeek","W");w("week",5);w("isoWeek",5);i("w",h);i("ww",h,nt);i("W",h);i("WW",h,nt);li(["w","ww","W","WW"],function(n,t,i,r){t[r.substr(0,1)]=f(n)});ke={dow:0,doy:6};r("d",0,"do","day");r("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});r("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});r("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});r("e",0,0,"weekday");r("E",0,0,"isoWeekday");p("day","d");p("weekday","e");p("isoWeekday","E");w("day",11);w("weekday",11);w("isoWeekday",11);i("d",h);i("e",h);i("E",h);i("dd",function(n,t){return t.weekdaysMinRegex(n)});i("ddd",function(n,t){return t.weekdaysShortRegex(n)});i("dddd",function(n,t){return t.weekdaysRegex(n)});li(["dd","ddd","dddd"],function(n,t,i,r){var f=i._locale.weekdaysParse(n,r,i._strict);f!=null?t.d=f:u(i).invalidWeekday=n});li(["d","e","E"],function(n,t,i,r){t[r]=f(n)});de="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");ge="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");no="Su_Mo_Tu_We_Th_Fr_Sa".split("_");to=ci;io=ci;ro=ci;r("H",["HH",2],0,"hour");r("h",["hh",2],0,cu);r("k",["kk",2],0,rl);r("hmm",0,0,function(){return""+cu.apply(this)+ot(this.minutes(),2)});r("hmmss",0,0,function(){return""+cu.apply(this)+ot(this.minutes(),2)+ot(this.seconds(),2)});r("Hmm",0,0,function(){return""+this.hours()+ot(this.minutes(),2)});r("Hmmss",0,0,function(){return""+this.hours()+ot(this.minutes(),2)+ot(this.seconds(),2)});uo("a",!0);uo("A",!1);p("hour","h");w("hour",13);i("a",fo);i("A",fo);i("H",h);i("h",h);i("HH",h,nt);i("hh",h,nt);i("hmm",ee);i("hmmss",oe);i("Hmm",ee);i("Hmmss",oe);s(["H","HH"],y);s(["a","A"],function(n,t,i){i._isPm=i._locale.isPM(n);i._meridiem=n});s(["h","hh"],function(n,t,i){t[y]=f(n);u(i).bigHour=!0});s("hmm",function(n,t,i){var r=n.length-2;t[y]=f(n.substr(0,r));t[it]=f(n.substr(r));u(i).bigHour=!0});s("hmmss",function(n,t,i){var r=n.length-4,e=n.length-2;t[y]=f(n.substr(0,r));t[it]=f(n.substr(r,2));t[ht]=f(n.substr(e));u(i).bigHour=!0});s("Hmm",function(n,t){var i=n.length-2;t[y]=f(n.substr(0,i));t[it]=f(n.substr(i))});s("Hmmss",function(n,t){var i=n.length-4,r=n.length-2;t[y]=f(n.substr(0,i));t[it]=f(n.substr(i,2));t[ht]=f(n.substr(r))});eo=/[ap]\.?m?\.?/i;var el=fi("Hours",!0),oo={calendar:wf,longDateFormat:bf,invalidDate:kf,ordinal:df,ordinalParse:gf,relativeTime:ne,months:he,monthsShort:ce,week:ke,weekdays:de,weekdaysMin:no,weekdaysShort:ge,meridiemParse:eo},a={},yi={},hr;var cl=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ll=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,al=/Z|[+-]\d\d(?::?\d\d)?/,cr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],vu=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],vl=/^\/?Date\((\-?\d+)/i;for(t.createFromInputFallback=d("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))}),t.ISO_8601=function(){},vo=d("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=c.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:bi()}),yo=d("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=c.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:bi()}),wo=function(){return Date.now?Date.now():+new Date},bo("Z",":"),bo("ZZ",""),i("Z",fr),i("ZZ",fr),s(["Z","ZZ"],function(n,t,i){i._useUTC=!0;i._tzm=ku(fr,n)}),ko=/([\+\-]|\d\d)/gi,t.updateOffset=function(){},ns=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,ts=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/,wt.fn=lr.prototype,fs=rs(1,"add"),es=rs(-1,"subtract"),t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]",nf=d("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===undefined?this.localeData():this.locale(n)}),r(0,["gg",2],0,function(){return this.weekYear()%100}),r(0,["GG",2],0,function(){return this.isoWeekYear()%100}),ar("gggg","weekYear"),ar("ggggg","weekYear"),ar("GGGG","isoWeekYear"),ar("GGGGG","isoWeekYear"),p("weekYear","gg"),p("isoWeekYear","GG"),w("weekYear",1),w("isoWeekYear",1),i("G",ur),i("g",ur),i("GG",h,nt),i("gg",h,nt),i("GGGG",uu,ru),i("gggg",uu,ru),i("GGGGG",rr,tr),i("ggggg",rr,tr),li(["gggg","ggggg","GGGG","GGGGG"],function(n,t,i,r){t[r.substr(0,2)]=f(n)}),li(["gg","GG"],function(n,i,r,u){i[u]=t.parseTwoDigitYear(n)}),r("Q",0,"Qo","quarter"),p("quarter","Q"),w("quarter",7),i("Q",ue),s("Q",function(n,t){t[st]=(f(n)-1)*3}),r("D",["DD",2],"Do","date"),p("date","D"),w("date",9),i("D",h),i("DD",h,nt),i("Do",function(n,t){return n?t._ordinalParse:t._ordinalParseLenient}),s(["D","DD"],ut),s("Do",function(n,t){t[ut]=f(n.match(h)[0],10)}),tf=fi("Date",!0),r("DDD",["DDDD",3],"DDDo","dayOfYear"),p("dayOfYear","DDD"),w("dayOfYear",4),i("DDD",ir),i("DDDD",fe),s(["DDD","DDDD"],function(n,t,i){i._dayOfYear=f(n)}),r("m",["mm",2],0,"minute"),p("minute","m"),w("minute",14),i("m",h),i("mm",h,nt),s(["m","mm"],it),cs=fi("Minutes",!1),r("s",["ss",2],0,"second"),p("second","s"),w("second",15),i("s",h),i("ss",h,nt),s(["s","ss"],ht),ls=fi("Seconds",!1),r("S",0,0,function(){return~~(this.millisecond()/100)}),r(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),r(0,["SSS",3],0,"millisecond"),r(0,["SSSS",4],0,function(){return this.millisecond()*10}),r(0,["SSSSS",5],0,function(){return this.millisecond()*100}),r(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),r(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),r(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),r(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),p("millisecond","ms"),w("millisecond",16),i("S",ir,ue),i("SS",ir,nt),i("SSS",ir,fe),bt="SSSS";bt.length<=9;bt+="S")i(bt,/\d+/);for(bt="S";bt.length<=9;bt+="S")s(bt,cy);as=fi("Milliseconds",!1);r("z",0,0,"zoneAbbr");r("zz",0,0,"zoneName");n=hi.prototype;n.add=fs;n.calendar=pa;n.clone=wa;n.diff=iv;n.endOf=vv;n.format=ov;n.from=sv;n.fromNow=hv;n.to=cv;n.toNow=lv;n.get=sh;n.invalidAt=ty;n.isAfter=ba;n.isBefore=ka;n.isBetween=da;n.isSame=ga;n.isSameOrAfter=nv;n.isSameOrBefore=tv;n.isValid=gv;n.lang=nf;n.locale=os;n.localeData=ss;n.max=yo;n.min=vo;n.parsingFlags=ny;n.set=hh;n.startOf=av;n.subtract=es;n.toArray=bv;n.toObject=kv;n.toDate=wv;n.toISOString=fv;n.inspect=ev;n.toJSON=dv;n.toString=uv;n.unix=pv;n.valueOf=yv;n.creationData=iy;n.year=su;n.isLeapYear=uc;n.weekYear=ry;n.isoWeekYear=uy;n.quarter=n.quarters=sy;n.month=ae;n.daysInMonth=tc;n.week=n.weeks=hc;n.isoWeek=n.isoWeeks=cc;n.weeksInYear=ey;n.isoWeeksInYear=fy;n.date=tf;n.day=n.days=kc;n.weekday=dc;n.isoWeekday=gc;n.dayOfYear=hy;n.hour=n.hours=el;n.minute=n.minutes=cs;n.second=n.seconds=ls;n.millisecond=n.milliseconds=as;n.utcOffset=ra;n.utc=fa;n.local=ea;n.parseZone=oa;n.hasAlignedHourOffset=sa;n.isDST=ha;n.isLocal=la;n.isUtcOffset=aa;n.isUtc=go;n.isUTC=go;n.zoneAbbr=ly;n.zoneName=ay;n.dates=d("dates accessor is deprecated. Use date instead.",tf);n.months=d("months accessor is deprecated. Use month instead",ae);n.years=d("years accessor is deprecated. Use year instead",su);n.zone=d("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",ua);n.isDSTShifted=d("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",ca);o=dr.prototype;o.calendar=th;o.longDateFormat=ih;o.invalidDate=rh;o.ordinal=uh;o.preparse=vs;o.postformat=vs;o.relativeTime=fh;o.pastFuture=eh;o.set=nh;o.months=kh;o.monthsShort=dh;o.monthsParse=nc;o.monthsRegex=rc;o.monthsShortRegex=ic;o.week=ec;o.firstDayOfYear=sc;o.firstDayOfWeek=oc;o.weekdays=vc;o.weekdaysMin=pc;o.weekdaysShort=yc;o.weekdaysParse=bc;o.weekdaysRegex=nl;o.weekdaysShortRegex=tl;o.weekdaysMinRegex=il;o.isPM=ul;o.meridiem=fl;oi("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,i=f(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+i}});t.lang=d("moment.lang is deprecated. Use moment.locale instead.",oi);t.langData=d("moment.langData is deprecated. Use moment.localeData instead.",pt);ft=Math.abs;var fp=kt("ms"),ep=kt("s"),op=kt("m"),sp=kt("h"),hp=kt("d"),cp=kt("w"),lp=kt("M"),ap=kt("y");var yp=ri("milliseconds"),pp=ri("seconds"),wp=ri("minutes"),bp=ri("hours"),kp=ri("days"),dp=ri("months"),gp=ri("years");return ct=Math.round,lt={s:45,m:45,h:22,d:26,M:11},yr=Math.abs,e=lr.prototype,e.abs=gy,e.add=np,e.subtract=tp,e.as=rp,e.asMilliseconds=fp,e.asSeconds=ep,e.asMinutes=op,e.asHours=sp,e.asDays=hp,e.asWeeks=cp,e.asMonths=lp,e.asYears=ap,e.valueOf=up,e._bubble=ip,e.get=vp,e.milliseconds=yp,e.seconds=pp,e.minutes=wp,e.hours=bp,e.days=kp,e.weeks=nw,e.months=dp,e.years=gp,e.humanize=fw,e.toISOString=pr,e.toString=pr,e.toJSON=pr,e.locale=os,e.localeData=ss,e.toIsoString=d("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",pr),e.lang=nf,r("X",0,0,"unix"),r("x",0,0,"valueOf"),i("x",ur),i("X",/[+-]?\d+(\.\d{1,3})?/),s("X",function(n,t,i){i._d=new Date(parseFloat(n,10)*1e3)}),s("x",function(n,t,i){i._d=new Date(f(n))}),t.version="2.17.1",ks(c),t.fn=n,t.min=ta,t.max=ia,t.now=wo,t.utc=rt,t.unix=vy,t.months=py,t.isDate=wi,t.locale=oi,t.invalid=bi,t.duration=wt,t.isMoment=yt,t.weekdays=by,t.parseZone=yy,t.localeData=pt,t.isDuration=wu,t.monthsShort=wy,t.weekdaysMin=dy,t.defineLocale=lu,t.updateLocale=sl,t.locales=hl,t.weekdaysShort=ky,t.normalizeUnits=g,t.relativeTimeRounding=rw,t.relativeTimeThreshold=uw,t.calendarFormat=ya,t.prototype=n,t});"undefined"!=typeof window&&function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():n.Hls=t()}(this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/dist/",t(t.s=20)}([function(n,t,i){"use strict";var r;i.d(t,"a",function(){return r}),function(n){n.MEDIA_ATTACHING="hlsMediaAttaching";n.MEDIA_ATTACHED="hlsMediaAttached";n.MEDIA_DETACHING="hlsMediaDetaching";n.MEDIA_DETACHED="hlsMediaDetached";n.BUFFER_RESET="hlsBufferReset";n.BUFFER_CODECS="hlsBufferCodecs";n.BUFFER_CREATED="hlsBufferCreated";n.BUFFER_APPENDING="hlsBufferAppending";n.BUFFER_APPENDED="hlsBufferAppended";n.BUFFER_EOS="hlsBufferEos";n.BUFFER_FLUSHING="hlsBufferFlushing";n.BUFFER_FLUSHED="hlsBufferFlushed";n.MANIFEST_LOADING="hlsManifestLoading";n.MANIFEST_LOADED="hlsManifestLoaded";n.MANIFEST_PARSED="hlsManifestParsed";n.LEVEL_SWITCHING="hlsLevelSwitching";n.LEVEL_SWITCHED="hlsLevelSwitched";n.LEVEL_LOADING="hlsLevelLoading";n.LEVEL_LOADED="hlsLevelLoaded";n.LEVEL_UPDATED="hlsLevelUpdated";n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated";n.LEVELS_UPDATED="hlsLevelsUpdated";n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated";n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching";n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched";n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading";n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded";n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated";n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared";n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch";n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading";n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded";n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed";n.CUES_PARSED="hlsCuesParsed";n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound";n.INIT_PTS_FOUND="hlsInitPtsFound";n.FRAG_LOADING="hlsFragLoading";n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted";n.FRAG_LOADED="hlsFragLoaded";n.FRAG_DECRYPTED="hlsFragDecrypted";n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment";n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata";n.FRAG_PARSING_METADATA="hlsFragParsingMetadata";n.FRAG_PARSED="hlsFragParsed";n.FRAG_BUFFERED="hlsFragBuffered";n.FRAG_CHANGED="hlsFragChanged";n.FPS_DROP="hlsFpsDrop";n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping";n.ERROR="hlsError";n.DESTROYING="hlsDestroying";n.KEY_LOADING="hlsKeyLoading";n.KEY_LOADED="hlsKeyLoaded";n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached";n.BACK_BUFFER_REACHED="hlsBackBufferReached"}(r||(r={}))},function(n,t,i){"use strict";function o(n){var t=self.console[n];return t?t.bind(self.console,"["+n+"] >"):r}function s(n){if(self.console&&!0===n||"object"==typeof n){!function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];r.forEach(function(t){f[t]=n[t]?n[t].bind(n):o(t)})}(n,"debug","log","info","warn","error");try{f.log()}catch(n){f=u}}else f=u}var e;i.d(t,"a",function(){return s});i.d(t,"b",function(){return e});var r=function(){},u={trace:r,debug:r,log:r,warn:r,info:r,error:r},f=u;e=u},function(n,t,i){"use strict";var r,u;i.d(t,"b",function(){return r});i.d(t,"a",function(){return u}),function(n){n.NETWORK_ERROR="networkError";n.MEDIA_ERROR="mediaError";n.KEY_SYSTEM_ERROR="keySystemError";n.MUX_ERROR="muxError";n.OTHER_ERROR="otherError"}(r||(r={})),function(n){n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys";n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess";n.KEY_SYSTEM_NO_SESSION="keySystemNoSession";n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed";n.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData";n.MANIFEST_LOAD_ERROR="manifestLoadError";n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut";n.MANIFEST_PARSING_ERROR="manifestParsingError";n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError";n.LEVEL_EMPTY_ERROR="levelEmptyError";n.LEVEL_LOAD_ERROR="levelLoadError";n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut";n.LEVEL_SWITCH_ERROR="levelSwitchError";n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError";n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut";n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError";n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut";n.FRAG_LOAD_ERROR="fragLoadError";n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut";n.FRAG_DECRYPT_ERROR="fragDecryptError";n.FRAG_PARSING_ERROR="fragParsingError";n.REMUX_ALLOC_ERROR="remuxAllocError";n.KEY_LOAD_ERROR="keyLoadError";n.KEY_LOAD_TIMEOUT="keyLoadTimeOut";n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError";n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError";n.BUFFER_APPEND_ERROR="bufferAppendError";n.BUFFER_APPENDING_ERROR="bufferAppendingError";n.BUFFER_STALLED_ERROR="bufferStalledError";n.BUFFER_FULL_ERROR="bufferFullError";n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole";n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall";n.INTERNAL_EXCEPTION="internalException";n.INTERNAL_ABORTED="aborted";n.UNKNOWN="unknown"}(u||(u={}))},function(n,t,i){"use strict";i.d(t,"a",function(){return r});var r=Number.isFinite||function(n){return"number"==typeof n&&isFinite(n)};Number.MAX_SAFE_INTEGER},function(n,t,i){"use strict";var r,u;i.d(t,"a",function(){return r});i.d(t,"b",function(){return u}),function(n){n.MANIFEST="manifest";n.LEVEL="level";n.AUDIO_TRACK="audioTrack";n.SUBTITLE_TRACK="subtitleTrack"}(r||(r={})),function(n){n.MAIN="main";n.AUDIO="audio";n.SUBTITLE="subtitle"}(u||(u={}))},function(n,t,i){"use strict";function o(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;s(n,t)}function s(n,t){return(s=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function h(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function u(n,t,i){return t&&h(n.prototype,t),i&&h(n,i),n}i.d(t,"a",function(){return r});i.d(t,"b",function(){return y});i.d(t,"c",function(){return p});var r,f=i(3),l=i(11),a=i(1),v=i(17),e=i(12);!function(n){n.AUDIO="audio";n.VIDEO="video";n.AUDIOVIDEO="audiovideo"}(r||(r={}));var c=function(){function n(n){var t;this._byteRange=null;this._url=null;this.baseurl=void 0;this.relurl=void 0;this.elementaryStreams=((t={})[r.AUDIO]=null,t[r.VIDEO]=null,t[r.AUDIOVIDEO]=null,t);this.baseurl=n}return n.prototype.setByteRange=function(n,t){var r=n.split("@",2),i=[];i[0]=1===r.length?t?t.byteRangeEndOffset:0:parseInt(r[1]);i[1]=parseInt(r[0])+i[0];this._byteRange=i},u(n,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(l.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(n){this._url=n}}]),n}(),y=function(n){function t(t,i){var r;return(r=n.call(this,i)||this)._decryptdata=null,r.rawProgramDateTime=null,r.programDateTime=null,r.tagList=[],r.duration=0,r.sn=0,r.levelkey=void 0,r.type=void 0,r.loader=null,r.level=-1,r.cc=0,r.startPTS=void 0,r.endPTS=void 0,r.appendedPTS=void 0,r.startDTS=void 0,r.endDTS=void 0,r.start=0,r.deltaPTS=void 0,r.maxStartPTS=void 0,r.minEndPTS=void 0,r.stats=new e.a,r.urlId=0,r.data=void 0,r.bitrateTest=!1,r.title=null,r.initSegment=null,r.type=t,r}o(t,n);var i=t.prototype;return i.createInitializationVector=function(n){for(var i=new Uint8Array(16),t=12;t<16;t++)i[t]=n>>8*(15-t)&255;return i},i.setDecryptDataFromLevelKey=function(n,t){var i=n;return"AES-128"===(null==n?void 0:n.method)&&n.uri&&!n.iv&&((i=v.a.fromURI(n.uri)).method=n.method,i.iv=this.createInitializationVector(t),i.keyFormat="identity"),i},i.setElementaryStreamInfo=function(n,t,i,r,u,f){void 0===f&&(f=!1);var o=this.elementaryStreams,e=o[n];e?(e.startPTS=Math.min(e.startPTS,t),e.endPTS=Math.max(e.endPTS,i),e.startDTS=Math.min(e.startDTS,r),e.endDTS=Math.max(e.endDTS,u)):o[n]={startPTS:t,endPTS:i,startDTS:r,endDTS:u,partial:f}},i.clearElementaryStreamInfo=function(){var n=this.elementaryStreams;n[r.AUDIO]=null;n[r.VIDEO]=null;n[r.AUDIOVIDEO]=null},u(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var n=this.sn;"number"!=typeof n&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&a.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),n=0);this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,n)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime||!Object(f.a)(this.programDateTime))return null;var n=Object(f.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*n}},{key:"encrypted",get:function(){var n;return!(null===(n=this.decryptdata)||void 0===n||!n.keyFormat||!this.decryptdata.uri)}}]),t}(c),p=function(n){function t(t,i,r,u,f){var o,s;return(o=n.call(this,r)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.stats=new e.a,o.duration=t.decimalFloatingPoint("DURATION"),o.gap=t.bool("GAP"),o.independent=t.bool("INDEPENDENT"),o.relurl=t.enumeratedString("URI"),o.fragment=i,o.index=u,s=t.enumeratedString("BYTERANGE"),s&&o.setByteRange(s,f),f&&(o.fragOffset=f.fragOffset+f.duration),o}return o(t,n),u(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var n=this.elementaryStreams;return!!(n.audio||n.video||n.audiovideo)}}]),t}(c)},function(n,t,i){"use strict";function e(n){return String.fromCharCode.apply(null,n)}function r(n,t){"data"in n&&(t+=n.start,n=n.data);var i=n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3];return i<0?4294967296+i:i}function o(n,t,i){"data"in n&&(t+=n.start,n=n.data);n[t]=i>>24;n[t+1]=i>>16&255;n[t+2]=i>>8&255;n[t+3]=255&i}function u(n,t){var f,c,o,s=[],i,a,h,v;if(!t.length)return s;for(("data"in n)?(f=n.data,c=n.start,o=n.end):(c=0,o=(f=n).byteLength),i=c;i<o;)a=r(f,i),h=a>1?i+a:o,e(f.subarray(i+4,i+8))===t[0]&&(1===t.length?s.push({data:f,start:i+8,end:h}):(v=u({data:f,start:i+8,end:h},t.slice(1)),v.length&&l.apply(s,v))),i=h;return s}function c(n){var y=u(n,["moov"])[0],b=y?y.end:null,s=u(n,["sidx"]),e,c,l,f,a,o,v;if(!s||!s[0])return null;var p=[],i=s[0],h=i.data[0],t=0===h?8:16,w=r(i,t);for(t+=4,t+=0===h?8:16,t+=2,e=i.end+0,c=function(n,t){"data"in n&&(t+=n.start,n=n.data);var i=n[t]<<8|n[t+1];return i<0?65536+i:i}(i,t),t+=2,l=0;l<c;l++){if(f=t,a=r(i,f),f+=4,o=2147483647&a,1==(2147483648&a)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;v=r(i,f);f+=4;p.push({referenceSize:o,subsegmentDuration:v,info:{duration:v/w,start:e,end:e+o-1}});e+=o;t=f+=4}return{earliestPresentationTime:0,timescale:w,version:h,referencesCount:c,references:p,moovEndOffset:b}}function a(n){for(var t,i,v,o,d,l,s,y,h=[],p=u(n,["moov","trak"]),a=0;a<p.length;a++)if(t=p[a],i=u(t,["tkhd"])[0],i){var w=i.data[i.start],b=0===w?12:20,k=r(i,b),c=u(t,["mdia","mdhd"])[0];c&&(v=r(c,b=0===(w=c.data[c.start])?12:20),o=u(t,["mdia","hdlr"])[0],o&&(d=e(o.data.subarray(o.start+8,o.start+12)),l={soun:f.a.AUDIO,vide:f.a.VIDEO}[d],l&&(s=u(t,["mdia","minf","stbl","stsd"])[0],y=void 0,s&&(y=e(s.data.subarray(s.start+12,s.start+16))),h[k]={timescale:v,type:l},h[l]={timescale:v,id:k,codec:y})))}return u(n,["moov","mvex","trex"]).forEach(function(n){var i=r(n,4),t=h[i];t&&(t.default={duration:r(n,12),flags:r(n,20)})}),h}function v(n,t){return u(t,["moof","traf"]).reduce(function(t,i){var f=u(i,["tfdt"])[0],o=f.data[f.start],e=u(i,["tfhd"]).reduce(function(t,i){var h=r(i,4),s=n[h],u,e;return s&&(u=r(f,4),1===o&&(u*=Math.pow(2,32),u+=r(f,8)),e=u/(s.timescale||9e4),isFinite(e)&&(null===t||e<t))?e:t},null);return null!==e&&isFinite(e)&&(null===t||e<t)?e:t},null)||0}function y(n,t){for(var h,e=0,l=0,a=0,k=u(n,["moof","traf"]),v=0;v<k.length;v++){var d=k[v],y=u(d,["tfhd"])[0],i=t[r(y,4)];if(i){var o=i.default,g=r(y,0)|(null==o?void 0:o.flags),w=null==o?void 0:o.duration;8&g&&(w=r(y,2&g?12:8));for(var nt=i.timescale||9e4,b=u(d,["trun"]),s=0;s<b.length;s++)(e=p(b[s]))||!w||(e=w*r(b[s],4)),i.type===f.a.VIDEO?l+=e/nt:i.type===f.a.AUDIO&&(a+=e/nt)}}return 0===l&&0===a&&(h=c(n),null!=h&&h.references)?h.references.reduce(function(n,t){return n+t.info.duration||0},0):l||a}function p(n){var i=r(n,0),t=8;1&i&&(t+=4);4&i&&(t+=4);for(var u=0,e=r(n,4),f=0;f<e;f++)256&i&&(u+=r(n,t),t+=4),512&i&&(t+=4),1024&i&&(t+=4),2048&i&&(t+=4);return u}function w(n,t,i){u(t,["moof","traf"]).forEach(function(t){u(t,["tfhd"]).forEach(function(f){var c=r(f,4),s=n[c],e;s&&(e=s.timescale||9e4,u(t,["tfdt"]).forEach(function(n){var s=n.data[n.start],t=r(n,4),u,f;0===s?o(n,4,t-i*e):(t*=Math.pow(2,32),t+=r(n,8),t-=i*e,t=Math.max(t,0),u=Math.floor(t/(h+1)),f=Math.floor(t%(h+1)),o(n,4,u),o(n,8,f))}))})})}function b(n){var t={valid:null,remainder:null},i=u(n,["moof"]),r;return i?i.length<2?(t.remainder=n,t):(r=i[i.length-1],t.valid=Object(s.a)(n,0,r.start-8),t.remainder=Object(s.a)(n,r.start-8),t):t}function k(n,t){var i=new Uint8Array(n.length+t.length);return i.set(n),i.set(t,n.length),i}i.d(t,"b",function(){return u});i.d(t,"g",function(){return c});i.d(t,"f",function(){return a});i.d(t,"d",function(){return v});i.d(t,"c",function(){return y});i.d(t,"e",function(){return w});i.d(t,"h",function(){return b});i.d(t,"a",function(){return k});var s=i(9),f=i(5),h=Math.pow(2,32)-1,l=[].push},function(n,t,i){"use strict";function d(){return f||void 0===self.TextDecoder||(f=new self.TextDecoder("utf-8")),f}i.d(t,"b",function(){return c});i.d(t,"a",function(){return l});i.d(t,"d",function(){return a});i.d(t,"e",function(){return s});i.d(t,"c",function(){return h});i.d(t,"f",function(){return r});var f,e=function(n,t){return t+10<=n.length&&73===n[t]&&68===n[t+1]&&51===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},o=function(n,t){return t+10<=n.length&&51===n[t]&&68===n[t+1]&&73===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},c=function(n,t){for(var r=t,i=0;e(n,t);)i+=10,i+=u(n,t+6),o(n,t+10)&&(i+=10),t+=i;if(i>0)return n.subarray(r,r+i)},u=function(n,t){var i=0;return i=(127&n[t])<<21,i|=(127&n[t+1])<<14,i|=(127&n[t+2])<<7,i|127&n[t+3]},l=function(n,t){return e(n,t)&&u(n,t+6)+10<=n.length-t},a=function(n){for(var r,i=h(n),t=0;t<i.length;t++)if(r=i[t],s(r))return k(r)},s=function(n){return n&&"PRIV"===n.key&&"com.apple.streaming.transportStreamTimestamp"===n.info},v=function(n){var i=String.fromCharCode(n[0],n[1],n[2],n[3]),t=u(n,4);return{type:i,size:t,data:n.subarray(10,10+t)}},h=function(n){for(var s,h,r,f,t=0,i=[];e(n,t);){for(s=u(n,t+6),h=(t+=10)+s;t+8<h;)r=v(n.subarray(t)),f=y(r),f&&i.push(f),t+=r.size+10;o(n,t)&&(t+=10)}return i},y=function(n){return"PRIV"===n.type?p(n):"W"===n.type[0]?b(n):w(n)},p=function(n){if(!(n.size<2)){var t=r(n.data,!0),i=new Uint8Array(n.data.subarray(t.length+1));return{key:n.type,info:t,data:i.buffer}}},w=function(n){var t,i,u,f;if(!(n.size<2))return"TXXX"===n.type?(t=1,i=r(n.data.subarray(t),!0),t+=i.length+1,u=r(n.data.subarray(t)),{key:n.type,info:i,data:u}):(f=r(n.data.subarray(1)),{key:n.type,data:f})},b=function(n){var t,i,u,f;return"WXXX"===n.type?n.size<2?void 0:(t=1,i=r(n.data.subarray(t),!0),t+=i.length+1,u=r(n.data.subarray(t)),{key:n.type,info:i,data:u}):(f=r(n.data),{key:n.type,data:f})},k=function(n){if(8===n.data.byteLength){var t=new Uint8Array(n.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},r=function(n,t){var o,r,s;if(void 0===t&&(t=!1),o=d(),o)return(r=o.decode(n),t)?(s=r.indexOf("\0"),-1!==s?r.substring(0,s):r):r.replace(/\0/g,"");for(var i,e,h,c=n.length,u="",f=0;f<c;){if(0===(i=n[f++])&&t)return u;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(i);break;case 12:case 13:e=n[f++];u+=String.fromCharCode((31&i)<<6|63&e);break;case 14:e=n[f++];h=n[f++];u+=String.fromCharCode((15&i)<<12|(63&e)<<6|(63&h)<<0)}}return u}},function(n,t,i){"use strict";function r(n,t,i,r){void 0===i&&(i=1);void 0===r&&(r=!1);var u=n*t*i;return r?Math.round(u):u}function u(n,t,i,u){return void 0===i&&(i=1),void 0===u&&(u=!1),r(n,t,1/i,u)}function f(n,t){return void 0===t&&(t=!1),r(n,1e3,1/9e4,t)}function e(n,t){return void 0===t&&(t=1),r(n,9e4,1/t)}i.d(t,"c",function(){return u});i.d(t,"b",function(){return f});i.d(t,"a",function(){return e})},function(n,t,i){"use strict";function r(n,t,i){return Uint8Array.prototype.slice?n.slice(t,i):new Uint8Array(Array.prototype.slice.call(n,t,i))}i.d(t,"a",function(){return r})},function(n,t,i){"use strict";function st(n,t){return 255===n[t]&&240==(246&n[t+1])}function ht(n,t){return 1&n[t+1]?7:9}function w(n,t){return(3&n[t+3])<<11|n[t+4]<<3|(224&n[t+5])>>>5}function l(n,t){return t+1<n.length&&st(n,t)}function ai(n,t){var i,r,u;return l(n,t)?(i=ht(n,t),t+i>=n.length)?!1:(r=w(n,t),r<=i)?!1:(u=t+r,u===n.length||l(n,u)):!1}function ct(n,t,i,u,e){if(!n.samplerate){var s=function(n,t,i,u){var h,c,l,s,a=navigator.userAgent.toLowerCase(),y=u,v=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],e;if(h=1+((192&t[i+2])>>>6),e=(60&t[i+2])>>>2,!(e>v.length-1))return l=(1&t[i+2])<<2,l|=(192&t[i+3])>>>6,r.b.log("manifest codec:"+u+", ADTS type:"+h+", samplingIndex:"+e),/firefox/i.test(a)?e>=6?(h=5,s=new Array(4),c=e-3):(h=2,s=new Array(2),c=e):-1!==a.indexOf("android")?(h=2,s=new Array(2),c=e):(h=5,s=new Array(4),u&&(-1!==u.indexOf("mp4a.40.29")||-1!==u.indexOf("mp4a.40.5"))||!u&&e>=6?c=e-3:((u&&-1!==u.indexOf("mp4a.40.2")&&(e>=6&&1===l||/vivaldi/i.test(a))||!u&&1===l)&&(h=2,s=new Array(2)),c=e)),s[0]=h<<3,s[0]|=(14&e)>>1,s[1]|=(1&e)<<7,s[1]|=l<<3,5===h&&(s[1]|=(14&c)>>1,s[2]=(1&c)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:v[e],channelCount:l,codec:"mp4a.40."+h,manifestCodec:y};n.trigger(o.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+e})}(t,i,u,e);if(!s)return;n.config=s.config;n.samplerate=s.samplerate;n.channelCount=s.channelCount;n.codec=s.codec;n.manifestCodec=s.manifestCodec;r.b.log("parsed codec:"+n.codec+", rate:"+s.samplerate+", channels:"+s.channelCount)}}function lt(n){return 9216e4/n}function at(n,t,i,r,u){var f=function(n,t,i,r,u){var f=ht(n,t),e=w(n,t);if((e-=f)>0)return{headerLength:f,frameLength:e,stamp:i+r*u}}(t,i,r,u,lt(n.samplerate)),c;if(f){var s,l=f.frameLength,e=f.headerLength,a=f.stamp,o=e+l,h=Math.max(0,i+o-t.length);return h?(s=new Uint8Array(o-e)).set(t.subarray(i+e,t.length),0):s=t.subarray(i+e,i+o),c={unit:s,pts:a},h||n.samples.push(c),{sample:c,length:o,missing:h}}}function vt(n,t){return(vt=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function wt(n,t,i,r,u){var f,e,o;if(!(i+24>t.length)&&(f=bt(t,i),f&&i+f.frameLength<=t.length))return e=r+u*(9e4*f.samplesPerFrame/f.sampleRate),o={unit:t.subarray(i,i+f.frameLength),pts:e,dts:e},n.config=[],n.channelCount=f.channelCount,n.samplerate=f.sampleRate,n.samples.push(o),{sample:o,length:f.frameLength,missing:0}}function bt(n,t){var i=n[t+1]>>3&3,r=n[t+1]>>1&3,u=n[t+2]>>4&15,e=n[t+2]>>2&3,f;if(1!==i&&0!==u&&15!==u&&3!==e){var v=n[t+2]>>1&1,o=n[t+3]>>6,s=1e3*vi[14*(3===i?3-r:3===r?3:4)+u-1],h=yi[3*(3===i?0:2===i?1:2)+e],y=3===o?1:2,c=pi[i][r],l=wi[r],p=8*c*l,w=Math.floor(c*s/h+v)*l;return null===a&&(f=(navigator.userAgent||"").match(/Chrome\/(\d+)/i),a=f?parseInt(f[1]):0),!!a&&a<=87&&2===r&&s>=224e3&&0===o&&(n[t+3]=128|n[t+3]),{sampleRate:h,channelCount:y,frameLength:w,samplesPerFrame:p}}}function d(n,t){return 255===n[t]&&224==(224&n[t+1])&&0!=(6&n[t+1])}function kt(n,t){return t+1<n.length&&d(n,t)}function bi(n,t){var i,r,u;return t+1<n.length&&d(n,t)?(i=bt(n,t),r=4,null!=i&&i.frameLength&&(r=i.frameLength),u=t+r,u===n.length||kt(n,u)):!1}function v(n,t,i,r){return{key:n,frame:!1,pts:t,dts:i,units:[],debug:r,length:0}}function gi(n,t){return(31&n[t+10])<<8|n[t+11]}function nr(n,t,i,u){var f={audio:-1,avc:-1,id3:-1,isAAC:!0},o=t+3+((15&n[t+1])<<8|n[t+2])-4,e;for(t+=12+((15&n[t+10])<<8|n[t+11]);t<o;){e=(31&n[t+1])<<8|n[t+2];switch(n[t]){case 207:if(!u){r.b.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===f.audio&&(f.audio=e);break;case 21:-1===f.id3&&(f.id3=e);break;case 219:if(!u){r.b.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===f.avc&&(f.avc=e);break;case 3:case 4:i?-1===f.audio&&(f.audio=e,f.isAAC=!1):r.b.log("MPEG audio found, not supported in this browser");break;case 36:r.b.warn("Unsupported HEVC stream type found")}t+=5+((15&n[t+3])<<8|n[t+4])}return f}function h(n){var t,e,a,f,o,v=0,i=n.data,h,c,u,s;if(!n||0===n.size)return null;for(;i[0].length<19&&i.length>1;)h=new Uint8Array(i[0].length+i[1].length),h.set(i[0]),h.set(i[1],i[0].length),i[0]=h,i.splice(1,1);if(1===((t=i[0])[0]<<16)+(t[1]<<8)+t[2]){if((e=(t[4]<<8)+t[5])&&e>n.size-6||(c=t[7],192&c&&(f=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&c?f-(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(r.b.warn(Math.round((f-o)/9e4)+"s delta between PTS and DTS, align them"),f=o):o=f),u=(a=t[8])+9,n.size<=u))return null;n.size-=u;for(var y=new Uint8Array(n.size),l=0,p=i.length;l<p;l++){if(s=(t=i[l]).byteLength,u){if(u>s){u-=s;continue}t=t.subarray(u);s-=u;u=0}y.set(t,v);v+=s}return e&&(e-=a+3),{data:y,pts:f,dts:o,len:e}}return null}function nt(n,t){var i,u,f;if(n.units.length&&n.frame){if(void 0===n.pts){if(i=t.samples,u=i.length,!u)return void t.dropped++;f=i[u-1];n.pts=f.pts;n.dts=f.dts}t.samples.push(n)}n.debug.length&&r.b.log(n.pts+"/"+n.dts+":"+n.debug)}function gt(n,t){var r=n.length,i;if(r>0){if(t.pts>=n[r-1].pts)n.push(t);else for(i=r-1;i>=0;i--)if(t.pts<n[i].pts){n.splice(i,0,t);break}}else n.push(t)}function ni(n){for(var u=n.byteLength,i=[],t=1;t<u-2;)0===n[t]&&0===n[t+1]&&3===n[t+2]?(i.push(t+2),t+=2):t++;if(0===i.length)return n;var f=u-i.length,e=new Uint8Array(f),r=0;for(t=0;t<f;r++,t++)r===i[0]&&(r++,i.shift()),e[t]=n[r];return e}function ii(n,t){return(ii=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function ri(n,t){var i=null==n?void 0:n.codec;return i&&i.length>4?i:"hvc1"===i?"hvc1.1.c.L120.90":"av01"===i?"av01.0.04M.08":"avc1"===i||t===rt.a.VIDEO?"avc1.42e01e":"mp4a.40.5"}function ei(n){return"then"in n&&n.then instanceof Function}var b,yt,k,ti,tt,e,ut,ui,c,y,fi,ft,oi,si;i.d(t,"c",function(){return fi});i.d(t,"d",function(){return ei});i.d(t,"a",function(){return oi});i.d(t,"b",function(){return si});var o=i(0),f=i(2),et=i(15),p=i(3),s=i(7),u=i(6),hi=i(9),ci=function(){function t(){this._audioTrack=void 0;this._id3Track=void 0;this.frameIndex=0;this.cachedData=null;this.initPTS=null}var n=t.prototype;return n.resetInitSegment=function(){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},n.resetTimeStamp=function(){},n.resetContiguity=function(){},n.canParse=function(){return!1},n.appendFrame=function(){},n.demux=function(n,t){var h,l;this.cachedData&&(n=Object(u.a)(this.cachedData,n),this.cachedData=null);var f,e,i=s.b(n,0),r=i?i.length:0,a=this._audioTrack,c=this._id3Track,v=i?s.d(i):void 0,o=n.length;for(0!==this.frameIndex&&null!==this.initPTS||(this.initPTS=li(v,t)),i&&i.length>0&&c.samples.push({pts:this.initPTS,dts:this.initPTS,data:i}),e=this.initPTS;r<o;)this.canParse(n,r)?(h=this.appendFrame(a,n,r),h?(this.frameIndex++,e=h.sample.pts,f=r+=h.length):r=o):s.a(n,r)?(i=s.b(n,r),c.samples.push({pts:e,dts:e,data:i}),f=r+=i.length):r++,r===o&&f!==o&&(l=Object(hi.a)(n,f),this.cachedData=this.cachedData?Object(u.a)(this.cachedData,l):l);return{audioTrack:a,avcTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},id3Track:c,textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},n.demuxSampleAes=function(){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},n.flush=function(){var n=this.cachedData;return n&&(this.cachedData=null,this.demux(n,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},id3Track:this._id3Track,textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},n.destroy=function(){},t}(),li=function(n,t){return Object(p.a)(n)?90*n:9e4*t},ot=ci,r=i(1);b=function(n){function i(t,i){var r;return(r=n.call(this)||this).observer=void 0,r.config=void 0,r.observer=t,r.config=i,r}var t,f,u;return f=n,(t=i).prototype=Object.create(f.prototype),t.prototype.constructor=t,vt(t,f),u=i.prototype,u.resetInitSegment=function(t,i,r){n.prototype.resetInitSegment.call(this,t,i,r);this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}},i.probe=function(n){if(!n)return!1;for(var t=(s.b(n,0)||[]).length,i=n.length;t<i;t++)if(ai(n,t))return r.b.log("ADTS sync word found !"),!0;return!1},u.canParse=function(n,t){return function(n,t){return function(n,t){return t+5<n.length}(n,t)&&st(n,t)&&w(n,t)<=n.length-t}(n,t)},u.appendFrame=function(n,t,i){ct(n,this.observer,t,i,n.manifestCodec);var r=at(n,t,i,this.initPTS,this.frameIndex);if(r&&0===r.missing)return r},i}(ot);b.minProbeByteLength=9;yt=b;k=function(){function t(n,t){this.remainderData=null;this.config=void 0;this.config=t}var n=t.prototype;return n.resetTimeStamp=function(){},n.resetInitSegment=function(){},n.resetContiguity=function(){},t.probe=function(n){return Object(u.b)({data:n,start:0,end:Math.min(n.length,16384)},["moof"]).length>0},n.demux=function(n){var t=n,i={type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},r;return this.config.progressive?(this.remainderData&&(t=Object(u.a)(this.remainderData,n)),r=Object(u.h)(t),this.remainderData=r.remainder,i.samples=r.valid||new Uint8Array):i.samples=t,{audioTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},avcTrack:i,id3Track:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},n.flush=function(){var n={type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0};return n.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},avcTrack:n,id3Track:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0},textTrack:{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},n.demuxSampleAes=function(){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},n.destroy=function(){},t}();k.minProbeByteLength=1024;var pt=k,a=null,vi=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],yi=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],pi=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],wi=[0,1,1,4];var g=function(){function t(n){this.data=void 0;this.bytesAvailable=void 0;this.word=void 0;this.bitsAvailable=void 0;this.data=n;this.bytesAvailable=n.byteLength;this.word=0;this.bitsAvailable=0}var n=t.prototype;return n.loadWord=function(){var t=this.data,i=this.bytesAvailable,r=t.byteLength-i,u=new Uint8Array(4),n=Math.min(4,i);if(0===n)throw new Error("no bytes available");u.set(t.subarray(r,r+n));this.word=new DataView(u.buffer).getUint32(0);this.bitsAvailable=8*n;this.bytesAvailable-=n},n.skipBits=function(n){var t;this.bitsAvailable>n?(this.word<<=n,this.bitsAvailable-=n):(n-=this.bitsAvailable,n-=(t=n>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=n,this.bitsAvailable-=n)},n.readBits=function(n){var t=Math.min(this.bitsAvailable,n),i=this.word>>>32-t;return n>32&&r.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=n-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},n.skipLZ=function(){for(var n=0;n<this.bitsAvailable;++n)if(0!=(this.word&2147483648>>>n))return this.word<<=n,this.bitsAvailable-=n,n;return this.loadWord(),n+this.skipLZ()},n.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.skipEG=function(){this.skipBits(1+this.skipLZ())},n.readUEG=function(){var n=this.skipLZ();return this.readBits(n+1)-1},n.readEG=function(){var n=this.readUEG();return 1&n?1+n>>>1:-1*(n>>>1)},n.readBoolean=function(){return 1===this.readBits(1)},n.readUByte=function(){return this.readBits(8)},n.readUShort=function(){return this.readBits(16)},n.readUInt=function(){return this.readBits(32)},n.skipScalingList=function(n){for(var i=8,t=8,r=0;r<n;r++)0!==t&&(t=(i+this.readEG()+256)%256),i=0===t?i:t},n.readSPS=function(){var a,v,u,y=0,p=0,w=0,b=0,r=this.readUByte.bind(this),k=this.readBits.bind(this),t=this.readUEG.bind(this),e=this.readBoolean.bind(this),f=this.skipBits.bind(this),s=this.skipEG.bind(this),o=this.skipUEG.bind(this),d=this.skipScalingList.bind(this),i,h,c,n;if(r(),i=r(),(k(5),f(3),r(),o(),100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i)&&(h=t(),3===h&&f(1),o(),o(),f(1),e()))for(v=3!==h?8:12,u=0;u<v;u++)e()&&d(u<6?16:64);if(o(),c=t(),0===c)t();else if(1===c)for(f(1),s(),s(),a=t(),u=0;u<a;u++)s();o();f(1);var g=t(),nt=t(),l=k(1);if(0===l&&f(1),f(1),e()&&(y=t(),p=t(),w=t(),b=t()),n=[1,1],e()&&e())switch(r()){case 1:n=[1,1];break;case 2:n=[12,11];break;case 3:n=[10,11];break;case 4:n=[16,11];break;case 5:n=[40,33];break;case 6:n=[24,11];break;case 7:n=[20,11];break;case 8:n=[32,11];break;case 9:n=[80,33];break;case 10:n=[18,11];break;case 11:n=[15,11];break;case 12:n=[64,33];break;case 13:n=[160,99];break;case 14:n=[4,3];break;case 15:n=[3,2];break;case 16:n=[2,1];break;case 255:n=[r()<<8|r(),r()<<8|r()]}return{width:Math.ceil(16*(g+1)-2*y-2*p),height:(2-l)*(nt+1)*16-(l?2:4)*(w+b),pixelRatio:n}},n.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),ki=function(){function t(n,t,i){this.keyData=void 0;this.decrypter=void 0;this.keyData=i;this.decrypter=new et.a(n,t,{removePKCS7Padding:!1})}var n=t.prototype;return n.decryptBuffer=function(n,t){this.decrypter.decrypt(n,this.keyData.key.buffer,this.keyData.iv.buffer,t)},n.decryptAacSample=function(n,t,i,r){var u=n[t].unit,f=u.subarray(16,u.length-u.length%16),e=f.buffer.slice(f.byteOffset,f.byteOffset+f.length),o=this;this.decryptBuffer(e,function(f){var e=new Uint8Array(f);u.set(e,16);r||o.decryptAacSamples(n,t+1,i)})},n.decryptAacSamples=function(n,t,i){for(;;t++){if(t>=n.length)return void i();if(!(n[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(n,t,i,r),!r)return}}},n.getAvcEncryptedData=function(n){for(var u=16*Math.floor((n.length-48)/160)+16,i=new Int8Array(u),r=0,t=32;t<n.length-16;t+=160,r+=16)i.set(n.subarray(t,t+16),r);return i},n.getAvcDecryptedUnit=function(n,t){for(var u=new Uint8Array(t),i=0,r=32;r<n.length-16;r+=160,i+=16)n.set(u.subarray(i,i+16),r);return n},n.decryptAvcSample=function(n,t,i,r,u,f){var e=ni(u.data),s=this.getAvcEncryptedData(e),o=this;this.decryptBuffer(s.buffer,function(s){u.data=o.getAvcDecryptedUnit(e,s);f||o.decryptAvcSamples(n,t,i+1,r)})},n.decryptAvcSamples=function(n,t,i,r){var f,u,e;if(n instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=n.length)return void r();for(f=n[t].units;!(i>=f.length);i++)if(u=f[i],!(u.data.length<=48||1!==u.type&&5!==u.type)&&(e=this.decrypter.isSync(),this.decryptAvcSample(n,t,i,r,u,e),!e))return}},t}(),di={video:1,audio:2,id3:3,text:4},dt=function(){function t(n,t,i){this.observer=void 0;this.config=void 0;this.typeSupported=void 0;this.sampleAes=null;this.pmtParsed=!1;this.audioCodec=void 0;this.videoCodec=void 0;this._duration=0;this.aacLastPTS=null;this._initPTS=null;this._initDTS=null;this._pmtId=-1;this._avcTrack=void 0;this._audioTrack=void 0;this._id3Track=void 0;this._txtTrack=void 0;this.aacOverFlow=null;this.avcSample=null;this.remainderData=null;this.observer=n;this.config=t;this.typeSupported=i}t.probe=function(n){var i=t.syncOffset(n);return!(i<0)&&(i&&r.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),!0)};t.syncOffset=function(n){for(var i=Math.min(1e3,n.length-564),t=0;t<i;){if(71===n[t]&&71===n[t+188]&&71===n[t+376])return t;t++}return-1};t.createTrack=function(n,t){return{container:"video"===n||"audio"===n?"video/mp2t":void 0,type:n,id:di[n],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===n?t:void 0}};var n=t.prototype;return n.resetInitSegment=function(n,i,r){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=t.createTrack("video",r);this._audioTrack=t.createTrack("audio",r);this._id3Track=t.createTrack("id3",r);this._txtTrack=t.createTrack("text",r);this._audioTrack.isAAC=!0;this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=n;this.videoCodec=i;this._duration=r},n.resetTimeStamp=function(){},n.resetContiguity=function(){var n=this._audioTrack,t=this._avcTrack,i=this._id3Track;n&&(n.pesData=null);t&&(t.pesData=null);i&&(i.pesData=null);this.aacOverFlow=null;this.aacLastPTS=null},n.demux=function(n,i,e,s){var v,tt,it,c,nt,ot;void 0===e&&(e=!1);void 0===s&&(s=!1);e||(this.sampleAes=null);var k=this._avcTrack,a=this._audioTrack,d=this._id3Track,rt=k.pid,y=k.pesData,ut=a.pid,ft=d.pid,p=a.pesData,w=d.pesData,et=!1,st=this.pmtParsed,ht=this._pmtId,b=n.length;if(this.remainderData&&(b=(n=Object(u.a)(this.remainderData,n)).length,this.remainderData=null),b<188&&!s)return this.remainderData=n,{audioTrack:a,avcTrack:k,id3Track:d,textTrack:this._txtTrack};for(tt=Math.max(0,t.syncOffset(n)),(b-=(b+tt)%188)<n.byteLength&&!s&&(this.remainderData=new Uint8Array(n.buffer,b,n.buffer.byteLength-b)),it=0,c=tt;c<b;c+=188)if(71===n[c]){var g=!!(64&n[c+1]),ct=((31&n[c+1])<<8)+n[c+2],l=void 0;if((48&n[c+3])>>4>1){if((l=c+5+n[c+4])===c+188)continue}else l=c+4;switch(ct){case rt:g&&(y&&(v=h(y))&&this.parseAVCPES(v,!1),y={data:[],size:0});y&&(y.data.push(n.subarray(l,c+188)),y.size+=c+188-l);break;case ut:g&&(p&&(v=h(p))&&(a.isAAC?this.parseAACPES(v):this.parseMPEGPES(v)),p={data:[],size:0});p&&(p.data.push(n.subarray(l,c+188)),p.size+=c+188-l);break;case ft:g&&(w&&(v=h(w))&&this.parseID3PES(v),w={data:[],size:0});w&&(w.data.push(n.subarray(l,c+188)),w.size+=c+188-l);break;case 0:g&&(l+=n[l]+1);ht=this._pmtId=gi(n,l);break;case ht:g&&(l+=n[l]+1);nt=nr(n,l,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,e);(rt=nt.avc)>0&&(k.pid=rt);(ut=nt.audio)>0&&(a.pid=ut,a.isAAC=nt.isAAC);(ft=nt.id3)>0&&(d.pid=ft);et&&!st&&(r.b.log("reparse from beginning"),et=!1,c=tt-188);st=this.pmtParsed=!0;break;case 17:case 8191:break;default:et=!0}}else it++;return it>0&&this.observer.emit(o.a.ERROR,o.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+it+" TS packet/s that do not start with 0x47"}),k.pesData=y,a.pesData=p,d.pesData=w,ot={audioTrack:a,avcTrack:k,id3Track:d,textTrack:this._txtTrack},s&&this.extractRemainingSamples(ot),ot},n.flush=function(){var n,t=this.remainderData;return this.remainderData=null,n=t?this.demux(t,-1,!1,!0):{audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(n),this.sampleAes?this.decrypt(n,this.sampleAes):n},n.extractRemainingSamples=function(n){var t,u=n.audioTrack,f=n.avcTrack,e=n.id3Track,o=f.pesData,i=u.pesData,s=e.pesData;o&&(t=h(o))?(this.parseAVCPES(t,!0),f.pesData=null):f.pesData=o;i&&(t=h(i))?(u.isAAC?this.parseAACPES(t):this.parseMPEGPES(t),u.pesData=null):(null!=i&&i.size&&r.b.log("last AAC PES packet truncated,might overlap between fragments"),u.pesData=i);s&&(t=h(s))?(this.parseID3PES(t),e.pesData=null):e.pesData=s},n.demuxSampleAes=function(n,t,i){var r=this.demux(n,i,!0,!this.config.progressive),u=this.sampleAes=new ki(this.observer,this.config,t);return this.decrypt(r,u)},n.decrypt=function(n,t){return new Promise(function(i){var u=n.audioTrack,r=n.avcTrack;u.samples&&u.isAAC?t.decryptAacSamples(u.samples,0,function(){r.samples?t.decryptAvcSamples(r.samples,0,0,function(){i(n)}):i(n)}):r.samples&&t.decryptAvcSamples(r.samples,0,0,function(){i(n)})})},n.destroy=function(){this._initPTS=this._initDTS=null;this._duration=0},n.parseAVCPES=function(n,t){var u,f=this,r=this._avcTrack,e=this.parseAVCNALu(n.data),i=this.avcSample,o=!1;n.data=null;i&&e.length&&!r.audFound&&(nt(i,r),i=this.avcSample=v(!1,n.pts,n.dts,""));e.forEach(function(t){var d,l,e,b,h,ut,k,y;switch(t.type){case 1:u=!0;i||(i=f.avcSample=v(!0,n.pts,n.dts,""));i.frame=!0;d=t.data;o&&d.length>4&&(l=new g(d).readSliceType(),2!==l&&4!==l&&7!==l&&9!==l||(i.key=!0));break;case 5:u=!0;i||(i=f.avcSample=v(!0,n.pts,n.dts,""));i.key=!0;i.frame=!0;break;case 6:u=!0;e=new g(ni(t.data));e.readUByte();for(var a=0,c=0,tt=!1,p=0;!tt&&e.bytesAvailable>1;){a=0;do a+=p=e.readUByte();while(255===p);c=0;do c+=p=e.readUByte();while(255===p);if(4===a&&0!==e.bytesAvailable){if((tt=!0,181===e.readUByte())&&49===e.readUShort()&&1195456820===e.readUInt()&&3===e.readUByte()){for(var et=e.readUByte(),ct=31&et,w=[et,e.readUByte()],ot=0;ot<ct;ot++)w.push(e.readUByte()),w.push(e.readUByte()),w.push(e.readUByte());gt(f._txtTrack.samples,{type:3,pts:n.pts,bytes:w})}}else if(5===a&&0!==e.bytesAvailable){if(tt=!0,c>16){for(b=[],h=0;h<16;h++)b.push(e.readUByte().toString(16)),3!==h&&5!==h&&7!==h&&9!==h||b.push("-");for(var st=c-16,it=new Uint8Array(st),rt=0;rt<st;rt++)it[rt]=e.readUByte();gt(f._txtTrack.samples,{pts:n.pts,payloadType:a,uuid:b.join(""),userData:Object(s.f)(it),userDataBytes:it})}}else if(c<e.bytesAvailable)for(ut=0;ut<c;ut++)e.readUByte()}break;case 7:if(u=!0,o=!0,!r.sps){k=new g(t.data).readSPS();r.width=k.width;r.height=k.height;r.pixelRatio=k.pixelRatio;r.sps=[t.data];r.duration=f._duration;for(var lt=t.data.subarray(1,4),ht="avc1.",ft=0;ft<3;ft++)y=lt[ft].toString(16),y.length<2&&(y="0"+y),ht+=y;r.codec=ht}break;case 8:u=!0;r.pps||(r.pps=[t.data]);break;case 9:u=!1;r.audFound=!0;i&&nt(i,r);i=f.avcSample=v(!1,n.pts,n.dts,"");break;case 12:u=!1;break;default:u=!1;i&&(i.debug+="unknown NAL "+t.type+" ")}i&&u&&i.units.push(t)});t&&i&&(nt(i,r),this.avcSample=null)},n.getLastNalUnit=function(){var t,u,n=this.avcSample,i,r;return n&&0!==n.units.length||(i=this._avcTrack.samples,n=i[i.length-1]),null!==(t=n)&&void 0!==t&&t.units&&(r=n.units,u=r[r.length-1]),u},n.parseAVCNALu=function(n){var e,l,a=n.byteLength,y=this._avcTrack,t=y.naluState||0,v=t,o=[],r=0,u=-1,s=0,p,i,h,w,f,c;for(-1===t&&(u=0,s=31&n[0],t=0,r=1);r<a;)(e=n[r++],t)?1!==t?e?1===e?(u>=0?(p={data:n.subarray(u,r-t-1),type:s},o.push(p)):(i=this.getLastNalUnit(),i&&(v&&r<=4-v&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-v)),(l=r-t-1)>0)&&(h=new Uint8Array(i.data.byteLength+l),h.set(i.data,0),h.set(n.subarray(0,l),i.data.byteLength),i.data=h,i.state=0)),r<a?(u=r,s=31&n[r],t=0):t=-1):t=0:t=3:t=e?0:2:t=e?0:1;return u>=0&&t>=0&&(w={data:n.subarray(u,a),type:s,state:t},o.push(w)),0===o.length&&(f=this.getLastNalUnit(),f&&(c=new Uint8Array(f.data.byteLength+n.byteLength),c.set(f.data,0),c.set(n,f.data.byteLength),f.data=c)),y.naluState=t,o},n.parseAACPES=function(n){var t,e,h,c,v,y=0,a=this._audioTrack,i=this.aacOverFlow,u=n.data,k,p,s;if(i){this.aacOverFlow=null;var w=i.sample.unit.byteLength,b=Math.min(i.missing,w),d=w-b;i.sample.unit.set(u.subarray(0,b),d);a.samples.push(i.sample);y=i.missing}for(t=y,e=u.length;t<e-1&&!l(u,t);t++);if(t===y||(t<e-1?(h="AAC PES did not start with ADTS header,offset:"+t,c=!1):(h="no ADTS header found in AAC PES",c=!0),r.b.warn("parsing error:"+h),this.observer.emit(o.a.ERROR,o.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:c,reason:h}),!c)){if(ct(a,this.observer,u,t,this.audioCodec),void 0!==n.pts)v=n.pts;else{if(!i)return void r.b.warn("[tsdemuxer]: AAC PES unknown PTS");k=lt(a.samplerate);v=i.sample.pts+k}for(p=0;t<e;){if(l(u,t)){if(t+5<e&&(s=at(a,u,t,v,p),s)){if(!s.missing){t+=s.length;p++;continue}this.aacOverFlow=s}break}t++}}},n.parseMPEGPES=function(n){var i=n.data,o=i.length,f=0,t=0,e=n.pts,u;if(void 0!==e)for(;t<o;)if(kt(i,t)){if(u=wt(this._audioTrack,i,t,e,f),!u)break;t+=u.length;f++}else t++;else r.b.warn("[tsdemuxer]: MPEG PES unknown PTS")},n.parseID3PES=function(n){void 0!==n.pts?this._id3Track.samples.push(n):r.b.warn("[tsdemuxer]: ID3 PES unknown PTS")},t}();dt.minProbeByteLength=188;ti=dt;tt=function(n){function i(){return n.apply(this,arguments)||this}var t,f,u;return f=n,(t=i).prototype=Object.create(f.prototype),t.prototype.constructor=t,ii(t,f),u=i.prototype,u.resetInitSegment=function(t,i,r){n.prototype.resetInitSegment.call(this,t,i,r);this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}},i.probe=function(n){if(!n)return!1;for(var t=(s.b(n,0)||[]).length,i=n.length;t<i;t++)if(bi(n,t))return r.b.log("MPEG Audio sync word found !"),!0;return!1},u.canParse=function(n,t){return function(n,t){return d(n,t)&&4<=n.length-t}(n,t)},u.appendFrame=function(n,t,i){if(null!==this.initPTS)return wt(n,t,i,this.initPTS,this.frameIndex)},i}(ot);tt.minProbeByteLength=4;var tr=tt,it=i(16),rt=i(5),ir=function(){function t(){this.emitInitSegment=!1;this.audioCodec=void 0;this.videoCodec=void 0;this.initData=void 0;this.initPTS=void 0;this.initTracks=void 0;this.lastEndDTS=null}var n=t.prototype;return n.destroy=function(){},n.resetTimeStamp=function(n){this.initPTS=n;this.lastEndDTS=null},n.resetNextTimestamp=function(){this.lastEndDTS=null},n.resetInitSegment=function(n,t,i){this.audioCodec=t;this.videoCodec=i;this.generateInitSegment(n);this.emitInitSegment=!0},n.generateInitSegment=function(n){var f=this.audioCodec,e=this.videoCodec,t,i;if(!n||!n.byteLength)return this.initTracks=void 0,void(this.initData=void 0);t=this.initData=Object(u.f)(n);f||(f=ri(t.audio,rt.a.AUDIO));e||(e=ri(t.video,rt.a.VIDEO));i={};t.audio&&t.video?i.audiovideo={container:"video/mp4",codec:f+","+e,initSegment:n,id:"main"}:t.audio?i.audio={container:"audio/mp4",codec:f,initSegment:n,id:"audio"}:t.video?i.video={container:"video/mp4",codec:e,initSegment:n,id:"main"}:r.b.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes.");this.initTracks=i},n.remux=function(n,t,i,f,e){var v=this.initPTS,l=this.lastEndDTS,s={audio:void 0,video:void 0,text:f,id3:i,initSegment:void 0},h,a,o,c;if(Object(p.a)(l)||(l=this.lastEndDTS=e||0),h=t.samples,!h||!h.length)return s;if(a={initPTS:void 0,timescale:1},o=this.initData,o&&o.length||(this.generateInitSegment(h),o=this.initData),!o||!o.length)return r.b.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),s;this.emitInitSegment&&(a.tracks=this.initTracks,this.emitInitSegment=!1);Object(p.a)(v)||(this.initPTS=a.initPTS=v=rr(o,h,l));var k=Object(u.c)(h,o),y=l,w=k+y;Object(u.e)(o,h,v);k>0?this.lastEndDTS=w:(r.b.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var d=!!o.audio,g=!!o.video,b="";return d&&(b+="audio"),g&&(b+="video"),c={data1:h,startPTS:y,startDTS:y,endPTS:w,endDTS:w,type:b,hasAudio:d,hasVideo:g,nb:1,dropped:0},s.audio="audio"===c.type?c:void 0,s.video="audio"!==c.type?c:void 0,s.text=f,s.id3=i,s.initSegment=a,s},t}(),rr=function(n,t,i){return Object(u.d)(n,t)-i};ut=ir;ui=i(13);try{e=self.performance.now.bind(self.performance)}catch(n){r.b.debug("Unable to use Performance API on this environment");e=self.Date.now}c=[{demux:ti,remux:it.a},{demux:pt,remux:ut},{demux:yt,remux:it.a},{demux:tr,remux:it.a}];y=1024;c.forEach(function(n){var t=n.demux;y=Math.max(y,t.minProbeByteLength)});fi=function(){function t(n,t,i,r,u){this.observer=void 0;this.typeSupported=void 0;this.config=void 0;this.vendor=void 0;this.id=void 0;this.demuxer=void 0;this.remuxer=void 0;this.decrypter=void 0;this.probe=void 0;this.decryptionPromise=null;this.transmuxConfig=void 0;this.currentTransmuxState=void 0;this.cache=new ui.a;this.observer=n;this.typeSupported=t;this.config=i;this.vendor=r;this.id=u}var n=t.prototype;return n.configure=function(n){this.transmuxConfig=n;this.decrypter&&this.decrypter.reset()},n.push=function(n,t,i,r){var p=this,l=i.transmuxing,o,a,v,d,g,c;l.executeStart=e();var f=new Uint8Array(n),w=this.cache,nt=this.config,tt=this.currentTransmuxState,s=this.transmuxConfig;if(r&&(this.currentTransmuxState=r),o=function(n,t){var i=null;return n.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(i=t),i}(f,t),o&&"AES-128"===o.method){if(a=this.getDecrypter(),!nt.enableSoftwareAES)return this.decryptionPromise=a.webCryptoDecrypt(f,o.key.buffer,o.iv.buffer).then(function(n){var t=p.push(n,null,i);return p.decryptionPromise=null,t}),this.decryptionPromise;if(v=a.softwareDecrypt(f,o.key.buffer,o.iv.buffer),!v)return l.executeEnd=e(),ft(i);f=new Uint8Array(v)}var h=r||tt,it=h.contiguous,y=h.discontinuity,b=h.trackSwitch,rt=h.accurateTimeOffset,ut=h.timeOffset,k=h.initSegmentChange,et=s.audioCodec,ot=s.videoCodec,st=s.defaultInitPts,ht=s.duration,ct=s.initSegmentData;return((y||b||k)&&this.resetInitSegment(ct,et,ot,ht),(y||k)&&this.resetInitialTimestamp(st),it||this.resetContiguity(),this.needsProbing(f,y,b))&&(w.dataLength&&(d=w.flush(),f=Object(u.a)(d,f)),this.configureTransmuxer(f,s)),g=this.transmux(f,o,ut,rt,i),c=this.currentTransmuxState,c.contiguous=!0,c.discontinuity=!1,c.trackSwitch=!1,l.executeEnd=e(),g},n.flush=function(n){var s=this,h=n.transmuxing,t,v,r,p,u,w,i;h.executeStart=e();var c=this.decrypter,l=this.cache,b=this.currentTransmuxState,a=this.decryptionPromise;return a?a.then(function(){return s.flush(n)}):(t=[],v=b.timeOffset,c&&(r=c.flush(),r&&t.push(this.push(r,null,n))),p=l.dataLength,l.reset(),u=this.demuxer,w=this.remuxer,!u||!w)?(p>=y&&this.observer.emit(o.a.ERROR,o.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),h.executeEnd=e(),[ft(n)]):(i=u.flush(v),ei(i)?i.then(function(i){return s.flushRemux(t,i,n),t}):(this.flushRemux(t,i,n),t))},n.flushRemux=function(n,t,i){var o=t.audioTrack,s=t.avcTrack,h=t.id3Track,c=t.textTrack,u=this.currentTransmuxState,l=u.accurateTimeOffset,a=u.timeOffset,f;r.b.log("[transmuxer.ts]: Flushed fragment "+i.sn+(i.part>-1?" p: "+i.part:"")+" of level "+i.level);f=this.remuxer.remux(o,s,h,c,a,l,!0,this.id);n.push({remuxResult:f,chunkMeta:i});i.transmuxing.executeEnd=e()},n.resetInitialTimestamp=function(n){var t=this.demuxer,i=this.remuxer;t&&i&&(t.resetTimeStamp(n),i.resetTimeStamp(n))},n.resetContiguity=function(){var n=this.demuxer,t=this.remuxer;n&&t&&(n.resetContiguity(),t.resetNextTimestamp())},n.resetInitSegment=function(n,t,i,r){var u=this.demuxer,f=this.remuxer;u&&f&&(u.resetInitSegment(t,i,r),f.resetInitSegment(n,t,i))},n.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0);this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},n.transmux=function(n,t,i,r,u){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(n,t,i,r,u):this.transmuxUnencrypted(n,i,r,u)},n.transmuxUnencrypted=function(n,t,i,r){var u=this.demuxer.demux(n,t,!1,!this.config.progressive),f=u.audioTrack,e=u.avcTrack,o=u.id3Track,s=u.textTrack;return{remuxResult:this.remuxer.remux(f,e,o,s,t,i,!1,this.id),chunkMeta:r}},n.transmuxSampleAes=function(n,t,i,r,u){var f=this;return this.demuxer.demuxSampleAes(n,t,i).then(function(n){return{remuxResult:f.remuxer.remux(n.audioTrack,n.avcTrack,n.id3Track,n.textTrack,i,r,!1,f.id),chunkMeta:u}})},n.configureTransmuxer=function(n,t){for(var i,e=this.config,o=this.observer,s=this.typeSupported,v=this.vendor,y=t.audioCodec,p=t.defaultInitPts,w=t.duration,b=t.initSegmentData,k=t.videoCodec,u=0,d=c.length;u<d;u++)if(c[u].demux.probe(n)){i=c[u];break}i||(r.b.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),i={demux:pt,remux:ut});var h=this.demuxer,l=this.remuxer,a=i.remux,f=i.demux;l&&l instanceof a||(this.remuxer=new a(o,e,s,v));h&&h instanceof f||(this.demuxer=new f(o,e,s),this.probe=f.probe);this.resetInitSegment(b,y,k,w);this.resetInitialTimestamp(p)},n.needsProbing=function(n,t,i){return!this.demuxer||!this.remuxer||t||i},n.getDecrypter=function(){var n=this.decrypter;return n||(n=this.decrypter=new et.a(this.observer,this.config)),n},t}();ft=function(n){return{remuxResult:{},chunkMeta:n}};oi=function(n,t,i,r,u){this.audioCodec=void 0;this.videoCodec=void 0;this.initSegmentData=void 0;this.duration=void 0;this.defaultInitPts=void 0;this.audioCodec=n;this.videoCodec=t;this.initSegmentData=i;this.duration=r;this.defaultInitPts=u};si=function(n,t,i,r,u,f){this.discontinuity=void 0;this.contiguous=void 0;this.accurateTimeOffset=void 0;this.trackSwitch=void 0;this.timeOffset=void 0;this.initSegmentChange=void 0;this.discontinuity=n;this.contiguous=t;this.accurateTimeOffset=i;this.trackSwitch=r;this.timeOffset=u;this.initSegmentChange=f}},function(n){var i,r,u,f,t;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/;r=/^([^\/?#]*)([^]*)$/;u=/(?:\/|^)\.(?=\/)/g;f=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g;t={buildAbsoluteURL:function(n,i,u){var s,f,e,h,o,c,l;if(u=u||{},n=n.trim(),!(i=i.trim())){if(!u.alwaysNormalize)return n;if(s=t.parseURL(n),!s)throw new Error("Error trying to parse base URL.");return s.path=t.normalizePath(s.path),t.buildURLFromParts(s)}if(f=t.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(e=t.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return!e.netLoc&&e.path&&"/"!==e.path[0]&&(h=r.exec(e.path),e.netLoc=h[1],e.path=h[2]),e.netLoc&&!e.path&&(e.path="/"),o={scheme:e.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(o.netLoc=e.netLoc,"/"===f.path[0])||(f.path?(c=e.path,l=c.substring(0,c.lastIndexOf("/")+1)+f.path,o.path=t.normalizePath(l)):(o.path=e.path,f.params||(o.params=e.params,f.query||(o.query=e.query)))),null===o.path&&(o.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(o)},parseURL:function(n){var t=i.exec(n);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(n){for(n=n.split("").reverse().join("").replace(u,"");n.length!==(n=n.replace(f,"")).length;);return n.split("").reverse().join("")},buildURLFromParts:function(n){return n.scheme+n.netLoc+n.path+n.params+n.query+n.fragment}};n.exports=t},function(n,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){this.aborted=!1;this.loaded=0;this.retry=0;this.total=0;this.chunkCount=0;this.bwEstimate=0;this.loading={start:0,first:0,end:0};this.parsing={start:0,end:0};this.buffering={start:0,first:0,end:0}}},function(n,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(){function t(){this.chunks=[];this.dataLength=0}var n=t.prototype;return n.push=function(n){this.chunks.push(n);this.dataLength+=n.length},n.flush=function(){var t,n=this.chunks,i=this.dataLength;return n.length?(t=1===n.length?n[0]:function(n,t){for(var r,u=new Uint8Array(t),f=0,i=0;i<n.length;i++)r=n[i],u.set(r,f),f+=r.length;return u}(n,i),this.reset(),t):new Uint8Array(0)},n.reset=function(){this.chunks.length=0;this.dataLength=0},t}()},function(n){"use strict";function r(){}function o(n,t,i){this.fn=n;this.context=t;this.once=i||!1}function f(n,t,r,u,f){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,u||n,f),e=i?i+t:t;return n._events[e]?n._events[e].fn?n._events[e]=[n._events[e],s]:n._events[e].push(s):(n._events[e]=s,n._eventsCount++),n}function u(n,t){0==--n._eventsCount?n._events=new r:delete n._events[t]}function t(){this._events=new r;this._eventsCount=0}var e=Object.prototype.hasOwnProperty,i="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1));t.prototype.eventNames=function(){var r,n,t=[];if(0===this._eventsCount)return t;for(n in r=this._events)e.call(r,n)&&t.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};t.prototype.listeners=function(n){var e=i?i+n:n,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var r=0,u=t.length,f=new Array(u);r<u;r++)f[r]=t[r].fn;return f};t.prototype.listenerCount=function(n){var r=i?i+n:n,t=this._events[r];return t?t.fn?1:t.length:0};t.prototype.emit=function(n,t,r,u,f,e){var a=i?i+n:n,h,s,o,c,l,v;if(!this._events[a])return!1;if(o=this._events[a],c=arguments.length,o.fn){switch(o.once&&this.removeListener(n,o.fn,void 0,!0),c){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,t),!0;case 3:return o.fn.call(o.context,t,r),!0;case 4:return o.fn.call(o.context,t,r,u),!0;case 5:return o.fn.call(o.context,t,r,u,f),!0;case 6:return o.fn.call(o.context,t,r,u,f,e),!0}for(s=1,h=new Array(c-1);s<c;s++)h[s-1]=arguments[s];o.fn.apply(o.context,h)}else for(v=o.length,s=0;s<v;s++)switch(o[s].once&&this.removeListener(n,o[s].fn,void 0,!0),c){case 1:o[s].fn.call(o[s].context);break;case 2:o[s].fn.call(o[s].context,t);break;case 3:o[s].fn.call(o[s].context,t,r);break;case 4:o[s].fn.call(o[s].context,t,r,u);break;default:if(!h)for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];o[s].fn.apply(o[s].context,h)}return!0};t.prototype.on=function(n,t,i){return f(this,n,t,i,!1)};t.prototype.once=function(n,t,i){return f(this,n,t,i,!0)};t.prototype.removeListener=function(n,t,r,f){var o=i?i+n:n,e;if(!this._events[o])return this;if(!t)return u(this,o),this;if(e=this._events[o],e.fn)e.fn!==t||f&&!e.once||r&&e.context!==r||u(this,o);else{for(var s=0,h=[],c=e.length;s<c;s++)(e[s].fn!==t||f&&!e[s].once||r&&e[s].context!==r)&&h.push(e[s]);h.length?this._events[o]=1===h.length?h[0]:h:u(this,o)}return this};t.prototype.removeAllListeners=function(n){var t;return n?(t=i?i+n:n,this._events[t]&&u(this,t)):(this._events=new r,this._eventsCount=0),this};t.prototype.off=t.prototype.removeListener;t.prototype.addListener=t.prototype.on;t.prefixed=i;t.EventEmitter=t;n.exports=t},function(n,t,i){"use strict";i.d(t,"a",function(){return h});var f=function(){function n(n,t){this.subtle=void 0;this.aesIV=void 0;this.subtle=n;this.aesIV=t}return n.prototype.decrypt=function(n,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,n)},n}(),e=function(){function n(n,t){this.subtle=void 0;this.key=void 0;this.subtle=n;this.key=t}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}(),r=i(9),o=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.ksRows=0;this.keySize=0;this.keySchedule=void 0;this.invKeySchedule=void 0;this.initTable()}var n=t.prototype;return n.uint8ArrayToUint32Array_=function(n){for(var r=new DataView(n),i=new Uint32Array(4),t=0;t<4;t++)i[t]=r.getUint32(4*t);return i},n.initTable=function(){for(var l=this.sBox,a=this.invSBox,e=this.subMix,v=e[0],y=e[1],p=e[2],w=e[3],o=this.invSubMix,b=o[0],k=o[1],d=o[2],g=o[3],r=new Uint32Array(256),i=0,f=0,u=0,t,u=0;u<256;u++)r[u]=u<128?u<<1:u<<1^283;for(u=0;u<256;u++){t=f^f<<1^f<<2^f<<3^f<<4;t=t>>>8^255&t^99;l[i]=t;a[t]=i;var s=r[i],h=r[s],c=r[h],n=257*r[t]^16843008*t;v[i]=n<<24|n>>>8;y[i]=n<<16|n>>>16;p[i]=n<<8|n>>>24;w[i]=n;n=16843009*c^65537*h^257*s^16843008*i;b[t]=n<<24|n>>>8;k[t]=n<<16|n>>>16;d[t]=n<<8|n>>>24;g[t]=n;i?(i=s^r[r[r[c^s]]],f^=r[r[f]]):i=f=1}},n.expandKey=function(n){for(var r,e=this.uint8ArrayToUint32Array_(n),l=!0,h=0;h<e.length&&l;)l=e[h]===this.key[h],h++;if(!l){if(this.key=e,r=this.keySize=e.length,4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);for(var f,a,t,o=this.ksRows=4*(r+6+1),s=this.keySchedule=new Uint32Array(o),v=this.invKeySchedule=new Uint32Array(o),u=this.sBox,y=this.rcon,c=this.invSubMix,p=c[0],w=c[1],b=c[2],k=c[3],i=0;i<o;i++)i<r?a=s[i]=e[i]:(t=a,i%r==0?(t=u[(t=t<<8|t>>>24)>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t],t^=y[i/r|0]<<24):r>6&&i%r==4&&(t=u[t>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t]),s[i]=a=(s[i-r]^t)>>>0);for(f=0;f<o;f++)i=o-f,t=3&f?s[i]:s[i-4],v[f]=f<4||i<=4?t:p[u[t>>>24]]^w[u[t>>>16&255]]^b[u[t>>>8&255]]^k[u[255&t]],v[f]=v[f]>>>0}},n.networkToHostOrderSwap=function(n){return n<<24|(65280&n)<<8|(16711680&n)>>8|n>>>24},n.decrypt=function(n,t,i){for(var v,y,p,w,f,e,o,s,it,rt,ut,ft,h,et,lt=this.keySize+6,u=this.invKeySchedule,r=this.invSBox,b=this.invSubMix,k=b[0],d=b[1],g=b[2],nt=b[3],tt=this.uint8ArrayToUint32Array_(i),ot=tt[0],st=tt[1],ht=tt[2],ct=tt[3],l=new Int32Array(n),a=new Int32Array(l.length),c=this.networkToHostOrderSwap;t<l.length;){for(it=c(l[t]),rt=c(l[t+1]),ut=c(l[t+2]),ft=c(l[t+3]),f=it^u[0],e=ft^u[1],o=ut^u[2],s=rt^u[3],h=4,et=1;et<lt;et++)v=k[f>>>24]^d[e>>16&255]^g[o>>8&255]^nt[255&s]^u[h],y=k[e>>>24]^d[o>>16&255]^g[s>>8&255]^nt[255&f]^u[h+1],p=k[o>>>24]^d[s>>16&255]^g[f>>8&255]^nt[255&e]^u[h+2],w=k[s>>>24]^d[f>>16&255]^g[e>>8&255]^nt[255&o]^u[h+3],f=v,e=y,o=p,s=w,h+=4;v=r[f>>>24]<<24^r[e>>16&255]<<16^r[o>>8&255]<<8^r[255&s]^u[h];y=r[e>>>24]<<24^r[o>>16&255]<<16^r[s>>8&255]<<8^r[255&f]^u[h+1];p=r[o>>>24]<<24^r[s>>16&255]<<16^r[f>>8&255]<<8^r[255&e]^u[h+2];w=r[s>>>24]<<24^r[f>>16&255]<<16^r[e>>8&255]<<8^r[255&o]^u[h+3];a[t]=c(v^ot);a[t+1]=c(w^st);a[t+2]=c(p^ht);a[t+3]=c(y^ct);ot=it;st=rt;ht=ut;ct=ft;t+=4}return a.buffer},t}(),u=i(1),s=i(6),h=function(){function t(n,t,i){var u=(void 0===i?{}:i).removePKCS7Padding,f=void 0===u||u,r;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=n,this.config=t,this.removePKCS7Padding=f,f)try{r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(n){}null===this.subtle&&(this.config.enableSoftwareAES=!0)}var n=t.prototype;return n.destroy=function(){this.observer=null},n.isSync=function(){return this.config.enableSoftwareAES},n.flush=function(){var u=this.currentResult,n,t,f,i;if(u)return i=new Uint8Array(u),this.reset(),this.removePKCS7Padding?(t=(n=i).byteLength,(f=t&&new DataView(n.buffer).getUint8(t-1))?Object(r.a)(n,0,t-f):n):i;this.reset()},n.reset=function(){this.currentResult=null;this.currentIV=null;this.remainderData=null;this.softwareDecrypter&&(this.softwareDecrypter=null)},n.decrypt=function(n,t,i,r){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(n),t,i);var u=this.flush();u&&r(u.buffer)}else this.webCryptoDecrypt(new Uint8Array(n),t,i).then(r)},n.softwareDecrypt=function(n,t,i){var e=this.currentIV,l=this.currentResult,h=this.remainderData,f,u,c;return(this.logOnce("JS AES decrypt"),h&&(n=Object(s.a)(h,n),this.remainderData=null),f=this.getValidChunk(n),!f.length)?null:(e&&(i=e),u=this.softwareDecrypter,u||(u=this.softwareDecrypter=new o),u.expandKey(t),c=l,this.currentResult=u.decrypt(f.buffer,0,i),this.currentIV=Object(r.a)(f,-16).buffer,c||null)},n.webCryptoDecrypt=function(n,t,i){var u=this,r=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new e(r,t)),this.fastAesKey.expandKey().then(function(t){return r?new f(r,i).decrypt(n.buffer,t):Promise.reject(new Error("web crypto not initialized"))}).catch(function(r){return u.onWebCryptoError(r,n,t,i)})},n.onWebCryptoError=function(n,t,i,r){return u.b.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",n),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(t,i,r)},n.getValidChunk=function(n){var i=n,t=n.length-n.length%16;return t!==n.length&&(i=Object(r.a)(n,0,t),this.remainderData=Object(r.a)(n,t)),i},n.logOnce=function(n){this.logEnabled&&(u.b.log("[decrypter.ts]: "+n),this.logEnabled=!1)},t}()},function(n,t,i){"use strict";function v(){return(v=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function f(n,t){var i;if(null===t)return n;for(i=t<n?-8589934592:8589934592;Math.abs(n-t)>4294967296;)n+=i;return n}var y,b;i.d(t,"a",function(){return g});i.d(t,"b",function(){return f});var k=i(3),p=function(){function n(){}return n.getSilentFrame=function(n,t){switch(n){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},n}(),e=Math.pow(2,32)-1,u=function(){function n(){}return n.init=function(){var t,i,r,u,f;for(t in n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},n.types)n.types.hasOwnProperty(t)&&(n.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);n.HDLR_TYPES={video:i,audio:r};u=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);f=new Uint8Array([0,0,0,0,0,0,0,0]);n.STTS=n.STSC=n.STCO=f;n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var e=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,e,s,e,o);n.DINF=n.box(n.types.dinf,n.box(n.types.dref,u))},n.box=function(n){for(var i,o,r,t=8,e=arguments.length,u=new Array(e>1?e-1:0),f=1;f<e;f++)u[f-1]=arguments[f];for(i=u.length,o=i;i--;)t+=u[i].byteLength;for(r=new Uint8Array(t),r[0]=t>>24&255,r[1]=t>>16&255,r[2]=t>>8&255,r[3]=255&t,r.set(n,4),i=0,t=8;i<o;i++)r.set(u[i],t),t+=u[i].byteLength;return r},n.hdlr=function(t){return n.box(n.types.hdlr,n.HDLR_TYPES[t])},n.mdat=function(t){return n.box(n.types.mdat,t)},n.mdhd=function(t,i){i*=t;var r=Math.floor(i/(e+1)),u=Math.floor(i%(e+1));return n.box(n.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,u>>24,u>>16&255,u>>8&255,255&u,85,196,0,0]))},n.mdia=function(t){return n.box(n.types.mdia,n.mdhd(t.timescale,t.duration),n.hdlr(t.type),n.minf(t))},n.mfhd=function(t){return n.box(n.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},n.minf=function(t){return"audio"===t.type?n.box(n.types.minf,n.box(n.types.smhd,n.SMHD),n.DINF,n.stbl(t)):n.box(n.types.minf,n.box(n.types.vmhd,n.VMHD),n.DINF,n.stbl(t))},n.moof=function(t,i,r){return n.box(n.types.moof,n.mfhd(t),n.traf(r,i))},n.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=n.trak(t[i]);return n.box.apply(null,[n.types.moov,n.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(n.mvex(t)))},n.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=n.trex(t[i]);return n.box.apply(null,[n.types.mvex].concat(r))},n.mvhd=function(t,i){i*=t;var r=Math.floor(i/(e+1)),u=Math.floor(i%(e+1)),f=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,u>>24,u>>16&255,u>>8&255,255&u,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n.box(n.types.mvhd,f)},n.sdtp=function(t){for(var r,u=t.samples||[],f=new Uint8Array(4+u.length),i=0;i<u.length;i++)r=u[i].flags,f[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return n.box(n.types.sdtp,f)},n.stbl=function(t){return n.box(n.types.stbl,n.stsd(t),n.box(n.types.stts,n.STTS),n.box(n.types.stsc,n.STSC),n.box(n.types.stsz,n.STSZ),n.box(n.types.stco,n.STCO))},n.avc1=function(t){for(var e,u,r=[],f=[],i=0;i<t.sps.length;i++)u=(e=t.sps[i]).byteLength,r.push(u>>>8&255),r.push(255&u),r=r.concat(Array.prototype.slice.call(e));for(i=0;i<t.pps.length;i++)u=(e=t.pps[i]).byteLength,f.push(u>>>8&255),f.push(255&u),f=f.concat(Array.prototype.slice.call(e));var l=n.box(n.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(f))),h=t.width,c=t.height,o=t.pixelRatio[0],s=t.pixelRatio[1];return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])))},n.esds=function(n){var t=n.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(n.config).concat([6,1,2]))},n.mp4a=function(t){var i=t.samplerate;return n.box(n.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),n.box(n.types.esds,n.esds(t)))},n.mp3=function(t){var i=t.samplerate;return n.box(n.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},n.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?n.box(n.types.stsd,n.STSD,n.mp4a(t)):n.box(n.types.stsd,n.STSD,n.mp3(t)):n.box(n.types.stsd,n.STSD,n.avc1(t))},n.tkhd=function(t){var i=t.id,f=t.duration*t.timescale,o=t.width,s=t.height,r=Math.floor(f/(e+1)),u=Math.floor(f%(e+1));return n.box(n.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,u>>24,u>>16&255,u>>8&255,255&u,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,255&o,0,0,s>>8&255,255&s,0,0]))},n.traf=function(t,i){var o=n.sdtp(t),r=t.id,u=Math.floor(i/(e+1)),f=Math.floor(i%(e+1));return n.box(n.types.traf,n.box(n.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),n.box(n.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,255&u,f>>24,f>>16&255,f>>8&255,255&f])),n.trun(t,o.length+16+20+8+16+8+8),o)},n.trak=function(t){return t.duration=t.duration||4294967295,n.box(n.types.trak,n.tkhd(t),n.mdia(t))},n.trex=function(t){var i=t.id;return n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},n.trun=function(t,i){var f,h,e,o,r,s,l=t.samples||[],u=l.length,a=12+16*u,c=new Uint8Array(a);for(i+=8+a,c.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),f=0;f<u;f++)e=(h=l[f]).duration,o=h.size,r=h.flags,s=h.cts,c.set([e>>>24&255,e>>>16&255,e>>>8&255,255&e,o>>>24&255,o>>>16&255,o>>>8&255,255&o,r.isLeading<<2|r.dependsOn,r.isDependedOn<<6|r.hasRedundancy<<4|r.paddingValue<<1|r.isNonSync,61440&r.degradPrio,15&r.degradPrio,s>>>24&255,s>>>16&255,s>>>8&255,255&s],12+16*f);return n.box(n.types.trun,c)},n.initSegment=function(t){n.types||n.init();var r=n.moov(t),i=new Uint8Array(n.FTYP.byteLength+r.byteLength);return i.set(n.FTYP),i.set(r,n.FTYP.byteLength),i},n}();u.types=void 0;u.HDLR_TYPES=void 0;u.STTS=void 0;u.STSC=void 0;u.STCO=void 0;u.STSZ=void 0;u.VMHD=void 0;u.SMHD=void 0;u.STSD=void 0;u.FTYP=void 0;u.DINF=void 0;var s=u,c=i(0),l=i(2),r=i(1),d=i(4),o=i(8);var h=null,a=null,w=!1,g=function(){function t(n,t,i,r){var u,f;(void 0===r&&(r=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=n,this.config=t,this.typeSupported=i,this.ISGenerated=!1,null===h)&&(u=(navigator.userAgent||"").match(/Chrome\/(\d+)/i),h=u?parseInt(u[1]):0);null===a&&(f=navigator.userAgent.match(/Safari\/(\d+)/i),a=f?parseInt(f[1]):0);w=!!h&&h<75||!!a&&a<600}var n=t.prototype;return n.destroy=function(){},n.resetTimeStamp=function(n){r.b.log("[mp4-remuxer]: initPTS & initDTS reset");this._initPTS=this._initDTS=n},n.resetNextTimestamp=function(){r.b.log("[mp4-remuxer]: reset next timestamp");this.isVideoContiguous=!1;this.isAudioContiguous=!1},n.resetInitSegment=function(){r.b.log("[mp4-remuxer]: ISGenerated flag reset");this.ISGenerated=!1},n.getVideoStartPts=function(n){var t=!1,i=n.reduce(function(n,i){var r=i.pts-n;return r<-4294967296?(t=!0,f(n,i.pts)):r>0?n:i.pts},n[0].pts);return t&&r.b.debug("PTS rollover detected"),i},n.remux=function(n,t,i,u,e,o,s,h){var l,v,p,it,rt,b,ut=e,y=e,st=n.pid>-1,ft=t.pid>-1,k=t.samples.length,g=n.samples.length>0,a=k>1,w,c,et,nt,tt,ot;return((!st||g)&&(!ft||a)||this.ISGenerated||s)&&(this.ISGenerated||(p=this.generateIS(n,t,e)),w=this.isVideoContiguous,c=-1,a&&(c=function(n){for(var t=0;t<n.length;t++)if(n[t].key)return t;return-1}(t.samples),!w&&this.config.forceKeyFrameOnDiscontinuity)&&((b=!0,c>0)?(r.b.warn("[mp4-remuxer]: Dropped "+c+" out of "+k+" video samples due to a missing keyframe"),et=this.getVideoStartPts(t.samples),t.samples=t.samples.slice(c),t.dropped+=c,y+=(t.samples[0].pts-et)/(t.timescale||9e4)):-1===c&&(r.b.warn("[mp4-remuxer]: No keyframe found out of "+k+" video samples"),b=!1)),this.ISGenerated&&(g&&a&&(nt=this.getVideoStartPts(t.samples),tt=(f(n.samples[0].pts,nt)-nt)/t.inputTimeScale,ut+=Math.max(0,tt),y+=Math.max(0,-tt)),g?(n.samplerate||(r.b.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),p=this.generateIS(n,t,e)),v=this.remuxAudio(n,ut,this.isAudioContiguous,o,ft||a||h===d.b.AUDIO?y:void 0),a)&&(ot=v?v.endPTS-v.startPTS:0,t.inputTimeScale||(r.b.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),p=this.generateIS(n,t,e)),l=this.remuxVideo(t,y,w,ot)):a&&(l=this.remuxVideo(t,y,w,0)),l&&(l.firstKeyFrame=c,l.independent=-1!==c))),this.ISGenerated&&(i.samples.length&&(rt=this.remuxID3(i,e)),u.samples.length&&(it=this.remuxText(u,e))),{audio:v,video:l,initSegment:p,independent:b,text:it,id3:rt}},n.generateIS=function(n,t,i){var r,u,e,y=n.samples,c=t.samples,l=this.typeSupported,o={},h=!Object(k.a)(this._initPTS),p="audio/mp4",a,v;return(h&&(r=u=1/0),n.config&&y.length&&(n.timescale=n.samplerate,n.isAAC||(l.mpeg?(p="audio/mpeg",n.codec=""):l.mp3&&(n.codec="mp3")),o.audio={id:"audio",container:p,codec:n.codec,initSegment:!n.isAAC&&l.mpeg?new Uint8Array(0):s.initSegment([n]),metadata:{channelCount:n.channelCount}},h&&(e=n.inputTimeScale,r=u=y[0].pts-Math.round(e*i))),t.sps&&t.pps&&c.length&&(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:s.initSegment([t]),metadata:{width:t.width,height:t.height}},h))&&(e=t.inputTimeScale,a=this.getVideoStartPts(c),v=Math.round(e*i),u=Math.min(u,f(c[0].dts,a)-v),r=Math.min(r,a-v)),Object.keys(o).length?(this.ISGenerated=!0,h&&(this._initPTS=r,this._initDTS=u),{tracks:o,initPTS:r,timescale:e}):void 0},n.remuxVideo=function(n,t,i,u){var b,a,vt,it=n.inputTimeScale,e=n.samples,ot=[],nt=e.length,si=this._initPTS,tt=this.nextAvcDts,yt=8,pt=Number.POSITIVE_INFINITY,kt=Number.NEGATIVE_INFINITY,rt=0,hi=!1,ut,p,st,wt,ft,ht,k,dt,gt,ct,lt,ri,g,ei,at,bi,bt,ki,oi,di;for(i&&null!==tt||(tt=t*it-(e[0].pts-f(e[0].dts,e[0].pts))),ut=0;ut<nt;ut++)p=e[ut],(p.pts=f(p.pts-si,tt),p.dts=f(p.dts-si,tt),p.dts>p.pts)&&(rt=Math.max(Math.min(rt,p.pts-p.dts),-18e3)),p.dts<e[ut>0?ut-1:ut].dts&&(hi=!0);if(hi&&e.sort(function(n,t){var i=n.dts-t.dts,r=n.pts-t.pts;return i||r}),a=e[0].dts,vt=e[e.length-1].dts,st=Math.round((vt-a)/(nt-1)),rt<0){if(rt<-2*st)for(r.b.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(o.b)(-st,!0)+" ms"),wt=rt,ft=0;ft<nt;ft++)e[ft].dts=wt=Math.max(wt,e[ft].pts-st),e[ft].pts=Math.max(wt,e[ft].pts);else for(r.b.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(o.b)(rt,!0)+" ms to overcome this issue"),ht=0;ht<nt;ht++)e[ht].dts=e[ht].dts+rt;a=e[0].dts}i&&(k=a-tt,dt=k>st,(dt||k<-1)&&(dt?r.b.warn("AVC: "+Object(o.b)(k,!0)+" ms ("+k+"dts) hole between fragments detected, filling it"):r.b.warn("AVC: "+Object(o.b)(-k,!0)+" ms ("+k+"dts) overlapping between fragments detected"),a=tt,gt=e[0].pts-k,e[0].dts=a,e[0].pts=gt,r.b.log("Video: First PTS/DTS adjusted: "+Object(o.b)(gt,!0)+"/"+Object(o.b)(a,!0)+", delta: "+Object(o.b)(k,!0)+" ms")));w&&(a=Math.max(0,a));for(var ci=0,li=0,ni=0;ni<nt;ni++){for(var d=e[ni],ai=d.units,vi=ai.length,ti=0,ii=0;ii<vi;ii++)ti+=ai[ii].data.length;li+=ti;ci+=vi;d.length=ti;d.dts=Math.max(d.dts,a);d.pts=Math.max(d.pts,d.dts,0);pt=Math.min(d.pts,pt);kt=Math.max(d.pts,kt)}vt=e[nt-1].dts;lt=li+4*ci+8;try{ct=new Uint8Array(lt)}catch(n){return void this.observer.emit(c.a.ERROR,c.a.ERROR,{type:l.b.MUX_ERROR,details:l.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:lt,reason:"fail allocating video mdat "+lt})}for(ri=new DataView(ct.buffer),ri.setUint32(0,lt),ct.set(s.types.mdat,4),g=0;g<nt;g++){for(var et=e[g],yi=et.units,pi=0,ui=0,gi=yi.length;ui<gi;ui++){var wi=yi[ui],nr=wi.data,fi=wi.data.byteLength;ri.setUint32(yt,fi);yt+=4;ct.set(nr,yt);yt+=fi;pi+=4+fi}g<nt-1?b=e[g+1].dts-et.dts:(ei=this.config,at=et.dts-e[g>0?g-1:g].dts,ei.stretchShortVideoTrack&&null!==this.nextAudioPts?(bi=Math.floor(ei.maxBufferHole*it),bt=(u?pt+u*it:this.nextAudioPts)-et.pts,bt>bi?((b=bt-at)<0&&(b=at),r.b.log("[mp4-remuxer]: It is approximately "+bt/90+" ms to the next segment; using duration "+b/90+" ms for the last video frame.")):b=at):b=at);ki=Math.round(et.pts-et.dts);ot.push(new y(et.key,b,pi,ki))}return ot.length&&h&&h<70&&(oi=ot[0].flags,oi.dependsOn=2,oi.isNonSync=0),this.nextAvcDts=tt=vt+b,this.isVideoContiguous=!0,di={data1:s.moof(n.sequenceNumber++,a,v({},n,{samples:ot})),data2:ct,startPTS:pt/it,endPTS:(kt+b)/it,startDTS:a/it,endDTS:tt/it,type:"video",hasAudio:!1,hasVideo:!0,nb:ot.length,dropped:n.dropped},n.samples=[],n.dropped=0,di},n.remuxAudio=function(n,t,i,u,e){var a=n.inputTimeScale,ut=a/(n.samplerate?n.samplerate:a),bt=n.isAAC?1024:1152,b=bt*ut,kt=this._initPTS,ct=!n.isAAC&&this.typeSupported.mpeg,g=[],o=n.samples,lt=ct?0:8,h=this.nextAudioPts||-1,ft=t*a,tt,vt,ni,ot,rt,ii,pt,wt,fi,ei;if(this.isAudioContiguous=i=i||o.length&&h>0&&(u&&Math.abs(ft-h)<9e3||Math.abs(f(o[0].pts-kt,ft)-h)<20*b),o.forEach(function(n){n.pts=f(n.pts-kt,ft)}),!i||h<0){if(!(o=o.filter(function(n){return n.pts>=0})).length)return;h=0===e?0:u?Math.max(0,ft):o[0].pts}if(n.isAAC)for(var dt=void 0!==e,gt=this.config.maxAudioFramesDrift,k=0,w=h;k<o.length;k++){var at=o[k],et=at.pts,nt=et-w,hi=Math.abs(1e3*nt/a);if(nt<=-gt*b&&dt)0===k&&(r.b.warn("Audio frame @ "+(et/a).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*nt/a)+" ms."),this.nextAudioPts=h=w=et);else if(nt>=gt*b&&hi<1e4&&dt)for(tt=Math.round(nt/b),(w=et-tt*b)<0&&(tt--,w+=b),0===k&&(this.nextAudioPts=h=w),r.b.warn("[mp4-remuxer]: Injecting "+tt+" audio frame @ "+(w/a).toFixed(3)+"s due to "+Math.round(1e3*nt/a)+" ms gap."),vt=0;vt<tt;vt++)ni=Math.max(w,0),ot=p.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),ot||(r.b.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),ot=at.unit.subarray()),o.splice(k,0,{unit:ot,pts:ni}),w+=b,k++;at.pts=w;w+=b}for(var it,yt=null,st=null,d=0,ti=o.length;ti--;)d+=o[ti].unit.byteLength;for(rt=0,ii=o.length;rt<ii;rt++){var ri=o[rt],ui=ri.unit,ht=ri.pts;if(null!==st)g[rt-1].duration=Math.round((ht-st)/ut);else{if(i&&n.isAAC&&(ht=h),yt=ht,!(d>0))return;d+=lt;try{it=new Uint8Array(d)}catch(n){return void this.observer.emit(c.a.ERROR,c.a.ERROR,{type:l.b.MUX_ERROR,details:l.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:d,reason:"fail allocating audio mdat "+d})}ct||(new DataView(it.buffer).setUint32(0,d),it.set(s.types.mdat,4))}it.set(ui,lt);pt=ui.byteLength;lt+=pt;g.push(new y(!0,bt,pt,0));st=ht}if(wt=g.length,wt){fi=g[g.length-1];this.nextAudioPts=h=st+ut*fi.duration;ei=ct?new Uint8Array(0):s.moof(n.sequenceNumber++,yt/ut,v({},n,{samples:g}));n.samples=[];var oi=yt/a,si=h/a,ci={data1:ei,data2:it,startPTS:oi,endPTS:si,startDTS:oi,endDTS:si,type:"audio",hasAudio:!0,hasVideo:!1,nb:wt};return this.isAudioContiguous=!0,ci}},n.remuxEmptyAudio=function(n,t,i,u){var f=n.inputTimeScale,v=f/(n.samplerate?n.samplerate:f),h=this.nextAudioPts,c=(null!==h?h:u.startDTS*f)+this._initDTS,y=u.endDTS*f+this._initDTS,l=1024*v,w=Math.ceil((y-c)/l),a=p.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),o,e,s;if(r.b.warn("[mp4-remuxer]: remux empty Audio"),a){for(o=[],e=0;e<w;e++)s=c+e*l,o.push({unit:a,pts:s,dts:s});return n.samples=o,this.remuxAudio(n,t,i,!1)}r.b.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},n.remuxID3=function(n,t){var e=n.samples.length,i,o;if(e){for(var r=n.inputTimeScale,s=this._initPTS,h=this._initDTS,u=0;u<e;u++)i=n.samples[u],i.pts=f(i.pts-s,t*r)/r,i.dts=f(i.dts-h,t*r)/r;return o=n.samples,n.samples=[],{samples:o}}},n.remuxText=function(n,t){var u=n.samples.length,r,o;if(u){for(var e=n.inputTimeScale,s=this._initPTS,i=0;i<u;i++)r=n.samples[i],r.pts=f(r.pts-s,t*e)/e;return n.samples.sort(function(n,t){return n.pts-t.pts}),o=n.samples,n.samples=[],{samples:o}}},t}();y=function(n,t,i,r){this.size=void 0;this.duration=void 0;this.cts=void 0;this.flags=void 0;this.duration=t;this.size=i;this.cts=r;this.flags=new b(n)};b=function(n){this.isLeading=0;this.isDependedOn=0;this.hasRedundancy=0;this.degradPrio=0;this.dependsOn=1;this.isNonSync=1;this.dependsOn=n?2:1;this.isNonSync=n?0:1}},function(n,t,i){"use strict";function u(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}var r,f;i.d(t,"a",function(){return f});r=i(11);f=function(){function n(n,t){this._uri=null;this.method=null;this.keyFormat=null;this.keyFormatVersions=null;this.keyID=null;this.key=null;this.iv=null;this._uri=t?Object(r.buildAbsoluteURL)(n,t,{alwaysNormalize:!0}):n}var t,i,f;return n.fromURL=function(t,i){return new n(t,i)},n.fromURI=function(t){return new n(t)},t=n,(i=[{key:"uri",get:function(){return this._uri}}])&&u(t.prototype,i),f&&u(t,f),n}()},function(n,t,i){function r(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={},r;return t.m=n,t.c=i,t.i=function(n){return n},t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/",t.oe=function(n){throw console.error(n),n;},r=t(t.s=ENTRY_MODULE),r.default||r}function u(n){return(n+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(n,t,r){var f={},c,a,e,v,l,y,s,o,h;if(f[r]=[],c=t.toString(),a=c.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/),!a)return f;for(v=a[1],l=new RegExp("(\\\\n|\\W)"+u(v)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");e=l.exec(c);)"dll-reference"!==e[3]&&f[r].push(e[3]);for(l=new RegExp("\\("+u(v)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");e=l.exec(c);)n[e[2]]||(f[r].push(e[1]),n[e[2]]=i(e[1]).m),f[e[2]]=f[e[2]]||[],f[e[2]].push(e[4]);for(s=Object.keys(f),o=0;o<s.length;o++)for(h=0;h<f[s[o]].length;h++)y=f[s[o]][h],isNaN(1*y)||(f[s[o]][h]=1*f[s[o]][h]);return f}function e(n){return Object.keys(n).reduce(function(t,i){return t||n[i].length>0},!1)}n.exports=function(n,t){var h,c,l;t=t||{};var u={main:i.m},o=t.all?{main:Object.keys(u.main)}:function(n,t){for(var a,l,i,o,r={main:[t]},h={main:[]},c={main:{}};e(r);)for(a=Object.keys(r),l=0;l<a.length;l++)if(i=a[l],o=r[i].pop(),c[i]=c[i]||{},!c[i][o]&&n[i][o]){c[i][o]=!0;h[i]=h[i]||[];h[i].push(o);for(var v=f(n,n[i][o],i),s=Object.keys(v),u=0;u<s.length;u++)r[s[u]]=r[s[u]]||[],r[s[u]]=r[s[u]].concat(v[s[u]])}return h}(u,n),s="";return(Object.keys(o).filter(function(n){return"main"!==n}).forEach(function(n){for(var t=0;o[n][t];)t++;o[n].push(t);u[n][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";s=s+"var "+n+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[n].map(function(t){return JSON.stringify(t)+": "+u[n][t].toString()}).join(",")+"});\n"}),s=s+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(n))+")({"+o.main.map(function(n){return JSON.stringify(n)+": "+u.main[n].toString()}).join(",")+"}))(self);",h=new window.Blob([s],{type:"text/javascript"}),t.bare)?h:(c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(h),l=new window.Worker(c),l.objectURL=c,l)}},function(n,t,i){"use strict";function c(n){var t=new h.EventEmitter,i=function(t,i){n.postMessage({event:t,data:i})};t.on(f.a.FRAG_DECRYPTED,i);t.on(f.a.ERROR,i);n.addEventListener("message",function(f){var e=f.data,a,h,c,l;switch(e.cmd){case"init":a=JSON.parse(e.config);n.transmuxer=new r.c(t,e.typeSupported,a,e.vendor,e.id);Object(s.a)(a.debug);i("init",null);break;case"configure":n.transmuxer.configure(e.config);break;case"demux":h=n.transmuxer.push(e.data,e.decryptdata,e.chunkMeta,e.state);Object(r.d)(h)?h.then(function(t){u(n,t)}):u(n,h);break;case"flush":c=e.chunkMeta;l=n.transmuxer.flush(c);Object(r.d)(l)?l.then(function(t){o(n,t,c)}):o(n,l,c)}})}function u(n,t){if((i=t.remuxResult).audio||i.video||i.text||i.id3||i.initSegment){var i,r=[],u=t.remuxResult,f=u.audio,o=u.video;f&&e(r,f);o&&e(r,o);n.postMessage({event:"transmuxComplete",data:t},r)}}function e(n,t){t.data1&&n.push(t.data1.buffer);t.data2&&n.push(t.data2.buffer)}function o(n,t,i){t.forEach(function(t){u(n,t)});n.postMessage({event:"flush",data:i})}i.r(t);i.d(t,"default",function(){return c});var r=i(10),f=i(0),s=i(1),h=i(14)},function(n,t,i){"use strict";function cr(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function ri(n,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+n+'"')}function ys(n,t){["video","audio","text"].forEach(function(i){var r=n.filter(function(n){return function(n,t){var i=ls[t];return!!i&&!0===i[n.slice(0,4)]}(n,i)}),u;r.length&&(u=r.filter(function(n){return 0===n.lastIndexOf("avc1",0)||0===n.lastIndexOf("mp4a",0)}),t[i+"Codec"]=u.length>0?u[0]:r[0],n=n.filter(function(n){return-1===r.indexOf(n)}))});t.unknownCodecs=n}function pr(n,t,i){var r=t[i];r&&(n[i]=r)}function wr(n,t){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):null!=t&&t.programDateTime&&(n.programDateTime=t.endProgramDateTime);Object(o.a)(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function br(n,t){var i=n.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i}function gr(n,t){var i;try{i=new Event("addtrack")}catch(n){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=n;t.dispatchEvent(i)}function nu(n,t){var i=n.mode,r;if("disabled"===i&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(t.id))try{if(n.addCue(t),!n.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t);}catch(i){u.b.debug("[texttrack-utils]: "+i);r=new self.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id;n.addCue(r)}"disabled"===i&&(n.mode=i)}function nt(n){var t=n.mode,i;if("disabled"===t&&(n.mode="hidden"),n.cues)for(i=n.cues.length;i--;)n.removeCue(n.cues[i]);"disabled"===t&&(n.mode=t)}function ui(n,t,i){var u=n.mode,f,r;if("disabled"===u&&(n.mode="hidden"),n.cues&&n.cues.length>0)for(f=function(n,t,i){var f=[],e=function(n,t){var f,i,r,u;if(t<n[0].startTime)return 0;if(f=n.length-1,t>n[f].endTime)return-1;for(i=0,r=f;i<=r;)if(u=Math.floor((r+i)/2),t<n[u].startTime)r=u-1;else{if(!(t>n[u].startTime&&i<f))return u;i=u+1}return n[i].startTime-t<t-n[r].startTime?i:r}(n,t),u,o,r;if(e>-1)for(u=e,o=n.length;u<o;u++)if(r=n[u],r.startTime>=t&&r.endTime<=i)f.push(r);else if(r.startTime>i)return f;return f}(n.cues,t,i),r=0;r<f.length;r++)n.removeCue(f[r]);"disabled"===u&&(n.mode=u)}function iu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function uu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function fu(n,t,i){switch(t){case"audio":n.audioGroupIds||(n.audioGroupIds=[]);n.audioGroupIds.push(i);break;case"text":n.textGroupIds||(n.textGroupIds=[]);n.textGroupIds.push(i)}}function eu(n){var t={};n.forEach(function(n){var i=n.groupId||"";n.id=t[i]=t[i]||0;t[i]++})}function ei(n,t){var u=t.startPTS,r,i;Object(o.a)(u)?(i=0,t.sn>n.sn?(i=u-n.start,r=n):(i=n.start-u,r=t),r.duration!==i&&(r.duration=i)):t.start=t.sn>n.sn?n.cc===t.cc&&n.minEndPTS?n.start+(n.minEndPTS-n.start):n.start+n.duration:Math.max(n.start-t.duration,0)}function ou(n,t,i,r,f,e){var v,b,s,l,a,h;r-i<=0&&(u.b.warn("Fragment should have a positive duration",t),r=i+t.duration,e=f+t.duration);var y=i,p=r,c=t.startPTS,w=t.endPTS;if(Object(o.a)(c)&&(v=Math.abs(c-i),t.deltaPTS=Object(o.a)(t.deltaPTS)?Math.max(v,t.deltaPTS):v,y=Math.max(i,c),i=Math.min(i,c),f=Math.min(f,t.startDTS),p=Math.min(r,w),r=Math.max(r,w),e=Math.max(e,t.endDTS)),t.duration=r-i,b=i-t.start,t.appendedPTS=r,t.start=t.startPTS=i,t.maxStartPTS=y,t.startDTS=f,t.endPTS=r,t.minEndPTS=p,t.endDTS=e,l=t.sn,!n||l<n.startSN||l>n.endSN)return 0;for(a=l-n.startSN,h=n.fragments,h[a]=t,s=a;s>0;s--)ei(h[s],h[s-1]);for(s=a;s<h.length-1;s++)ei(h[s],h[s+1]);return n.fragmentHint&&ei(h[h.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,b}function ps(n,t){for(var l,i,e,y,f,s,h,a,r=null,v=n.fragments,c=v.length-1;c>=0;c--)if(l=v[c].initSegment,l){r=l;break}if(n.fragmentHint&&delete n.fragmentHint.endPTS,e=0,(function(n,t,i){for(var f,u,e=t.skippedSegments,o=Math.max(n.startSN,t.startSN)-t.startSN,s=(n.fragmentHint?1:0)+(e?t.endSN:Math.min(n.endSN,t.endSN))-t.startSN,h=t.startSN-n.startSN,c=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments,r=o;r<=s;r++)f=l[h+r],u=c[r],e&&!u&&r<e&&(u=t.fragments[r]=f),f&&u&&i(f,u)}(n,t,function(n,u){n.relurl&&(e=n.cc-u.cc);Object(o.a)(n.startPTS)&&Object(o.a)(n.endPTS)&&(u.start=u.startPTS=n.startPTS,u.startDTS=n.startDTS,u.appendedPTS=n.appendedPTS,u.maxStartPTS=n.maxStartPTS,u.endPTS=n.endPTS,u.endDTS=n.endDTS,u.minEndPTS=n.minEndPTS,u.duration=n.endPTS-n.startPTS,u.duration&&(i=u),t.PTSKnown=t.alignedSliding=!0);u.elementaryStreams=n.elementaryStreams;u.loader=n.loader;u.stats=n.stats;u.urlId=n.urlId;n.initSegment&&(u.initSegment=n.initSegment,r=n.initSegment)}),r)&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach(function(n){var t;n.initSegment&&n.initSegment.relurl!==(null===(t=r)||void 0===t?void 0:t.relurl)||(n.initSegment=r)}),t.skippedSegments&&(t.deltaUpdateFailed=t.fragments.some(function(n){return!n}),t.deltaUpdateFailed)){for(u.b.warn("[level-helper] Previous playlist missing segments skipped in delta playlist"),y=t.skippedSegments;y--;)t.fragments.shift();t.startSN=t.fragments[0].sn;t.startCC=t.fragments[0].cc}if(f=t.fragments,e)for(u.b.warn("discontinuity sliding from playlist, take drift into account"),s=0;s<f.length;s++)f[s].cc+=e;t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(n,t,i){var r,u;if(n&&t)for(var e=0,f=0,o=n.length;f<=o;f++)r=n[f],u=t[f+e],r&&u&&r.index===u.index&&r.fragment.sn===u.fragment.sn?i(r,u):e--}(n.partList,t.partList,function(n,t){t.elementaryStreams=n.elementaryStreams;t.stats=n.stats});i?ou(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):su(n,t);f.length&&(t.totalduration=t.edge-f[0].start);t.driftStartTime=n.driftStartTime;t.driftStart=n.driftStart;h=t.advancedDateTime;t.advanced&&h?(a=t.edge,t.driftStart||(t.driftStartTime=h,t.driftStart=a),t.driftEndTime=h,t.driftEnd=a):(t.driftEndTime=n.driftEndTime,t.driftEnd=n.driftEnd,t.advancedDateTime=n.advancedDateTime)}function su(n,t){var i=t.startSN+t.skippedSegments-n.startSN,r=n.fragments;i<0||i>=r.length||oi(t,r[i].start)}function oi(n,t){if(t){for(var r=n.fragments,i=n.skippedSegments;i<r.length;i++)r[i].start+=t;n.fragmentHint&&(n.fragmentHint.start+=t)}}function hu(){return(hu=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function cu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function lu(n,t){return(lu=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function pu(n){var t,i;return n.buffered&&((null===(t=n.range.video)||void 0===t?void 0:t.partial)||(null===(i=n.range.audio)||void 0===i?void 0:i.partial))}function w(n){return n.type+"_"+n.level+"_"+n.urlId+"_"+n.sn}function wu(n,t){if(n){var i=n.start+t;n.start=n.startPTS=i;n.endPTS=i+n.duration}}function bu(n,t){for(var r=t.fragments,i=0,u=r.length;i<u;i++)wu(r[i],n);t.fragmentHint&&wu(t.fragmentHint,n);t.alignedSliding=!0}function ks(n,t,i){t&&(!function(n,t,i){if(function(n,t,i){return!(!t.details||!(i.endCC>i.startCC||n&&n.cc<i.startCC))}(n,i,t)){var r=function(n,t){var r=n.fragments,f=t.fragments,i;if(f.length&&r.length){if(i=function(n,t){for(var i,u=null,r=0,f=n.length;r<f;r++)if(i=n[r],i&&i.cc===t){u=i;break}return u}(r,f[0].cc),i&&(!i||i.startPTS))return i;u.b.log("No frag in previous level to align on")}else u.b.log("No fragments to align")}(i.details,t);r&&Object(o.a)(r.start)&&(u.b.log("Adjusting PTS using last level due to CC increase within current level "+t.url),bu(r.start,t))}}(n,i,t),!i.alignedSliding&&t.details&&function(n,t){if(t.fragments.length&&n.hasProgramDateTime&&t.hasProgramDateTime){var r=t.fragments[0].programDateTime,f=n.fragments[0].programDateTime,i=(f-r)/1e3+t.fragments[0].start;i&&Object(o.a)(i)&&(u.b.log("Adjusting PTS using programDateTime delta "+(f-r)+"ms, sliding:"+i.toFixed(3)+" "+n.url+" "),bu(i,n))}}(i,t.details),i.alignedSliding||!t.details||i.skippedSegments||su(t.details,i))}function ku(n,t){var r=n.programDateTime,i;r&&(i=(r-t)/1e3,n.start=n.startPTS=i,n.endPTS=i+n.duration)}function du(n,t){if(t.fragments.length&&n.hasProgramDateTime&&t.hasProgramDateTime){var i=t.fragments[0].programDateTime-1e3*t.fragments[0].start;n.fragments.forEach(function(n){ku(n,i)});n.fragmentHint&&ku(n.fragmentHint,i);n.alignedSliding=!0}}function ci(n,t,i,r){var u,f;return(void 0===i&&(i=0),void 0===r&&(r=0),u=null,n?u=t[n.sn-t[0].sn+1]||null:0===i&&0===t[0].start&&(u=t[0]),u&&0===li(i,r,u))?u:(f=hi.search(t,li.bind(null,i,r)),f||u)}function li(n,t,i){void 0===n&&(n=0);void 0===t&&(t=0);var r=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-r<=n?1:i.start-r>n&&i.start?-1:0}function ds(n,t,i){var r=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-r>n}function gu(n){var t="function"==typeof Map?new Map:void 0;return(gu=function(n){function i(){return nf(n,arguments,tf(this).constructor)}if(null===n||(r=n,-1===Function.toString.call(r).indexOf("[native code]")))return n;var r;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(n))return t.get(n);t.set(n,i)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),vt(i,n)})(n)}function nf(){return(nf=gs()?Reflect.construct:function(n,t,i){var r=[null],u;return r.push.apply(r,t),u=new(Function.bind.apply(n,r)),i&&vt(u,i.prototype),u}).apply(null,arguments)}function gs(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function vt(n,t){return(vt=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function tf(n){return(tf=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function uf(n,t){void 0===t&&(t=null);var i=t||n,r={frag:n,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},u=i.byteRangeStartOffset,f=i.byteRangeEndOffset;return Object(o.a)(u)&&Object(o.a)(f)&&(r.rangeStart=u,r.rangeEnd=f),r}function ff(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function ef(n,t){return(ef=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function wi(){return self.MediaSource||self.WebKitMediaSource}function sf(){return self.SourceBuffer||self.WebKitSourceBuffer}function lf(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function af(n,t){return(af=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function vf(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function di(){return(di=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function pf(n,t){return(pf=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function bf(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function kf(n,t){return(kf=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function gf(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function ne(n,t){return(ne=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function ie(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function re(n,t){return(re=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function gi(n){for(var r,i=[],t=0;t<n.length;t++)r=n[t],"subtitles"===r.kind&&r.label&&i.push(n[t]);return i}function rt(n,t,i){i.a=n;i.b=t}function ce(n,t,i){return i.a===n&&i.b===t}function ae(n){function i(n,t,i,r){return 3600*(0|n)+60*(0|t)+(0|i)+parseFloat(r||0)}var t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?i(t[2],t[3],0,t[4]):i(t[1],t[2],t[3],t[4]):null}function ye(n,t,i,r){var f=r?n.split(r):[n],e,u;for(e in f)"string"==typeof f[e]&&(u=f[e].split(i),2===u.length&&t(u[0],u[1]))}function kh(n,t,i){function f(){var t=ae(n);if(null===t)throw new Error("Malformed timestamp: "+u);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function r(){n=n.replace(/^\s+/,"")}var u=n;if(r(),t.startTime=f(),r(),"-->"!==n.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+u);n=n.substr(3);r();t.endTime=f();r(),function(n,t){var r=new ve,u,f;ye(n,function(n,t){var u,f;switch(n){case"region":for(f=i.length-1;f>=0;f--)if(i[f].id===t){r.set(n,i[f].region);break}break;case"vertical":r.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");r.integer(n,u[0]);r.percent(n,u[0])&&r.set("snapToLines",!1);r.alt(n,u[0],["auto"]);2===u.length&&r.alt("lineAlign",u[1],["start",ct,"end"]);break;case"position":u=t.split(",");r.percent(n,u[0]);2===u.length&&r.alt("positionAlign",u[1],["start",ct,"end","line-left","line-right","auto"]);break;case"size":r.percent(n,t);break;case"align":r.alt(n,t,["start",ct,"end","left","right"])}},/:/,/\s/);t.region=r.get("region",null);t.vertical=r.get("vertical","");u=r.get("line","auto");"auto"===u&&-1===gt.line&&(u=-1);t.line=u;t.lineAlign=r.get("lineAlign","start");t.snapToLines=r.get("snapToLines",!0);t.size=r.get("size",100);t.align=r.get("align",ct);f=r.get("position","auto");"auto"===f&&50===gt.position&&(f="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50);t.position=f}(n,t)}function pe(n){return n.replace(/<br(?: \/)?>/gi,"\n")}function ur(n,t,i){return rr(n.toString())+rr(t.toString())+rr(i)}function tc(n,t,i,r,u,f,e,s){var c,h=new dh,b=Object(et.f)(new Uint8Array(n)).trim().replace(nc,"\n").split("\n"),y=[],k=Object(we.a)(t,i),p="00:00.000",w=0,l=0,a=!0,v=!1;h.oncue=function(n){var t=r[u],i=r.ccOffset,e=(w-k)/9e4,h,o,s;(null!=t&&t.new&&(void 0!==l?i=r.ccOffset=t.start:function(n,t,i){var r=n[t],u=n[r.prevCC],f;if(!u||!u.new&&r.new)return n.ccOffset=n.presentationOffset=r.start,void(r.new=!1);for(;null!==(f=u)&&void 0!==f&&f.new;)n.ccOffset+=r.start-u.start,r.new=!1,u=n[(r=u).prevCC];n.presentationOffset=i}(r,u,e)),e&&(i=e-r.presentationOffset),v)&&(h=n.endTime-n.startTime,o=Object(gh.b)(9e4*(n.startTime+i-l),9e4*f)/9e4,n.startTime=o,n.endTime=o+h);s=n.text.trim();n.text=decodeURIComponent(encodeURIComponent(s));n.id||(n.id=ur(n.startTime,n.endTime,s));n.endTime>0&&y.push(n)};h.onparsingerror=function(n){c=n};h.onflush=function(){c?s(c):e(y)};b.forEach(function(n){if(a){if(ir(n,"X-TIMESTAMP-MAP=")){a=!1;v=!0;n.substr(16).split(",").forEach(function(n){ir(n,"LOCAL:")?p=n.substr(6):ir(n,"MPEGTS:")&&(w=parseInt(n.substr(7)))});try{l=function(n){var t=parseInt(n.substr(-3)),i=parseInt(n.substr(-6,2)),r=parseInt(n.substr(-9,2)),u=n.length>9?parseInt(n.substr(0,n.indexOf(":"))):0;if(!(Object(o.a)(t)&&Object(o.a)(i)&&Object(o.a)(r)&&Object(o.a)(u)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+n);return t+=1e3*i,t+=6e4*r,t+36e5*u}(p)/1e3}catch(n){v=!1;c=n}return}""===n&&(a=!1)}h.parse(n+"\n")});h.flush()}function be(){return(be=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function ge(n,t,i,r,u){var e=Object(ii.b)(new Uint8Array(n),["mdat"]);if(0!==e.length){var f=e[0],o=Object(et.f)(new Uint8Array(n,f.start,f.end-f.start)),s=Object(we.c)(t,1,i);try{r(function(n,t){var i=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");var u={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},r=Object.keys(u).reduce(function(n,t){return n[t]=i.getAttribute("ttp:"+t)||u[t],n},{}),f="preserve"!==i.getAttribute("xml:space"),e=no(fr(i,"styling","style")),o=no(fr(i,"layout","region")),s=fr(i,"body","[begin]");return[].map.call(s,function(n){var a=function n(t,i){return[].slice.call(t.childNodes).reduce(function(t,r,u){var f;return"br"===r.nodeName&&u?t+"\n":null!==(f=r.childNodes)&&void 0!==f&&f.length?n(r,i):i?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}(n,f),i,y,p,c,u,l;if(!a||!n.hasAttribute("begin"))return null;var s=er(n.getAttribute("begin"),r),v=er(n.getAttribute("dur"),r),h=er(n.getAttribute("end"),r);if(null===s)throw io(n);if(null===h){if(null===v)throw io(n);h=s+v}return i=new tr(s-t,h-t,a),i.id=ur(i.startTime,i.endTime,i.text),y=o[n.getAttribute("region")],p=e[n.getAttribute("style")],i.position=10,i.size=80,c=function(n,t){var i="http://www.w3.org/ns/ttml#styling";return["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(r,u){var f=to(t,i,u)||to(n,i,u);return f&&(r[u]=f),r},{})}(y,p),u=c.textAlign,u&&(l=ic[u],l&&(i.lineAlign=l),i.align=u),be(i,c),i}).filter(function(n){return null!==n})}(o,s))}catch(n){u(n)}}else u(new Error("Could not parse IMSC1 mdat"))}function fr(n,t,i){var r=n.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(i)):[]}function no(n){return n.reduce(function(n,t){var i=t.getAttribute("xml:id");return i&&(n[i]=t),n},{})}function to(n,t,i){return n.hasAttributeNS(t,i)?n.getAttributeNS(t,i):null}function io(n){return new Error("Could not parse ttml timestamp "+n)}function er(n,t){if(!n)return null;var i=ae(n);return null===i&&(ke.test(n)?i=function(n,t){var i=ke.exec(n),r=(0|i[4])+(0|i[5])/t.subFrameRate;return 3600*(0|i[1])+60*(0|i[2])+(0|i[3])+r/t.frameRate}(n,t):de.test(n)&&(i=function(n,t){var r=de.exec(n),i=Number(r[1]);switch(r[2]){case"h":return 3600*i;case"m":return 60*i;case"ms":return 1e3*i;case"f":return i/t.frameRate;case"t":return i/t.tickRate}return i}(n,t))),i}function rc(n,t){return n&&n.label===t.name&&!(n.textTrack1||n.textTrack2)}function uo(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function so(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function lo(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function ao(n,t,i){return t&&lo(n.prototype,t),i&&lo(n,i),n}function vo(n,t){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"],r;if(i)return(i=i.call(n)).next.bind(i);if(Array.isArray(n)||(i=function(n,t){if(n){if("string"==typeof n)return yo(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);return("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)?Array.from(n):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?yo(n,t):void 0}}(n))||t&&n&&"number"==typeof n.length)return i&&(n=i),r=0,function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function yo(n,t){(null==t||t>n.length)&&(t=n.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=n[i];return r}function sr(){return(sr=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function bo(n){var t="function"==typeof Map?new Map:void 0;return(bo=function(n){function i(){return ko(n,arguments,go(this).constructor)}if(null===n||(r=n,-1===Function.toString.call(r).indexOf("[native code]")))return n;var r;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(n))return t.get(n);t.set(n,i)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),ni(i,n)})(n)}function ko(){return(ko=ec()?Reflect.construct:function(n,t,i){var r=[null],u;return r.push.apply(r,t),u=new(Function.bind.apply(n,r)),i&&ni(u,i.prototype),u}).apply(null,arguments)}function ec(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function ni(n,t){return(ni=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function go(n){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function ns(){return(ns=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function oc(n,t){return new self.Request(n.url,t)}function rs(){return(rs=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n}).apply(this,arguments)}function us(n,t){var r=Object.keys(n),i;return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(n),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),r.push.apply(r,i)),r}function fs(n){for(var i,t=1;t<arguments.length;t++)i=null!=arguments[t]?arguments[t]:{},t%2?us(Object(i),!0).forEach(function(t){cc(n,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):us(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))});return n}function cc(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function lc(n){var t=n.loader;t!==is&&t!==wo?(u.b.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(n){}return!1}()&&(n.loader=is,n.progressive=!0,n.enableSoftwareAES=!0,u.b.log("[config]: Progressive streaming enabled, using FetchLoader"))}function os(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}var e,kr,dr,et,tu,k,ru,fi,lt,at,l,au,vu,yu,hi,ai,rf,yf,ki,wf,df,te,ve,gt,ct,ro,ut,fo,eo,oo,v,or,ho,co,ts,es,hr;i.r(t);i.d(t,"default",function(){return hr});var ti=i(11),o=i(3),r=i(0),f=i(2),u=i(1),ii=i(6),a=i(5);var ss=function(){function n(n){this.PTSKnown=!1;this.alignedSliding=!1;this.averagetargetduration=void 0;this.endCC=0;this.endSN=0;this.fragments=void 0;this.fragmentHint=void 0;this.partList=null;this.live=!0;this.ageHeader=0;this.advancedDateTime=void 0;this.updated=!0;this.advanced=!0;this.availabilityDelay=void 0;this.misses=0;this.needSidxRanges=!1;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=void 0;this.m3u8="";this.version=null;this.canBlockReload=!1;this.canSkipUntil=0;this.canSkipDateRanges=!1;this.skippedSegments=0;this.recentlyRemovedDateranges=void 0;this.partHoldBack=0;this.holdBack=0;this.partTarget=0;this.preloadHint=void 0;this.renditionReports=void 0;this.tuneInGoal=0;this.deltaUpdateFailed=void 0;this.driftStartTime=0;this.driftEndTime=0;this.driftStart=0;this.driftEnd=0;this.fragments=[];this.url=n}var t,i,r;return n.prototype.reloaded=function(n){if(!n)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-n.lastPartSn,i=this.lastPartIndex-n.lastPartIndex;this.updated=this.endSN!==n.endSN||!!i||!!t;this.advanced=this.endSN>n.endSN||t>0||0===t&&i>0;this.misses=this.updated||this.advanced?Math.floor(.6*n.misses):n.misses+1;this.availabilityDelay=n.availabilityDelay},t=n,(i=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Object(o.a)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var n=this.driftEndTime-this.driftStartTime;return n>0?1e3*(this.driftEnd-this.driftStart)/n:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var n;return null!==(n=this.partList)&&void 0!==n&&n.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var n;return null!==(n=this.fragments)&&void 0!==n&&n.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var n;return null!==(n=this.partList)&&void 0!==n&&n.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var n;return null!==(n=this.partList)&&void 0!==n&&n.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&cr(t.prototype,i),r&&cr(t,r),n}(),hs=i(17),cs=/^(\d+)x(\d+)$/,lr=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,y=function(){function t(n){for(var i in"string"==typeof n&&(n=t.parseAttrList(n)),n)n.hasOwnProperty(i)&&(this[i]=n[i])}var n=t.prototype;return n.decimalInteger=function(n){var t=parseInt(this[n],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},n.hexadecimalInteger=function(n){var t,r,i;if(this[n]){for(t=(this[n]||"0x").slice(2),t=(1&t.length?"0":"")+t,r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},n.hexadecimalIntegerAsNumber=function(n){var t=parseInt(this[n],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},n.decimalFloatingPoint=function(n){return parseFloat(this[n])},n.optionalFloat=function(n,t){var i=this[n];return i?parseFloat(i):t},n.enumeratedString=function(n){return this[n]},n.bool=function(n){return"YES"===this[n]},n.decimalResolution=function(n){var t=cs.exec(this[n]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},t.parseAttrList=function(n){var i,r={},t;for(lr.lastIndex=0;null!==(i=lr.exec(n));)t=i[2],0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),r[i[1]]=t;return r},t}(),ls={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};var ar=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,vr=/#EXT-X-MEDIA:(.*)/g,yr=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),as=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),vs=/\.(mp4|m4s|m4v|m4a)$/i,ft=function(){function n(){}return n.findGroup=function(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i],r.id===t)return r},n.convertAVC1ToAVCOTI=function(n){var t=n.split("."),i;return t.length>2?(i=t.shift()+".",i+=parseInt(t.shift()).toString(16),i+("000"+parseInt(t.shift()).toString(16)).substr(-4)):n},n.resolve=function(n,t){return ti.buildAbsoluteURL(t,n,{alwaysNormalize:!0})},n.parseMasterPlaylist=function(t,i){var u,s=[],h={},c=!1,e;for(ar.lastIndex=0;null!=(u=ar.exec(t));)if(u[1]){var f=new y(u[1]),r={attrs:f,bitrate:f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH"),name:f.NAME,url:n.resolve(u[2],i)},o=f.decimalResolution("RESOLUTION");o&&(r.width=o.width,r.height=o.height);ys((f.CODECS||"").split(/[ ,]+/).filter(function(n){return n}),r);r.videoCodec&&-1!==r.videoCodec.indexOf("avc1")&&(r.videoCodec=n.convertAVC1ToAVCOTI(r.videoCodec));s.push(r)}else u[3]&&(e=new y(u[3]),e["DATA-ID"]&&(c=!0,h[e["DATA-ID"]]=e));return{levels:s,sessionData:c?h:null}},n.parseMasterPlaylistMedia=function(t,i,r,u){var h,o,c,f,e,s;for(void 0===u&&(u=[]),o=[],c=0,vr.lastIndex=0;null!==(h=vr.exec(t));)f=new y(h[1]),f.TYPE===r&&(e={attrs:f,bitrate:0,id:c++,groupId:f["GROUP-ID"],instreamId:f["INSTREAM-ID"],name:f.NAME||f.LANGUAGE||"",type:r,"default":f.bool("DEFAULT"),autoselect:f.bool("AUTOSELECT"),forced:f.bool("FORCED"),lang:f.LANGUAGE,url:f.URI?n.resolve(f.URI,i):""},u.length&&(s=n.findGroup(u,e.groupId)||u[0],pr(e,s,"audioCodec"),pr(e,s,"textCodec")),o.push(e));return o},n.parseLevelPlaylist=function(n,t,i,r,f){var h,p,l,s=new ss(t),w=s.fragments,ut=null,tt=0,lt=0,b=0,k=0,v=null,e=new a.b(r,t),ft=-1,et=!1,it,ot,at,pt,rt,ii,wt,kt,ht,g,oi,nt,hi,ci,ni;for(yr.lastIndex=0,s.m3u8=n;null!==(h=yr.exec(n));)if(et&&(et=!1,(e=new a.b(r,t)).start=b,e.sn=tt,e.cc=k,e.level=i,ut&&(e.initSegment=ut,e.rawProgramDateTime=ut.rawProgramDateTime)),it=h[1],it)e.duration=parseFloat(it),ot=(" "+h[2]).slice(1),e.title=ot||null,e.tagList.push(ot?["INF",it,ot]:["INF",it]);else if(h[3])Object(o.a)(e.duration)&&(e.start=b,l&&(e.levelkey=l),e.sn=tt,e.level=i,e.cc=k,e.urlId=f,w.push(e),e.relurl=(" "+h[3]).slice(1),wr(e,v),v=e,b+=e.duration,tt++,lt=0,et=!0);else if(h[4])at=(" "+h[4]).slice(1),v?e.setByteRange(at,v):e.setByteRange(at);else if(h[5])e.rawProgramDateTime=(" "+h[5]).slice(1),e.tagList.push(["PROGRAM-DATE-TIME",e.rawProgramDateTime]),-1===ft&&(ft=w.length);else{if(!(h=h[0].match(as))){u.b.warn("No matches on slow regex match for level playlist!");continue}for(p=1;p<h.length&&void 0===h[p];p++);var vt=(" "+h[p]).slice(1),c=(" "+h[p+1]).slice(1),yt=h[p+2]?(" "+h[p+2]).slice(1):"";switch(vt){case"PLAYLIST-TYPE":s.type=c.toUpperCase();break;case"MEDIA-SEQUENCE":tt=s.startSN=parseInt(c);break;case"SKIP":if(pt=new y(c),rt=pt.decimalInteger("SKIPPED-SEGMENTS"),Object(o.a)(rt)){for(s.skippedSegments=rt,ii=rt;ii--;)w.unshift(null);tt+=rt}wt=pt.enumeratedString("RECENTLY-REMOVED-DATERANGES");wt&&(s.recentlyRemovedDateranges=wt.split("\t"));break;case"TARGETDURATION":s.targetduration=parseFloat(c);break;case"VERSION":s.version=parseInt(c);break;case"EXTM3U":break;case"ENDLIST":s.live=!1;break;case"#":(c||yt)&&e.tagList.push(yt?[c,yt]:[c]);break;case"DIS":k++;case"GAP":e.tagList.push([vt]);break;case"BITRATE":e.tagList.push([vt,c]);break;case"DISCONTINUITY-SEQ":k=parseInt(c);break;case"KEY":var ri,d=new y(c),bt=d.enumeratedString("METHOD"),ui=d.URI,li=d.hexadecimalInteger("IV"),fi=d.enumeratedString("KEYFORMATVERSIONS"),ei=d.enumeratedString("KEYID"),st=null!=(ri=d.enumeratedString("KEYFORMAT"))?ri:"identity";if(["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"].indexOf(st)>-1){u.b.warn("Keyformat "+st+" is not supported from the manifest");continue}if("identity"!==st)continue;bt&&(l=hs.a.fromURL(t,ui),ui&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(bt)>=0&&(l.method=bt,l.keyFormat=st,ei&&(l.keyID=ei),fi&&(l.keyFormatVersions=fi),l.iv=li));break;case"START":kt=new y(c).decimalFloatingPoint("TIME-OFFSET");Object(o.a)(kt)&&(s.startTimeOffset=kt);break;case"MAP":ht=new y(c);e.relurl=ht.URI;ht.BYTERANGE&&e.setByteRange(ht.BYTERANGE);e.level=i;e.sn="initSegment";l&&(e.levelkey=l);e.initSegment=null;ut=e;et=!0;break;case"SERVER-CONTROL":g=new y(c);s.canBlockReload=g.bool("CAN-BLOCK-RELOAD");s.canSkipUntil=g.optionalFloat("CAN-SKIP-UNTIL",0);s.canSkipDateRanges=s.canSkipUntil>0&&g.bool("CAN-SKIP-DATERANGES");s.partHoldBack=g.optionalFloat("PART-HOLD-BACK",0);s.holdBack=g.optionalFloat("HOLD-BACK",0);break;case"PART-INF":oi=new y(c);s.partTarget=oi.decimalFloatingPoint("PART-TARGET");break;case"PART":nt=s.partList;nt||(nt=s.partList=[]);var ai=lt>0?nt[nt.length-1]:void 0,vi=lt++,si=new a.c(new y(c),e,t,vi,ai);nt.push(si);e.duration+=si.duration;break;case"PRELOAD-HINT":hi=new y(c);s.preloadHint=hi;break;case"RENDITION-REPORT":ci=new y(c);s.renditionReports=s.renditionReports||[];s.renditionReports.push(ci);break;default:u.b.warn("line parsed but not handled: "+h)}}v&&!v.relurl?(w.pop(),b-=v.duration,s.partList&&(s.fragmentHint=v)):s.partList&&(wr(e,v),e.cc=k,s.fragmentHint=e);var dt=w.length,ct=w[0],gt=w[dt-1];return(b+=s.skippedSegments*s.targetduration)>0&&dt&&gt?(s.averagetargetduration=b/dt,ni=gt.sn,s.endSN="initSegment"!==ni?ni:0,ct&&(s.startCC=ct.cc,ct.initSegment||s.fragments.every(function(n){return n.relurl&&(i=n.relurl,vs.test(null!=(r=null===(t=ti.parseURL(i))||void 0===t?void 0:t.path)?r:""));var i,r,t})&&(u.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(e=new a.b(r,t)).relurl=gt.relurl,e.level=i,e.sn="initSegment",ct.initSegment=e,s.needSidxRanges=!0))):(s.endSN=0,s.startCC=0),s.fragmentHint&&(b+=s.fragmentHint.duration),s.totalduration=b,s.endCC=k,ft>0&&function(n,t){for(var i,r=n[t],u=t;u--;){if(i=n[u],!i)return;i.programDateTime=r.programDateTime-1e3*i.duration;r=i}}(w,ft),s},n}();e=i(4);kr=function(){function t(n){this.hls=void 0;this.loaders=Object.create(null);this.hls=n;this.registerListeners()}var n=t.prototype;return n.registerListeners=function(){var n=this.hls;n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.on(r.a.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this);n.on(r.a.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},n.unregisterListeners=function(){var n=this.hls;n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.off(r.a.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this);n.off(r.a.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},n.createInternalLoader=function(n){var t=this.hls.config,r=t.pLoader,u=t.loader,i=new(r||u)(t);return n.loader=i,this.loaders[n.type]=i,i},n.getInternalLoader=function(n){return this.loaders[n.type]},n.resetInternalLoader=function(n){this.loaders[n]&&delete this.loaders[n]},n.destroyInternalLoaders=function(){var n,t;for(n in this.loaders)t=this.loaders[n],t&&t.destroy(),this.resetInternalLoader(n)},n.destroy=function(){this.unregisterListeners();this.destroyInternalLoaders()},n.onManifestLoading=function(n,t){var i=t.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:e.a.MANIFEST,url:i,deliveryDirectives:null})},n.onLevelLoading=function(n,t){var i=t.id,r=t.level,u=t.url,f=t.deliveryDirectives;this.load({id:i,groupId:null,level:r,responseType:"text",type:e.a.LEVEL,url:u,deliveryDirectives:f})},n.onAudioTrackLoading=function(n,t){var i=t.id,r=t.groupId,u=t.url,f=t.deliveryDirectives;this.load({id:i,groupId:r,level:null,responseType:"text",type:e.a.AUDIO_TRACK,url:u,deliveryDirectives:f})},n.onSubtitleTrackLoading=function(n,t){var i=t.id,r=t.groupId,u=t.url,f=t.deliveryDirectives;this.load({id:i,groupId:r,level:null,responseType:"text",type:e.a.SUBTITLE_TRACK,url:u,deliveryDirectives:f})},n.load=function(n){var s,o,i,h,c,r,t=this.hls.config,f=this.getInternalLoader(n),l,a,v,y,p;if(f){if(l=f.context,l&&l.url===n.url)return void u.b.trace("[playlist-loader]: playlist request ongoing");u.b.log("[playlist-loader]: aborting previous loader for type: "+n.type);f.abort()}switch(n.type){case e.a.MANIFEST:o=t.manifestLoadingMaxRetry;i=t.manifestLoadingTimeOut;h=t.manifestLoadingRetryDelay;c=t.manifestLoadingMaxRetryTimeout;break;case e.a.LEVEL:case e.a.AUDIO_TRACK:case e.a.SUBTITLE_TRACK:o=0;i=t.levelLoadingTimeOut;break;default:o=t.levelLoadingMaxRetry;i=t.levelLoadingTimeOut;h=t.levelLoadingRetryDelay;c=t.levelLoadingMaxRetryTimeout}(f=this.createInternalLoader(n),null!==(s=n.deliveryDirectives)&&void 0!==s&&s.part)&&(n.type===e.a.LEVEL&&null!==n.level?r=this.hls.levels[n.level].details:n.type===e.a.AUDIO_TRACK&&null!==n.id?r=this.hls.audioTracks[n.id].details:n.type===e.a.SUBTITLE_TRACK&&null!==n.id&&(r=this.hls.subtitleTracks[n.id].details),r)&&(a=r.partTarget,v=r.targetduration,a&&v&&(i=Math.min(1e3*Math.max(3*a,.8*v),i)));y={timeout:i,maxRetry:o,retryDelay:h,maxRetryDelay:c,highWaterMark:0};p={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};f.load(n,y,p)},n.loadsuccess=function(n,t,i,r){if(void 0===r&&(r=null),i.isSidxRequest)return this.handleSidxRequest(n,i),void this.handlePlaylistLoaded(n,t,i,r);this.resetInternalLoader(i.type);var u=n.data;0===u.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),u.indexOf("#EXTINF:")>0||u.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(n,t,i,r):this.handleMasterPlaylist(n,t,i,r)):this.handleManifestParsingError(n,i,"no EXTM3U delimiter",r)},n.loaderror=function(n,t,i){void 0===i&&(i=null);this.handleNetworkError(t,i,!1,n)},n.loadtimeout=function(n,t,i){void 0===i&&(i=null);this.handleNetworkError(t,i,!0)},n.handleMasterPlaylist=function(n,t,i,f){var l=this.hls,s=n.data,o=br(n,i),c=ft.parseMasterPlaylist(s,o),e=c.levels,a=c.sessionData;if(e.length){var v=e.map(function(n){return{id:n.attrs.AUDIO,audioCodec:n.audioCodec}}),p=e.map(function(n){return{id:n.attrs.SUBTITLES,textCodec:n.textCodec}}),h=ft.parseMasterPlaylistMedia(s,o,"AUDIO",v),w=ft.parseMasterPlaylistMedia(s,o,"SUBTITLES",p),b=ft.parseMasterPlaylistMedia(s,o,"CLOSED-CAPTIONS");h.length&&(h.some(function(n){return!n.url})||!e[0].audioCodec||e[0].attrs.AUDIO||(u.b.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main","default":!1,autoselect:!1,forced:!1,id:-1,attrs:new y({}),bitrate:0,url:""})));l.trigger(r.a.MANIFEST_LOADED,{levels:e,audioTracks:h,subtitles:w,captions:b,url:o,stats:t,networkDetails:f,sessionData:a})}else this.handleManifestParsingError(n,i,"no level found in manifest",f)},n.handleTrackOrLevelPlaylist=function(n,t,i,u){var v=this.hls,c=i.id,l=i.level,p=i.type,h=br(n,i),w=Object(o.a)(c)?c:0,d=Object(o.a)(l)?l:w,g=function(n){switch(n.type){case e.a.AUDIO_TRACK:return e.b.AUDIO;case e.a.SUBTITLE_TRACK:return e.b.SUBTITLE;default:return e.b.MAIN}}(i),s=ft.parseLevelPlaylist(n.data,h,d,g,w),b,a,k;s.fragments.length?(p===e.a.MANIFEST&&(b={attrs:new y({}),bitrate:0,details:s,name:"",url:h},v.trigger(r.a.MANIFEST_LOADED,{levels:[b],audioTracks:[],url:h,stats:t,networkDetails:u,sessionData:null})),(t.parsing.end=performance.now(),s.needSidxRanges)?(k=null===(a=s.fragments[0].initSegment)||void 0===a?void 0:a.url,this.load({url:k,isSidxRequest:!0,type:p,level:l,levelDetails:s,id:c,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null})):(i.levelDetails=s,this.handlePlaylistLoaded(n,t,i,u))):v.trigger(r.a.ERROR,{type:f.b.NETWORK_ERROR,details:f.a.LEVEL_EMPTY_ERROR,fatal:!1,url:h,reason:"no fragments found in level",level:"number"==typeof i.level?i.level:void 0})},n.handleSidxRequest=function(n,t){var i=Object(ii.g)(new Uint8Array(n.data)),r,u;i&&(r=i.references,u=t.levelDetails,r.forEach(function(n,t){var f=n.info,r=u.fragments[t];0===r.byteRange.length&&r.setByteRange(String(1+f.end-f.start)+"@"+String(f.start));r.initSegment&&r.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}))},n.handleManifestParsingError=function(n,t,i,u){this.hls.trigger(r.a.ERROR,{type:f.b.NETWORK_ERROR,details:f.a.MANIFEST_PARSING_ERROR,fatal:t.type===e.a.MANIFEST,url:n.url,reason:i,response:n,context:t,networkDetails:u})},n.handleNetworkError=function(n,t,i,o){var c;void 0===i&&(i=!1);u.b.warn("[playlist-loader]: A network "+(i?"timeout":"error")+" occurred while loading "+n.type+" level: "+n.level+" id: "+n.id+' group-id: "'+n.groupId+'"');var s=f.a.UNKNOWN,h=!1,l=this.getInternalLoader(n);switch(n.type){case e.a.MANIFEST:s=i?f.a.MANIFEST_LOAD_TIMEOUT:f.a.MANIFEST_LOAD_ERROR;h=!0;break;case e.a.LEVEL:s=i?f.a.LEVEL_LOAD_TIMEOUT:f.a.LEVEL_LOAD_ERROR;h=!1;break;case e.a.AUDIO_TRACK:s=i?f.a.AUDIO_TRACK_LOAD_TIMEOUT:f.a.AUDIO_TRACK_LOAD_ERROR;h=!1;break;case e.a.SUBTITLE_TRACK:s=i?f.a.SUBTITLE_TRACK_LOAD_TIMEOUT:f.a.SUBTITLE_LOAD_ERROR;h=!1}l&&this.resetInternalLoader(n.type);c={type:f.b.NETWORK_ERROR,details:s,fatal:h,url:n.url,loader:l,context:n,networkDetails:t};o&&(c.response=o);this.hls.trigger(r.a.ERROR,c)},n.handlePlaylistLoaded=function(n,t,i,u){var l=i.type,a=i.level,s=i.id,c=i.groupId,o=i.loader,f=i.levelDetails,h=i.deliveryDirectives;if(null!=f&&f.targetduration){if(o)switch(f.live&&(o.getCacheAge&&(f.ageHeader=o.getCacheAge()||0),o.getCacheAge&&!isNaN(f.ageHeader)||(f.ageHeader=0)),l){case e.a.MANIFEST:case e.a.LEVEL:this.hls.trigger(r.a.LEVEL_LOADED,{details:f,level:a||0,id:s||0,stats:t,networkDetails:u,deliveryDirectives:h});break;case e.a.AUDIO_TRACK:this.hls.trigger(r.a.AUDIO_TRACK_LOADED,{details:f,id:s||0,groupId:c||"",stats:t,networkDetails:u,deliveryDirectives:h});break;case e.a.SUBTITLE_TRACK:this.hls.trigger(r.a.SUBTITLE_TRACK_LOADED,{details:f,id:s||0,groupId:c||"",stats:t,networkDetails:u,deliveryDirectives:h})}}else this.handleManifestParsingError(n,i,"invalid target duration",u)},t}();dr=function(){function t(n){this.hls=void 0;this.loaders={};this.decryptkey=null;this.decrypturl=null;this.hls=n;this._registerListeners()}var n=t.prototype;return n._registerListeners=function(){this.hls.on(r.a.KEY_LOADING,this.onKeyLoading,this)},n._unregisterListeners=function(){this.hls.off(r.a.KEY_LOADING,this.onKeyLoading)},n.destroy=function(){var t,n;for(t in this._unregisterListeners(),this.loaders)n=this.loaders[t],n&&n.destroy();this.loaders={}},n.onKeyLoading=function(n,t){var i=t.frag,o=i.type,s=this.loaders[o],e,f,h,c;if(i.decryptdata)if(e=i.decryptdata.uri,e!==this.decrypturl||null===this.decryptkey){if(f=this.hls.config,s&&(u.b.warn("abort previous key loader for type:"+o),s.abort()),!e)return void u.b.warn("key uri is falsy");h=f.loader;c=i.loader=this.loaders[o]=new h(f);this.decrypturl=e;this.decryptkey=null;var l={url:e,frag:i,responseType:"arraybuffer"},a={timeout:f.fragLoadingTimeOut,maxRetry:0,retryDelay:f.fragLoadingRetryDelay,maxRetryDelay:f.fragLoadingMaxRetryTimeout,highWaterMark:0},v={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};c.load(l,a,v)}else this.decryptkey&&(i.decryptdata.key=this.decryptkey,this.hls.trigger(r.a.KEY_LOADED,{frag:i}));else u.b.warn("Missing decryption data on fragment in onKeyLoading")},n.loadsuccess=function(n,t,i){var f=i.frag;f.decryptdata?(this.decryptkey=f.decryptdata.key=new Uint8Array(n.data),f.loader=null,delete this.loaders[f.type],this.hls.trigger(r.a.KEY_LOADED,{frag:f})):u.b.error("after key load, decryptdata unset")},n.loaderror=function(n,t){var i=t.frag,u=i.loader;u&&u.abort();delete this.loaders[i.type];this.hls.trigger(r.a.ERROR,{type:f.b.NETWORK_ERROR,details:f.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:n})},n.loadtimeout=function(n,t){var i=t.frag,u=i.loader;u&&u.abort();delete this.loaders[i.type];this.hls.trigger(r.a.ERROR,{type:f.b.NETWORK_ERROR,details:f.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},t}();et=i(7);tu=function(){function t(n){this.hls=void 0;this.id3Track=null;this.media=null;this.hls=n;this._registerListeners()}var n=t.prototype;return n.destroy=function(){this._unregisterListeners()},n._registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this);n.on(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this)},n._unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this);n.off(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this)},n.onMediaAttached=function(n,t){this.media=t.media},n.onMediaDetaching=function(){this.id3Track&&(nt(this.id3Track),this.id3Track=null,this.media=null)},n.getID3Track=function(n){var i,t;if(this.media){for(i=0;i<n.length;i++)if(t=n[i],"metadata"===t.kind&&"id3"===t.label)return gr(t,this.media),t;return this.media.addTextTrack("metadata","id3")}},n.onFragParsingMetadata=function(n,t){var c,r,l,i,u,f,e,o,s,h;if(this.media)for(c=t.frag,r=t.samples,this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden"),l=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,i=0;i<r.length;i++)if(u=et.c(r[i].data),u)for(f=r[i].pts,e=i<r.length-1?r[i+1].pts:c.end,e-f<=0&&(e=f+.25),o=0;o<u.length;o++)s=u[o],et.e(s)||(h=new l(f,e,""),h.value=s,this.id3Track.addCue(h))},n.onBufferFlushing=function(n,t){var u=t.startOffset,f=t.endOffset,r=t.type,i;r&&"audio"!==r||(i=this.id3Track,i&&ui(i,u,f))},t}();ru=function(){function t(n){var t=this;this.hls=void 0;this.config=void 0;this.media=null;this.levelDetails=null;this.currentTime=0;this.stallCount=0;this._latency=null;this.timeupdateHandler=function(){return t.timeupdate()};this.hls=n;this.config=n.config;this.registerListeners()}var i,e,o,n=t.prototype;return n.destroy=function(){this.unregisterListeners();this.onMediaDetaching();this.levelDetails=null;this.hls=this.timeupdateHandler=null},n.registerListeners=function(){this.hls.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);this.hls.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);this.hls.on(r.a.LEVEL_UPDATED,this.onLevelUpdated,this);this.hls.on(r.a.ERROR,this.onError,this)},n.unregisterListeners=function(){this.hls.off(r.a.MEDIA_ATTACHED,this.onMediaAttached);this.hls.off(r.a.MEDIA_DETACHING,this.onMediaDetaching);this.hls.off(r.a.MANIFEST_LOADING,this.onManifestLoading);this.hls.off(r.a.LEVEL_UPDATED,this.onLevelUpdated);this.hls.off(r.a.ERROR,this.onError)},n.onMediaAttached=function(n,t){this.media=t.media;this.media.addEventListener("timeupdate",this.timeupdateHandler)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},n.onManifestLoading=function(){this.levelDetails=null;this._latency=null;this.stallCount=0},n.onLevelUpdated=function(n,t){var i=t.details;this.levelDetails=i;i.advanced&&this.timeupdate();!i.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},n.onError=function(n,t){t.details===f.a.BUFFER_STALLED_ERROR&&(this.stallCount++,u.b.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},n.timeupdate=function(){var n=this.media,u=this.levelDetails,t,i,r,o,s,h;if(n&&u&&(this.currentTime=n.currentTime,t=this.computeLatency(),null!==t)){this._latency=t;var f=this.config,c=f.lowLatencyMode,e=f.maxLiveSyncPlaybackRate;c&&1!==e&&(i=this.targetLatency,null!==i&&(r=t-i,o=r<Math.min(this.maxLatency,i+u.targetduration),u.live&&o&&r>.05&&this.forwardBufferLength>1?(s=Math.min(2,Math.max(1,e)),h=Math.round(40/(1+Math.exp(-.75*r-this.edgeStalled)))/20,n.playbackRate=Math.min(s,Math.max(1,h))):1!==n.playbackRate&&0!==n.playbackRate&&(n.playbackRate=1)))}},n.estimateLiveEdge=function(){var n=this.levelDetails;return null===n?null:n.edge+n.age},n.computeLatency=function(){var n=this.estimateLiveEdge();return null===n?null:n-this.currentTime},i=t,(e=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var n=this.config,t=this.levelDetails;return void 0!==n.liveMaxLatencyDuration?n.liveMaxLatencyDuration:t?n.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var n=this.levelDetails,e;if(null===n)return null;var o=n.holdBack,s=n.partHoldBack,r=n.targetduration,t=this.config,u=t.liveSyncDuration,h=t.liveSyncDurationCount,c=t.lowLatencyMode,f=this.hls.userConfig,i=c&&s||o;return(f.liveSyncDuration||f.liveSyncDurationCount||0===i)&&(i=void 0!==u?u:h*r),e=r,i+Math.min(1*this.stallCount,e)}},{key:"liveSyncPosition",get:function(){var t=this.estimateLiveEdge(),i=this.targetLatency,n=this.levelDetails;if(null===t||null===i||null===n)return null;var r=n.edge,u=t-i-this.edgeStalled,f=r-n.totalduration,e=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(f,u),e)}},{key:"drift",get:function(){var n=this.levelDetails;return null===n?1:n.drift}},{key:"edgeStalled",get:function(){var n=this.levelDetails,t;return null===n?0:(t=3*(this.config.lowLatencyMode&&n.partTarget||n.targetduration),Math.max(n.age-t,0))}},{key:"forwardBufferLength",get:function(){var n=this.media,i=this.levelDetails,t;return!n||!i?0:(t=n.buffered.length,t?n.buffered.end(t-1):i.edge-this.currentTime)}}])&&iu(i.prototype,e),o&&iu(i,o),t}();!function(n){n.No="";n.Yes="YES";n.v2="v2"}(k||(k={}));fi=function(){function n(n,t,i){this.msn=void 0;this.part=void 0;this.skip=void 0;this.msn=n;this.part=t;this.skip=i}return n.prototype.addDirectives=function(n){var t=new self.URL(n);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.toString()},n}();lt=function(){function t(n){this.attrs=void 0;this.audioCodec=void 0;this.bitrate=void 0;this.codecSet=void 0;this.height=void 0;this.id=void 0;this.name=void 0;this.videoCodec=void 0;this.width=void 0;this.unknownCodecs=void 0;this.audioGroupIds=void 0;this.details=void 0;this.fragmentError=0;this.loadError=0;this.loaded=void 0;this.realBitrate=0;this.textGroupIds=void 0;this.url=void 0;this._urlId=0;this.url=[n.url];this.attrs=n.attrs;this.bitrate=n.bitrate;n.details&&(this.details=n.details);this.id=n.id||0;this.name=n.name;this.width=n.width||0;this.height=n.height||0;this.audioCodec=n.audioCodec;this.videoCodec=n.videoCodec;this.unknownCodecs=n.unknownCodecs;this.codecSet=[n.videoCodec,n.audioCodec].filter(function(n){return n}).join(",").replace(/\.[^.,]+/g,"")}var n,i,r;return n=t,(i=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(n){var t=n%this.url.length;this._urlId!==t&&(this.details=void 0,this._urlId=t)}}])&&uu(n.prototype,i),r&&uu(n,r),t}();at=function(){function t(n,t){this.hls=void 0;this.timer=-1;this.canLoad=!1;this.retryCount=0;this.log=void 0;this.warn=void 0;this.log=u.b.log.bind(u.b,t+":");this.warn=u.b.warn.bind(u.b,t+":");this.hls=n}var n=t.prototype;return n.destroy=function(){this.clearTimer();this.hls=this.log=this.warn=null},n.onError=function(n,t){t.fatal&&t.type===f.b.NETWORK_ERROR&&this.clearTimer()},n.clearTimer=function(){clearTimeout(this.timer);this.timer=-1},n.startLoad=function(){this.canLoad=!0;this.retryCount=0;this.loadPlaylist()},n.stopLoad=function(){this.canLoad=!1;this.clearTimer()},n.switchParams=function(n,t){var f=null==t?void 0:t.renditionReports,r,u,e,s,i,h;if(f)for(r=0;r<f.length;r++)if(u=f[r],e=""+u.URI,e===n.substr(-e.length)&&(s=parseInt(u["LAST-MSN"]),i=parseInt(u["LAST-PART"]),t&&this.hls.config.lowLatencyMode&&(h=Math.min(t.age-t.partTarget,t.targetduration),void 0!==i&&h>t.partTarget&&(i+=1)),Object(o.a)(s)))return new fi(s,Object(o.a)(i)?i:void 0,k.No)},n.loadPlaylist=function(){},n.shouldLoadTrack=function(n){return this.canLoad&&n&&!!n.url&&(!n.details||n.details.live)},n.playlistLoaded=function(n,t,i){var b=this,r=t.details,h=t.stats,k=h.loading.end?Math.max(0,self.performance.now()-h.loading.end):0,o,f,e,v,s;if(r.advancedDateTime=Date.now()-k,r.live||null!=i&&i.live){if(r.reloaded(i),i&&this.log("live playlist "+n+" "+(r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:"MISSED")),i&&r.fragments.length>0&&ps(i,r),!this.canLoad||!r.live)return;if(f=void 0,e=void 0,r.canBlockReload&&r.endSN&&r.advanced){var y=this.hls.config.lowLatencyMode,p=r.lastPartSn,c=r.endSN,l=r.lastPartIndex,a=p===c;-1!==l?(f=a?c+1:p,e=a?y?0:l:l+1):f=c+1;var w=r.age,d=w+r.ageHeader,u=Math.min(d-r.partTarget,1.5*r.targetduration);if(u>0&&(i&&u>i.tuneInGoal?(this.warn("CDN Tune-in goal increased from: "+i.tuneInGoal+" to: "+u+" with playlist age: "+r.age),u=0):(v=Math.floor(u/r.targetduration),(f+=v,void 0!==e)&&(e+=Math.round(u%r.targetduration/r.partTarget)),this.log("CDN Tune-in age: "+r.ageHeader+"s last advanced "+w.toFixed(2)+"s goal: "+u+" skip sn "+v+" to part "+e)),r.tuneInGoal=u),o=this.getDeliveryDirectives(r,t.deliveryDirectives,f,e),y||!a)return void this.loadPlaylist(o)}else o=this.getDeliveryDirectives(r,t.deliveryDirectives,f,e);s=function(n,t){var i,r=1e3*n.levelTargetDuration,e=r/2,u=n.age,o=u>0&&u<3*r,s=t.loading.end-t.loading.start,f=n.availabilityDelay,h;return!1===n.updated?o?(h=333*n.misses,i=Math.max(Math.min(e,2*s),h),n.availabilityDelay=(n.availabilityDelay||0)+i):i=e:o?(f=Math.min(f||r/2,u),n.availabilityDelay=f,i=f+r-u):i=r-s,Math.round(i)}(r,h);void 0!==f&&r.canBlockReload&&(s-=r.partTarget||1);this.log("reload live playlist "+n+" in "+Math.round(s)+" ms");this.timer=self.setTimeout(function(){return b.loadPlaylist(o)},s)}else this.clearTimer()},n.getDeliveryDirectives=function(n,t,i,r){var u=function(n,t){var i=n.canSkipUntil,r=n.canSkipDateRanges,u=n.endSN;return i&&(void 0!==t?t-u:0)<i?r?k.v2:k.Yes:k.No}(n,i);return null!=t&&t.skip&&n.deltaUpdateFailed&&(i=t.msn,r=t.part,u=k.No),new fi(i,r,u)},n.retryLoadingOrFail=function(n){var t,f=this,i=this.hls.config,u=this.retryCount<i.levelLoadingMaxRetry,r;return u?(this.retryCount++,n.details.indexOf("LoadTimeOut")>-1&&null!==(t=n.context)&&void 0!==t&&t.deliveryDirectives)?(this.warn("retry playlist loading #"+this.retryCount+' after "'+n.details+'"'),this.loadPlaylist()):(r=Math.min(Math.pow(2,this.retryCount)*i.levelLoadingRetryDelay,i.levelLoadingMaxRetryTimeout),this.timer=self.setTimeout(function(){return f.loadPlaylist()},r),this.warn("retry playlist loading #"+this.retryCount+" in "+r+' ms after "'+n.details+'"')):(this.warn('cannot recover from error "'+n.details+'"'),this.clearTimer(),n.fatal=!0),u},t}();au=/chrome|firefox/.test(navigator.userAgent.toLowerCase());vu=function(n){function u(t){var i;return(i=n.call(this,t,"[level-controller]")||this)._levels=[],i._firstLevel=-1,i._startLevel=void 0,i.currentLevelIndex=-1,i.manualLevelIndex=-1,i.onParsedComplete=void 0,i._registerListeners(),i}var i,o,s,h,c,t;return o=n,(i=u).prototype=Object.create(o.prototype),i.prototype.constructor=i,lu(i,o),t=u.prototype,t._registerListeners=function(){var n=this.hls;n.on(r.a.MANIFEST_LOADED,this.onManifestLoaded,this);n.on(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.on(r.a.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);n.on(r.a.FRAG_LOADED,this.onFragLoaded,this);n.on(r.a.ERROR,this.onError,this)},t._unregisterListeners=function(){var n=this.hls;n.off(r.a.MANIFEST_LOADED,this.onManifestLoaded,this);n.off(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.off(r.a.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);n.off(r.a.FRAG_LOADED,this.onFragLoaded,this);n.off(r.a.ERROR,this.onError,this)},t.destroy=function(){this._unregisterListeners();this.manualLevelIndex=-1;this._levels.length=0;n.prototype.destroy.call(this)},t.startLoad=function(){this._levels.forEach(function(n){n.loadError=0});n.prototype.startLoad.call(this)},t.onManifestLoaded=function(n,t){var h,u,i=[],c=[],a=[],v={},l=!1,e=!1,o=!1,s,y,p;if(t.levels.forEach(function(n){var t=n.attrs,r;l=l||!(!n.width||!n.height);e=e||!!n.videoCodec;o=o||!!n.audioCodec;au&&n.audioCodec&&-1!==n.audioCodec.indexOf("mp4a.40.34")&&(n.audioCodec=void 0);r=n.bitrate+"-"+n.attrs.RESOLUTION+"-"+n.attrs.CODECS;(u=v[r])?u.url.push(n.url):(u=new lt(n),v[r]=u,i.push(u));t&&(t.AUDIO&&fu(u,"audio",t.AUDIO),t.SUBTITLES&&fu(u,"text",t.SUBTITLES))}),(l||e)&&o&&(i=i.filter(function(n){var t=n.videoCodec,i=n.width,r=n.height;return!!t||!(!i||!r)})),i=i.filter(function(n){var t=n.audioCodec,i=n.videoCodec;return(!t||ri(t,"audio"))&&(!i||ri(i,"video"))}),t.audioTracks&&eu(c=t.audioTracks.filter(function(n){return!n.audioCodec||ri(n.audioCodec,"audio")})),t.subtitles&&eu(a=t.subtitles),i.length>0){for(h=i[0].bitrate,i.sort(function(n,t){return n.bitrate-t.bitrate}),this._levels=i,s=0;s<i.length;s++)if(i[s].bitrate===h){this._firstLevel=s;this.log("manifest loaded, "+i.length+" level(s) found, first bitrate: "+h);break}y=o&&!e;p={levels:i,audioTracks:c,subtitleTracks:a,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:e,altAudio:!y&&c.some(function(n){return!!n.url})};this.hls.trigger(r.a.MANIFEST_PARSED,p);(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,reason:"no level with compatible codecs found in manifest"})},t.onError=function(t,i){var r,u,o,s,c,h;if(n.prototype.onError.call(this,t,i),!i.fatal)if(r=i.context,u=this._levels[this.currentLevelIndex],r&&(r.type===e.a.AUDIO_TRACK&&u.audioGroupIds&&r.groupId===u.audioGroupIds[u.urlId]||r.type===e.a.SUBTITLE_TRACK&&u.textGroupIds&&r.groupId===u.textGroupIds[u.urlId]))this.redundantFailover(this.currentLevelIndex);else{s=!1;c=!0;switch(i.details){case f.a.FRAG_LOAD_ERROR:case f.a.FRAG_LOAD_TIMEOUT:case f.a.KEY_LOAD_ERROR:case f.a.KEY_LOAD_TIMEOUT:i.frag&&(h=this._levels[i.frag.level],h?(h.fragmentError++,h.fragmentError>this.hls.config.fragLoadingMaxRetry&&(o=i.frag.level)):o=i.frag.level);break;case f.a.LEVEL_LOAD_ERROR:case f.a.LEVEL_LOAD_TIMEOUT:r&&(r.deliveryDirectives&&(c=!1),o=r.level);s=!0;break;case f.a.REMUX_ALLOC_ERROR:o=i.level;s=!0}void 0!==o&&this.recoverLevel(i,o,s,c)}},t.recoverLevel=function(n,t,i,r){var o=n.details,f=this._levels[t],e,u;if(f.loadError++,i){if(!this.retryLoadingOrFail(n))return void(this.currentLevelIndex=-1);n.levelRetry=!0}r&&(e=f.url.length,e>1&&f.loadError<e?(n.levelRetry=!0,this.redundantFailover(t)):-1===this.manualLevelIndex&&(u=0===t?this._levels.length-1:t-1,this.currentLevelIndex!==u&&0===this._levels[u].loadError&&(this.warn(o+": switch to "+u),n.levelRetry=!0,this.hls.nextAutoLevel=u)))},t.redundantFailover=function(n){var i=this._levels[n],r=i.url.length,t;r>1&&(t=(i.urlId+1)%r,this.warn("Switching to redundant URL-id "+t),this._levels.forEach(function(n){n.urlId=t}),this.level=n)},t.onFragLoaded=function(n,t){var r=t.frag,i;void 0!==r&&r.type===e.b.MAIN&&(i=this._levels[r.level],void 0!==i&&(i.fragmentError=0,i.loadError=0))},t.onLevelLoaded=function(n,t){var u,f,i=t.level,e=t.details,r=this._levels[i];if(!r)return this.warn("Invalid level index "+i),void(null!==(f=t.deliveryDirectives)&&void 0!==f&&f.skip&&(e.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===r.fragmentError&&(r.loadError=0,this.retryCount=0),this.playlistLoaded(i,t,r.details)):null!==(u=t.deliveryDirectives)&&void 0!==u&&u.skip&&(e.deltaUpdateFailed=!0)},t.onAudioTrackSwitched=function(n,t){var i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){for(var u=-1,f=this.hls.audioTracks[t.id].groupId,r=0;r<i.audioGroupIds.length;r++)if(i.audioGroupIds[r]===f){u=r;break}u!==i.urlId&&(i.urlId=u,this.startLoad())}},t.loadPlaylist=function(n){var f=this.currentLevelIndex,i=this._levels[f],u,t;if(this.canLoad&&i&&i.url.length>0){if(u=i.urlId,t=i.url[u],n)try{t=n.addDirectives(t)}catch(n){this.warn("Could not construct new URL with HLS Delivery Directives: "+n)}this.log("Attempt loading level index "+f+(n?" at sn "+n.msn+" part "+n.part:"")+" with URL-id "+u+" "+t);this.clearTimer();this.hls.trigger(r.a.LEVEL_LOADING,{url:t,level:f,id:u,deliveryDirectives:n||null})}},t.removeLevel=function(n,t){var i=function(n,i){return i!==t},u=this._levels.filter(function(r,u){return u!==n||r.url.length>1&&void 0!==t&&(r.url=r.url.filter(i),r.audioGroupIds&&(r.audioGroupIds=r.audioGroupIds.filter(i)),r.textGroupIds&&(r.textGroupIds=r.textGroupIds.filter(i)),r.urlId=0,!0)}).map(function(n,t){var i=n.details;return null!=i&&i.fragments&&i.fragments.forEach(function(n){n.level=t}),n});this._levels=u;this.hls.trigger(r.a.LEVELS_UPDATED,{levels:u})},s=u,(h=[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(n){var u,t=this._levels,e,o,s,l;if(0!==t.length&&(this.currentLevelIndex!==n||null===(u=t[n])||void 0===u||!u.details)){if(n<0||n>=t.length){if(e=n<0,this.hls.trigger(r.a.ERROR,{type:f.b.OTHER_ERROR,details:f.a.LEVEL_SWITCH_ERROR,level:n,fatal:e,reason:"invalid level idx"}),e)return;n=Math.min(n,t.length-1)}this.clearTimer();var h=this.currentLevelIndex,c=t[h],i=t[n];this.log("switching to level "+n+" from "+h);this.currentLevelIndex=n;o=hu({},i,{level:n,maxBitrate:i.maxBitrate,uri:i.uri,urlId:i.urlId});delete o._urlId;this.hls.trigger(r.a.LEVEL_SWITCHING,o);s=i.details;(!s||s.live)&&(l=this.switchParams(i.uri,null==c?void 0:c.details),this.loadPlaylist(l))}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(n){this.manualLevelIndex=n;void 0===this._startLevel&&(this._startLevel=n);-1!==n&&(this.level=n)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(n){this._firstLevel=n}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var n=this.hls.config.startLevel;return void 0!==n?n:this._firstLevel}return this._startLevel},set:function(n){this._startLevel=n}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(n){this.level=n;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=n)}}])&&cu(s.prototype,h),c&&cu(s,c),u}(at);!function(n){n.NOT_LOADED="NOT_LOADED";n.BACKTRACKED="BACKTRACKED";n.APPENDING="APPENDING";n.PARTIAL="PARTIAL";n.OK="OK"}(l||(l={}));yu=function(){function t(n){this.activeFragment=null;this.activeParts=null;this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.bufferPadding=.2;this.hls=void 0;this.hls=n;this._registerListeners()}var n=t.prototype;return n._registerListeners=function(){var n=this.hls;n.on(r.a.BUFFER_APPENDED,this.onBufferAppended,this);n.on(r.a.FRAG_BUFFERED,this.onFragBuffered,this);n.on(r.a.FRAG_LOADED,this.onFragLoaded,this)},n._unregisterListeners=function(){var n=this.hls;n.off(r.a.BUFFER_APPENDED,this.onBufferAppended,this);n.off(r.a.FRAG_BUFFERED,this.onFragBuffered,this);n.off(r.a.FRAG_LOADED,this.onFragLoaded,this)},n.destroy=function(){this._unregisterListeners();this.fragments=this.timeRanges=null},n.getAppendedFrag=function(n,t){var i,r,u,f,o;if(t===e.b.MAIN){if(i=this.activeFragment,r=this.activeParts,!i)return null;if(r){for(u=r.length;u--;)if(f=r[u],o=f?f.end:i.appendedPTS,f.start<=n&&void 0!==o&&n<=o)return u>9&&(this.activeParts=r.slice(u-9)),f}else if(i.start<=n&&void 0!==i.appendedPTS&&n<=i.appendedPTS)return i}return this.getBufferedFrag(n,t)},n.getBufferedFrag=function(n,t){for(var i,r,u=this.fragments,f=Object.keys(u),e=f.length;e--;)if(i=u[f[e]],(null==i?void 0:i.body.type)===t&&i.buffered&&(r=i.body,r.start<=n&&n<=r.end))return r;return null},n.detectEvictedFragments=function(n,t,i){var r=this;Object.keys(this.fragments).forEach(function(u){var f=r.fragments[u],e;f&&(f.buffered?(e=f.range[n],e&&e.time.some(function(n){var i=!r.isTimeBuffered(n.startPTS,n.endPTS,t);return i&&r.removeFragment(f.body),i})):f.body.type===i&&r.removeFragment(f.body))})},n.detectPartialFragments=function(n){var e=this,r=this.timeRanges,i=n.frag,u=n.part,f,t;r&&"initSegment"!==i.sn&&(f=w(i),t=this.fragments[f],t&&(Object.keys(r).forEach(function(n){var f=i.elementaryStreams[n],o,s;f&&(o=r[n],s=null!==u||!0===f.partial,t.range[n]=e.getBufferedTimes(i,u,s,o))}),t.backtrack=t.loaded=null,Object.keys(t.range).length?t.buffered=!0:this.removeFragment(t.body)))},n.fragBuffered=function(n){var i=w(n),t=this.fragments[i];t&&(t.backtrack=t.loaded=null,t.buffered=!0)},n.getBufferedTimes=function(n,t,i,r){for(var s,h,e={time:[],partial:i},o=t?t.start:n.start,f=t?t.end:n.end,c=n.minEndPTS||f,l=n.maxStartPTS||o,u=0;u<r.length;u++){if(s=r.start(u)-this.bufferPadding,h=r.end(u)+this.bufferPadding,l>=s&&c<=h){e.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(f,r.end(u))});break}if(o<h&&f>s)e.partial=!0,e.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(f,r.end(u))});else if(f<=s)break}return e},n.getPartialFragment=function(n){var t,i,r,u=null,f=0,e=this.bufferPadding,o=this.fragments;return Object.keys(o).forEach(function(s){var h=o[s];h&&pu(h)&&(i=h.body.start-e,r=h.body.end+e,n>=i&&n<=r&&(t=Math.min(n-i,r-n),f<=t&&(u=h.body,f=t)))}),u},n.getState=function(n){var i=w(n),t=this.fragments[i];return t?t.buffered?pu(t)?l.PARTIAL:l.OK:t.backtrack?l.BACKTRACKED:l.APPENDING:l.NOT_LOADED},n.backtrack=function(n,t){var u=w(n),i=this.fragments[u],r;return!i||i.backtrack?null:(r=i.backtrack=t||i.loaded,i.loaded=null,r)},n.getBacktrackData=function(n){var u=w(n),r=this.fragments[u],i,t;if(r){if(t=r.backtrack,null!=t&&null!==(i=t.payload)&&void 0!==i&&i.byteLength)return t;this.removeFragment(n)}return null},n.isTimeBuffered=function(n,t,i){for(var u,f,r=0;r<i.length;r++){if(u=i.start(r)-this.bufferPadding,f=i.end(r)+this.bufferPadding,n>=u&&t<=f)return!0;if(t<=u)return!1}return!1},n.onFragLoaded=function(n,t){var i=t.frag,u=t.part,r;"initSegment"===i.sn||i.bitrateTest||u||(r=w(i),this.fragments[r]={body:i,loaded:t,backtrack:null,buffered:!1,range:Object.create(null)})},n.onBufferAppended=function(n,t){var o=this,i=t.frag,u=t.part,f=t.timeRanges,r;i.type===e.b.MAIN&&((this.activeFragment=i,u)?(r=this.activeParts,r||(this.activeParts=r=[]),r.push(u)):this.activeParts=null);this.timeRanges=f;Object.keys(f).forEach(function(n){var r=f[n],t;if(o.detectEvictedFragments(n,r),!u)for(t=0;t<r.length;t++)i.appendedPTS=Math.max(r.end(t),i.appendedPTS||0)})},n.onFragBuffered=function(n,t){this.detectPartialFragments(t)},n.hasFragment=function(n){var t=w(n);return!!this.fragments[t]},n.removeFragmentsInRange=function(n,t,i){var r=this;Object.keys(this.fragments).forEach(function(u){var e=r.fragments[u],f;e&&e.buffered&&(f=e.body,f.type===i&&f.start<t&&f.end>n&&r.removeFragment(f))})},n.removeFragment=function(n){var t=w(n);n.stats.loaded=0;n.clearElementaryStreamInfo();delete this.fragments[t]},n.removeAllFragments=function(){this.fragments=Object.create(null);this.activeFragment=null;this.activeParts=null},t}();var ws=function(){function t(){this._boundTick=void 0;this._tickTimer=null;this._tickInterval=null;this._tickCallCount=0;this._boundTick=this.tick.bind(this)}var n=t.prototype;return n.destroy=function(){this.onHandlerDestroying();this.onHandlerDestroyed()},n.onHandlerDestroying=function(){this.clearNextTick();this.clearInterval()},n.onHandlerDestroyed=function(){},n.hasInterval=function(){return!!this._tickInterval},n.hasNextTick=function(){return!!this._tickTimer},n.setInterval=function(n){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,n),!0)},n.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},n.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},n.tick=function(){this._tickCallCount++;1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},n.tickImmediate=function(){this.clearNextTick();this._tickTimer=self.setTimeout(this._boundTick,0)},n.doTick=function(){},t}(),bs={length:0,start:function(){return 0},end:function(){return 0}},c=function(){function n(){}return n.isBuffered=function(t,i){try{if(t)for(var u=n.getBuffered(t),r=0;r<u.length;r++)if(i>=u.start(r)&&i<=u.end(r))return!0}catch(n){}return!1},n.bufferInfo=function(t,i,r){try{if(t){for(var f=n.getBuffered(t),e=[],u=0;u<f.length;u++)e.push({start:f.start(u),end:f.end(u)});return this.bufferedInfo(e,i,r)}}catch(n){}return{len:0,start:i,end:i,nextStart:void 0}},n.bufferedInfo=function(n,t,i){var r,u,e,s,f,h;if(t=Math.max(0,t),n.sort(function(n,t){var i=n.start-t.start;return i||t.end-n.end}),r=[],i)for(u=0;u<n.length;u++)e=r.length,e?(s=r[e-1].end,n[u].start-s<i?n[u].end>s&&(r[e-1].end=n[u].end):r.push(n[u])):r.push(n[u]);else r=n;for(var c,l=0,a=t,v=t,o=0;o<r.length;o++)if(f=r[o].start,h=r[o].end,t+i>=f&&t<h)a=f,l=(v=h)-t;else if(t+i<f){c=f;break}return{len:l,start:a||0,end:v||0,nextStart:c}},n.getBuffered=function(n){try{return n.buffered}catch(n){return u.b.log("failed to get media.buffered",n),bs}},n}(),si=function(n,t,i,r,u,f){void 0===r&&(r=0);void 0===u&&(u=-1);void 0===f&&(f=!1);this.level=void 0;this.sn=void 0;this.part=void 0;this.id=void 0;this.size=void 0;this.partial=void 0;this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0};this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}};this.level=n;this.sn=t;this.id=i;this.size=r;this.part=u;this.partial=f};hi={search:function(n,t){for(var f,i=0,r=n.length-1,u=null,e=null;i<=r;)if(f=t(e=n[u=(i+r)/2|0]),f>0)i=u+1;else{if(!(f<0))return e;r=u-1}return null}};ai=Math.pow(2,17);rf=function(){function t(n){this.config=void 0;this.loader=null;this.partLoadTimeout=-1;this.config=n}var n=t.prototype;return n.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},n.abort=function(){this.loader&&this.loader.abort()},n.load=function(n,t){var i=this,u=n.url;if(!u)return Promise.reject(new d({type:f.b.NETWORK_ERROR,details:f.a.FRAG_LOAD_ERROR,fatal:!1,frag:n,networkDetails:null},"Fragment does not have a "+(u?"part list":"url")));this.abort();var r=this.config,e=r.fLoader,o=r.loader;return new Promise(function(u,s){i.loader&&i.loader.destroy();var h=i.loader=n.loader=e?new e(r):new o(r),c=uf(n),l={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout,highWaterMark:ai};n.stats=h.stats;h.load(c,l,{onSuccess:function(t,r,f,e){i.resetLoader(n,h);u({frag:n,part:null,payload:t.data,networkDetails:e})},onError:function(t,r,u){i.resetLoader(n,h);s(new d({type:f.b.NETWORK_ERROR,details:f.a.FRAG_LOAD_ERROR,fatal:!1,frag:n,response:t,networkDetails:u}))},onAbort:function(t,r,u){i.resetLoader(n,h);s(new d({type:f.b.NETWORK_ERROR,details:f.a.INTERNAL_ABORTED,fatal:!1,frag:n,networkDetails:u}))},onTimeout:function(t,r,u){i.resetLoader(n,h);s(new d({type:f.b.NETWORK_ERROR,details:f.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n,networkDetails:u}))},onProgress:function(i,r,u,f){t&&t({frag:n,part:null,payload:u,networkDetails:f})}})})},n.loadPart=function(n,t,i){var r=this;this.abort();var u=this.config,e=u.fLoader,o=u.loader;return new Promise(function(s,h){r.loader&&r.loader.destroy();var c=r.loader=n.loader=e?new e(u):new o(u),l=uf(n,t),a={timeout:u.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:u.fragLoadingMaxRetryTimeout,highWaterMark:ai};t.stats=c.stats;c.load(l,a,{onSuccess:function(u,f,e,o){r.resetLoader(n,c);r.updateStatsFromPart(n,t);var h={frag:n,part:t,payload:u.data,networkDetails:o};i(h);s(h)},onError:function(i,u,e){r.resetLoader(n,c);h(new d({type:f.b.NETWORK_ERROR,details:f.a.FRAG_LOAD_ERROR,fatal:!1,frag:n,part:t,response:i,networkDetails:e}))},onAbort:function(i,u,e){n.stats.aborted=t.stats.aborted;r.resetLoader(n,c);h(new d({type:f.b.NETWORK_ERROR,details:f.a.INTERNAL_ABORTED,fatal:!1,frag:n,part:t,networkDetails:e}))},onTimeout:function(i,u,e){r.resetLoader(n,c);h(new d({type:f.b.NETWORK_ERROR,details:f.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:n,part:t,networkDetails:e}))}})})},n.updateStatsFromPart=function(n,t){var i=n.stats,f=t.stats,e=f.total,r,u;if(i.loaded+=f.loaded,e){var o=Math.round(n.duration/t.duration),s=Math.min(Math.round(i.loaded/e),o),h=(o-s)*Math.round(i.loaded/s);i.total=i.loaded+h}else i.total=Math.max(i.loaded,i.total);r=i.loading;u=f.loading;r.start?r.first+=u.first-u.start:(r.start=u.start,r.first=u.first);r.end=u.end},n.resetLoader=function(n,t){n.loader=null;this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null);t.destroy()},t}();var d=function(n){function r(t){for(var r,u=arguments.length,f=new Array(u>1?u-1:0),i=1;i<u;i++)f[i-1]=arguments[i];return(r=n.call.apply(n,[this].concat(f))||this).data=void 0,r.data=t,r}var t,i;return i=n,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,vt(t,i),r}(gu(Error)),nh=i(15),th={toString:function(n){for(var i="",r=n.length,t=0;t<r;t++)i+="["+n.start(t).toFixed(3)+","+n.end(t).toFixed(3)+"]";return i}};var b="STOPPED",h="IDLE",vi="KEY_LOADING",ot="FRAG_LOADING",yt="FRAG_LOADING_WAITING_RETRY",pt="WAITING_TRACK",p="PARSING",wt="PARSED",yi="BACKTRACKING",bt="ENDED",st="ERROR",ht="WAITING_INIT_PTS",tt="WAITING_LEVEL",pi=function(n){function s(t,i,f){var e;return(e=n.call(this)||this).hls=void 0,e.fragPrevious=null,e.fragCurrent=null,e.fragmentTracker=void 0,e.transmuxer=null,e._state=b,e.media=void 0,e.mediaBuffer=void 0,e.config=void 0,e.bitrateTest=!1,e.lastCurrentTime=0,e.nextLoadPosition=0,e.startPosition=0,e.loadedmetadata=!1,e.fragLoadError=0,e.retryDate=0,e.levels=null,e.fragmentLoader=void 0,e.levelLastLoaded=null,e.startFragRequested=!1,e.decrypter=void 0,e.initPTS=[],e.onvseeking=null,e.onvended=null,e.logPrefix="",e.log=void 0,e.warn=void 0,e.logPrefix=f,e.log=u.b.log.bind(u.b,f+":"),e.warn=u.b.warn.bind(u.b,f+":"),e.hls=t,e.fragmentLoader=new rf(t.config),e.fragmentTracker=i,e.config=t.config,e.decrypter=new nh.a(t,t.config),t.on(r.a.KEY_LOADED,e.onKeyLoaded,function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(e)),e}var i,a,v,y,w,t;return a=n,(i=s).prototype=Object.create(a.prototype),i.prototype.constructor=i,ef(i,a),t=s.prototype,t.doTick=function(){this.onTickEnd()},t.onTickEnd=function(){},t.startLoad=function(){},t.stopLoad=function(){this.fragmentLoader.abort();var n=this.fragCurrent;n&&this.fragmentTracker.removeFragment(n);this.resetTransmuxer();this.fragCurrent=null;this.fragPrevious=null;this.clearInterval();this.clearNextTick();this.state=b},t._streamEnded=function(n,t){var r=this.fragCurrent,e=this.fragmentTracker,i,u,f;return!t.live&&r&&r.sn>=t.endSN&&!n.nextStart?(i=t.partList,null!=i&&i.length)?(u=i[i.length-1],c.isBuffered(this.media,u.start+u.duration/2)):(f=e.getState(r),f===l.PARTIAL||f===l.OK):!1},t.onMediaAttached=function(n,t){var r=this.media=this.mediaBuffer=t.media,i;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("ended",this.onvended);i=this.config;this.levels&&i.autoStartLoad&&this.state===b&&this.startLoad(i.startPosition)},t.onMediaDetaching=function(){var n=this.media;null!=n&&n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null);this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.fragmentTracker.removeAllFragments();this.stopLoad()},t.onMediaSeeking=function(){var r=this.config,t=this.fragCurrent,i=this.media,h=this.mediaBuffer,u=this.state,n=i?i.currentTime:0,f=c.bufferInfo(h||i,n,r.maxBufferHole);if(this.log("media seeking to "+(Object(o.a)(n)?n.toFixed(3):n)+", state: "+u),u===bt)this.resetLoadingState();else if(t&&!f.len){var e=r.maxFragLookUpTolerance,l=t.start-e,s=n>t.start+t.duration+e;(n<l||s)&&(s&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.loader.abort()),this.resetLoadingState())}i&&(this.lastCurrentTime=n);this.loadedmetadata||f.len||(this.nextLoadPosition=this.startPosition=n);this.tickImmediate()},t.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},t.onKeyLoaded=function(n,t){if(this.state===vi&&t.frag===this.fragCurrent&&this.levels){this.state=h;var i=this.levels[t.frag.level].details;i&&this.loadFragment(t.frag,i,t.frag.start)}},t.onHandlerDestroying=function(){this.stopLoad();n.prototype.onHandlerDestroying.call(this)},t.onHandlerDestroyed=function(){this.state=b;this.hls.off(r.a.KEY_LOADED,this.onKeyLoaded,this);this.fragmentLoader&&this.fragmentLoader.destroy();this.decrypter&&this.decrypter.destroy();this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null;n.prototype.onHandlerDestroyed.call(this)},t.loadKey=function(n,t){this.log("Loading key for "+n.sn+" of ["+t.startSN+"-"+t.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+n.level);this.state=vi;this.fragCurrent=n;this.hls.trigger(r.a.KEY_LOADING,{frag:n})},t.loadFragment=function(n,t,i){this._loadFragForPlayback(n,t,i)},t._loadFragForPlayback=function(n,t,i){var u=this;this._doFragLoad(n,t,i,function(t){if(u.fragContextChanged(n))return u.warn("Fragment "+n.sn+(t.part?" p: "+t.part.index:"")+" of level "+n.level+" was dropped during download."),void u.fragmentTracker.removeFragment(n);n.stats.chunkCount++;u._handleFragmentLoadProgress(t)}).then(function(t){if(t){u.fragLoadError=0;var i=u.state;if(!u.fragContextChanged(n))return"payload"in t&&(u.log("Loaded fragment "+n.sn+" of level "+n.level),u.hls.trigger(r.a.FRAG_LOADED,t),u.state===yi)?(u.fragmentTracker.backtrack(n,t),void u.resetFragmentLoading(n)):void u._handleFragmentLoadComplete(t);i!==ot&&i!==yi&&(u.fragCurrent||i!==p)||(u.fragmentTracker.removeFragment(n),u.state=h)}}).catch(function(t){u.warn(t);u.resetFragmentLoading(n)})},t.flushMainBuffer=function(n,t,i){if(void 0===i&&(i=null),n-t){var u={startOffset:n,endOffset:t,type:i};this.fragLoadError=0;this.hls.trigger(r.a.BUFFER_FLUSHING,u)}},t._loadInitSegment=function(n){var t=this;this._doFragLoad(n).then(function(i){if(!i||t.fragContextChanged(n)||!t.levels)throw new Error("init load aborted");return i}).then(function(i){var o=t.hls,f=i.payload,u=n.decryptdata,e;return f&&f.byteLength>0&&u&&u.key&&u.iv&&"AES-128"===u.method?(e=self.performance.now(),t.decrypter.webCryptoDecrypt(new Uint8Array(f),u.key.buffer,u.iv.buffer).then(function(t){var u=self.performance.now();return o.trigger(r.a.FRAG_DECRYPTED,{frag:n,payload:t,stats:{tstart:e,tdecrypt:u}}),i.payload=t,i})):i}).then(function(i){var f=t.fragCurrent,o=t.hls,e=t.levels,u;if(!e)throw new Error("init load aborted, missing levels");e[n.level].details;u=n.stats;t.state=h;t.fragLoadError=0;n.data=new Uint8Array(i.payload);u.parsing.start=u.buffering.start=self.performance.now();u.parsing.end=u.buffering.end=self.performance.now();i.frag===f&&o.trigger(r.a.FRAG_BUFFERED,{stats:u,frag:f,part:null,id:n.type});t.tick()}).catch(function(i){t.warn(i);t.resetFragmentLoading(n)})},t.fragContextChanged=function(n){var t=this.fragCurrent;return!n||!t||n.level!==t.level||n.sn!==t.sn||n.urlId!==t.urlId},t.fragBufferedComplete=function(n,t){var i=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+n.type+" sn: "+n.sn+(t?" part: "+t.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+n.level+" "+th.toString(c.getBuffered(i)));this.state=h;this.tick()},t._handleFragmentLoadComplete=function(n){var r=this.transmuxer;if(r){var t=n.frag,u=n.part,i=n.partsLoaded,f=!i||0===i.length||i.some(function(n){return!n}),e=new si(t.level,t.sn,t.stats.chunkCount+1,0,u?u.index:-1,!f);r.flush(e)}},t._handleFragmentLoadProgress=function(){},t._doFragLoad=function(n,t,i,u){var h=this,f,e,s;if(void 0===i&&(i=null),!this.levels)throw new Error("frag load aborted, missing levels");if((i=Math.max(n.start,i||0),this.config.lowLatencyMode&&t)&&(f=t.partList,f&&u)){if(i>n.end&&t.fragmentHint&&(n=t.fragmentHint),e=this.getNextPart(f,n,i),e>-1)return s=f[e],this.log("Loading part sn: "+n.sn+" p: "+s.index+" cc: "+n.cc+" of playlist ["+t.startSN+"-"+t.endSN+"] parts [0-"+e+"-"+(f.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+n.level+", target: "+parseFloat(i.toFixed(3))),this.nextLoadPosition=s.start+s.duration,this.state=ot,this.hls.trigger(r.a.FRAG_LOADING,{frag:n,part:f[e],targetBufferTime:i}),this.doFragPartsLoad(n,f,e,u).catch(function(n){return h.handleFragLoadError(n)});if(!n.url||this.loadedEndOfParts(f,i))return Promise.resolve(null)}return this.log("Loading fragment "+n.sn+" cc: "+n.cc+" "+(t?"of ["+t.startSN+"-"+t.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+n.level+", target: "+parseFloat(i.toFixed(3))),Object(o.a)(n.sn)&&!this.bitrateTest&&(this.nextLoadPosition=n.start+n.duration),this.state=ot,this.hls.trigger(r.a.FRAG_LOADING,{frag:n,targetBufferTime:i}),this.fragmentLoader.load(n,u).catch(function(n){return h.handleFragLoadError(n)})},t.doFragPartsLoad=function(n,t,i,u){var f=this;return new Promise(function(e,o){var s=[];!function i(h){var c=t[h];f.fragmentLoader.loadPart(n,c,u).then(function(u){var l,o;if(s[c.index]=u,l=u.part,f.hls.trigger(r.a.FRAG_LOADED,u),o=t[h+1],!o||o.fragment!==n)return e({frag:n,part:l,partsLoaded:s});i(h+1)}).catch(o)}(i)})},t.handleFragLoadError=function(n){var t=n.data;return t&&t.details===f.a.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(r.a.ERROR,t),null},t._handleTransmuxerFlush=function(n){var t=this.getCurrentContext(n);if(t&&this.state===p){var r=t.frag,i=t.part,f=t.level,u=self.performance.now();r.stats.parsing.end=u;i&&(i.stats.parsing.end=u);this.updateLevelTiming(r,i,f,n.partial)}else this.fragCurrent||(this.state=h)},t.getCurrentContext=function(n){var t=this.levels,i=n.level,r=n.sn,e=n.part;if(!t||!t[i])return this.warn("Levels object was unset while buffering fragment "+r+" of level "+i+". The current chunk will not be buffered."),null;var u=t[i],f=e>-1?function(n,t,i){var r,f,u;if(!n||!n.details)return null;if(r=n.details.partList,r)for(f=r.length;f--;)if(u=r[f],u.index===i&&u.fragment.sn===t)return u;return null}(u,r,e):null,o=f?f.fragment:function(n,t,i){if(!n||!n.details)return null;var r=n.details,u=r.fragments[t-r.startSN];return u||((u=r.fragmentHint)&&u.sn===t?u:t<r.startSN&&i&&i.sn===t?i:null)}(u,r,this.fragCurrent);return o?{frag:o,part:f,level:u}:null},t.bufferFragmentData=function(n,t,i,u){var s;if(n&&this.state===p){var e=n.data1,o=n.data2,f=e;(e&&o&&(f=Object(ii.a)(e,o)),f&&f.length)&&(s={type:n.type,frag:t,part:i,chunkMeta:u,parent:t.type,data:f},this.hls.trigger(r.a.BUFFER_APPENDING,s),n.dropped&&n.independent&&!i&&this.flushBufferGap(t))}},t.flushBufferGap=function(n){var t=this.media;if(t)if(c.isBuffered(t,t.currentTime)){var r=t.currentTime,f=c.bufferInfo(t,r,0),e=n.duration,i=Math.min(2*this.config.maxFragLookUpTolerance,.25*e),u=Math.max(Math.min(n.start-i,f.end-i),r+i);n.start-u>i&&this.flushMainBuffer(u,n.start)}else this.flushMainBuffer(0,n.start)},t.getFwdBufferInfo=function(n,t){var f=this.config,r=this.getLoadPosition(),i,u;return Object(o.a)(r)?(i=c.bufferInfo(n,r,f.maxBufferHole),0===i.len&&void 0!==i.nextStart&&(u=this.fragmentTracker.getBufferedFrag(r,t),u&&i.nextStart<u.end))?c.bufferInfo(n,r,Math.max(i.nextStart,f.maxBufferHole)):i:null},t.getMaxBufferLength=function(n){var i,t=this.config;return i=n?Math.max(8*t.maxBufferSize/n,t.maxBufferLength):t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)},t.reduceMaxBufferLength=function(n){var t=this.config,i=n||t.maxBufferLength;return t.maxMaxBufferLength>=i&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},t.getNextFragment=function(n,t){var u,f,r=t.fragments,e=r.length,i,o,h,s,c;if(!e)return null;if(o=this.config,h=r[0].start,t.live){if(s=o.initialLiveManifestSize,e<s)return this.warn("Not enough fragments to start playback (have: "+e+", need: "+s+")"),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(i=this.getInitialLiveFragment(t,r),this.startPosition=i?this.hls.liveSyncPosition||i.start:n)}else n<=h&&(i=r[0]);return i||(c=o.lowLatencyMode?t.partEnd:t.fragmentEnd,i=this.getFragmentAtPosition(n,c,t)),null===(u=i)||void 0===u||!u.initSegment||null!==(f=i)&&void 0!==f&&f.initSegment.data||this.bitrateTest||(i=i.initSegment),i},t.getNextPart=function(n,t,i){for(var r,o,f=-1,s=!1,e=!0,u=0,h=n.length;u<h;u++){if(r=n[u],e=e&&!r.independent,f>-1&&i<r.start)break;o=r.loaded;!o&&(s||r.independent||e)&&r.fragment===t&&(f=u);s=o}return f},t.loadedEndOfParts=function(n,t){var i=n[n.length-1];return i&&t>i.start&&i.loaded},t.getInitialLiveFragment=function(n,t){var r=this.fragPrevious,i=null,u,f,e;return r?(n.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),i=function(n,t,i){var r,u;if(null===t||!Array.isArray(n)||!n.length||!Object(o.a)(t)||t<(n[0].programDateTime||0)||t>=(n[n.length-1].endProgramDateTime||0))return null;for(i=i||0,r=0;r<n.length;++r)if(u=n[r],ds(t,i,u))return u;return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),i)||(u=r.sn+1,u>=n.startSN&&u<=n.endSN&&(f=t[u-n.startSN],r.cc===f.cc&&(i=f,this.log("Live playlist, switching playlist, load frag with next SN: "+i.sn))),i||(i=function(n,t){return hi.search(n,function(n){return n.cc<t?1:n.cc>t?-1:0})}(t,r.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+i.sn)):(e=this.hls.liveSyncPosition,null!==e&&(i=this.getFragmentAtPosition(e,this.bitrateTest?n.fragmentEnd:n.edge,n))),i},t.getFragmentAtPosition=function(n,t,i){var r,h=this.config,f=this.fragPrevious,u=i.fragments,c=i.endSN,o=i.fragmentHint,a=h.maxFragLookUpTolerance,v=!!(h.lowLatencyMode&&i.partList&&o),e;if(r=(v&&o&&!this.bitrateTest&&(u=u.concat(o),c=o.sn),n<t)?ci(f,u,n,n>t-a?0:a):u[u.length-1],r){var y=r.sn-i.startSN,p=f&&r.level===f.level,s=u[y+1];if(this.fragmentTracker.getState(r)===l.BACKTRACKED){for(r=null,e=y;u[e]&&this.fragmentTracker.getState(u[e])===l.BACKTRACKED;)r=f?u[e--]:u[--e];r||(r=s)}else f&&r.sn===f.sn&&!v&&p&&(r.sn<c&&this.fragmentTracker.getState(s)!==l.OK?(this.log("SN "+r.sn+" just loaded, load next one: "+s.sn),r=s):r=null)}return r},t.synchronizeToLiveEdge=function(n){var u=this.config,t=this.media,o;if(t){var i=this.hls.liveSyncPosition,r=t.currentTime,s=n.fragments[0].start,f=n.edge,e=r>=s-u.maxFragLookUpTolerance&&r<=f;null!==i&&t.duration>i&&(r<i||!e)&&(o=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*n.targetduration,(!e&&t.readyState<4||r<f-o)&&(this.loadedmetadata||(this.nextLoadPosition=i),t.readyState&&(this.warn("Playback: "+r.toFixed(3)+" is located too far from the end of live sliding playlist: "+f+", reset currentTime to : "+i.toFixed(3)),t.currentTime=i)))}},t.alignPlaylists=function(n,t){var s=this.levels,f=this.levelLastLoaded,i=this.fragPrevious,h=null!==f?s[f]:null,e=n.fragments.length,u;if(!e)return this.warn("No fragments in live playlist"),0;var r=n.fragments[0].start,c=!t,l=n.alignedSliding&&Object(o.a)(r);return c||!l&&!r?(ks(i,h,n),u=n.fragments[0].start,this.log("Live playlist sliding: "+u.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+n.startSN+" prev-sn: "+(i?i.sn:"na")+" fragments: "+e),u):r},t.waitForCdnTuneIn=function(n){return n.live&&n.canBlockReload&&n.tuneInGoal>Math.max(n.partHoldBack,3*n.partTarget)},t.setStartPosition=function(n,t){var i=this.startPosition,r;(i<t&&(i=-1),-1===i||-1===this.lastCurrentTime)&&(r=n.startTimeOffset,Object(o.a)(r)?(i=t+r,r<0&&(i+=n.totalduration),i=Math.min(Math.max(t,i),t+n.totalduration),this.log("Start time offset "+r+" found in playlist, adjust startPosition to "+i),this.startPosition=i):n.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i);this.nextLoadPosition=i},t.getLoadPosition=function(){var t=this.media,n=0;return this.loadedmetadata&&t?n=t.currentTime:this.nextLoadPosition&&(n=this.nextLoadPosition),n},t.handleFragLoadAborted=function(n,t){this.transmuxer&&"initSegment"!==n.sn&&n.stats.aborted&&(this.warn("Fragment "+n.sn+(t?" part"+t.index:"")+" of level "+n.level+" was aborted"),this.resetFragmentLoading(n))},t.resetFragmentLoading=function(n){this.fragCurrent&&this.fragContextChanged(n)||(this.state=h)},t.onFragmentOrKeyLoadError=function(n,t){var i,r,f;if(!t.fatal&&(i=t.frag,i&&i.type===n))if(this.fragCurrent,r=this.config,this.fragLoadError+1<=r.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(i.level))return;f=Math.min(Math.pow(2,this.fragLoadError)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);this.warn("Fragment "+i.sn+" of "+n+" "+i.level+" failed to load, retrying in "+f+"ms");this.retryDate=self.performance.now()+f;this.fragLoadError++;this.state=yt}else t.levelRetry?(n===e.b.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=h):(u.b.error(t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.hls.stopLoad(),this.state=st)},t.afterBufferFlushed=function(n,t,i){if(n){var r=c.getBuffered(n);this.fragmentTracker.detectEvictedFragments(t,r,i);this.state===bt&&this.resetLoadingState()}},t.resetLoadingState=function(){this.fragCurrent=null;this.fragPrevious=null;this.state=h},t.resetLiveStartWhenNotLoaded=function(n){if(!this.loadedmetadata){this.startFragRequested=!1;var t=this.levels?this.levels[n].details:null;if(null!=t&&t.live)return this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},t.updateLevelTiming=function(n,t,i,u){var f=this,e=i.details;Object.keys(n.elementaryStreams).reduce(function(t,o){var s=n.elementaryStreams[o],h,c;return s?(h=s.endPTS-s.startPTS,h<=0)?(f.warn("Could not parse fragment "+n.sn+" "+o+" duration reliably ("+h+") resetting transmuxer to fallback to playlist timing"),f.resetTransmuxer(),t||!1):(c=u?0:ou(e,n,s.startPTS,s.endPTS,s.startDTS,s.endDTS),f.hls.trigger(r.a.LEVEL_PTS_UPDATED,{details:e,level:i,drift:c,type:o,frag:n,start:s.startPTS,end:s.endPTS}),!0):t},!1)?(this.state=wt,this.hls.trigger(r.a.FRAG_PARSED,{frag:n,part:t})):this.resetLoadingState()},t.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},v=s,(y=[{key:"state",get:function(){return this._state},set:function(n){var t=this._state;t!==n&&(this._state=n,this.log(t+"->"+n))}}])&&ff(v.prototype,y),w&&ff(v,w),s}(ws);var ih=i(18),it=i(10),hf=i(14),bi=wi()||{isTypeSupported:function(){return!1}},cf=function(){function t(n,t,i,e){var a=this,s,l,h,c,o;if(this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=n,this.id=t,this.onTransmuxComplete=i,this.onFlush=e,s=n.config,l=function(t,i){(i=i||{}).frag=a.frag;i.id=a.id;n.trigger(t,i)},this.observer=new hf.EventEmitter,this.observer.on(r.a.FRAG_DECRYPTED,l),this.observer.on(r.a.ERROR,l),h={mp4:bi.isTypeSupported("video/mp4"),mpeg:bi.isTypeSupported("audio/mpeg"),mp3:bi.isTypeSupported('audio/mp4; codecs="mp3"')},c=navigator.vendor,s.enableWorker&&"undefined"!=typeof Worker){u.b.log("demuxing in webworker");try{o=this.worker=ih(19);this.onwmsg=this.onWorkerMessage.bind(this);o.addEventListener("message",this.onwmsg);o.onerror=function(t){n.trigger(r.a.ERROR,{type:f.b.OTHER_ERROR,details:f.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(t.message+"  ("+t.filename+":"+t.lineno+")")})};o.postMessage({cmd:"init",typeSupported:h,vendor:c,id:t,config:JSON.stringify(s)})}catch(n){u.b.warn("Error in worker:",n);u.b.error("Error while initializing DemuxerWorker, fallback to inline");o&&self.URL.revokeObjectURL(o.objectURL);this.transmuxer=new it.c(this.observer,h,s,c,t);this.worker=null}}else this.transmuxer=new it.c(this.observer,h,s,c,t)}var n=t.prototype;return n.destroy=function(){var n=this.worker,t,i;n?(n.removeEventListener("message",this.onwmsg),n.terminate(),this.worker=null):(t=this.transmuxer,t&&(t.destroy(),this.transmuxer=null));i=this.observer;i&&i.removeAllListeners();this.observer=null},n.push=function(n,t,i,r,f,e,o,s,h,c){var w,b,st=this,y,g,ot,p;h.transmuxing.start=self.performance.now();var nt=this.transmuxer,tt=this.worker,rt=e?e.start:f.start,ut=f.decryptdata,l=this.frag,k=!(l&&f.cc===l.cc),a=!(l&&h.level===l.level),d=l?h.sn-l.sn:-1,ft=this.part?h.part-this.part.index:1,v=!a&&(1===d||0===d&&1===ft),et=self.performance.now();(a||d||0===f.stats.parsing.start)&&(f.stats.parsing.start=et);e&&(ft||!v)&&(e.stats.parsing.start=et);y=!(l&&(null===(w=f.initSegment)||void 0===w?void 0:w.url)===(null===(b=l.initSegment)||void 0===b?void 0:b.url));g=new it.b(k,v,s,a,rt,y);(!v||k||y)&&(u.b.log("[transmuxer-interface, "+f.type+"]: Starting new transmux session for sn: "+h.sn+" p: "+h.part+" level: "+h.level+" id: "+h.id+"\n        discontinuity: "+k+"\n        trackSwitch: "+a+"\n        contiguous: "+v+"\n        accurateTimeOffset: "+s+"\n        timeOffset: "+rt+"\n        initSegmentChange: "+y),ot=new it.a(i,r,t,o,c),this.configureTransmuxer(ot));(this.frag=f,this.part=e,tt)?tt.postMessage({cmd:"demux",data:n,decryptdata:ut,chunkMeta:h,state:g},n instanceof ArrayBuffer?[n]:[]):nt&&(p=nt.push(n,ut,h,g),Object(it.d)(p)?p.then(function(n){st.handleTransmuxComplete(n)}):this.handleTransmuxComplete(p))},n.flush=function(n){var u=this,i,r,t;n.transmuxing.start=self.performance.now();i=this.transmuxer;r=this.worker;r?r.postMessage({cmd:"flush",chunkMeta:n}):i&&(t=i.flush(n),Object(it.d)(t)?t.then(function(t){u.handleFlushResult(t,n)}):this.handleFlushResult(t,n))},n.handleFlushResult=function(n,t){var i=this;n.forEach(function(n){i.handleTransmuxComplete(n)});this.onFlush(t)},n.onWorkerMessage=function(n){var t=n.data,i=this.hls;switch(t.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;default:t.data=t.data||{};t.data.frag=this.frag;t.data.id=this.id;i.trigger(t.event,t.data)}},n.configureTransmuxer=function(n){var t=this.worker,i=this.transmuxer;t?t.postMessage({cmd:"configure",config:n}):i&&i.configure(n)},n.handleTransmuxComplete=function(n){n.chunkMeta.transmuxing.end=self.performance.now();this.onTransmuxComplete(n)},t}(),rh=function(){function t(n,t,i,r){this.config=void 0;this.media=void 0;this.fragmentTracker=void 0;this.hls=void 0;this.nudgeRetry=0;this.stallReported=!1;this.stalled=null;this.moved=!1;this.seeking=!1;this.config=n;this.media=t;this.fragmentTracker=i;this.hls=r}var n=t.prototype;return n.destroy=function(){this.hls=this.fragmentTracker=this.media=null},n.poll=function(n){var k=this.config,t=this.media,e=this.stalled,i=t.currentTime,r=t.seeking,d=this.seeking&&!r,g=!this.seeking&&r,v,y,l,a,w,b;if(this.seeking=r,i===n){if((g||d)&&(this.stalled=null),!t.paused&&!t.ended&&0!==t.playbackRate&&c.getBuffered(t).length){var f=c.bufferInfo(t,i,0),nt=f.len>0,o=f.nextStart||0;if(nt||o){if(r){if(v=f.len>2,y=!o||o-i>2&&!this.fragmentTracker.getPartialFragment(i),v||y)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var s,p=Math.max(o,f.start||0)-i,h=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,tt=(null==h||null===(s=h.details)||void 0===s?void 0:s.live)?2*h.details.targetduration:2;if(p>0&&p<=tt)return void this._trySkipBufferHole(null)}l=self.performance.now();null!==e?(a=l-e,!r&&a>=250&&this._reportStall(f.len),w=c.bufferInfo(t,i,k.maxBufferHole),this._tryFixBufferStall(w,a)):this.stalled=l}}}else(this.moved=!0,null!==e)&&(this.stallReported&&(b=self.performance.now()-e,u.b.warn("playback not stuck anymore @"+i+", after "+Math.round(b)+"ms"),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0)},n._tryFixBufferStall=function(n,t){var i=this.config,f=this.fragmentTracker,e=this.media.currentTime,r=f.getPartialFragment(e);r&&this._trySkipBufferHole(r)||n.len>i.maxBufferHole&&t>1e3*i.highBufferWatchdogPeriod&&(u.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},n._reportStall=function(n){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,u.b.warn("Playback stalling at @"+i.currentTime+" due to low buffer (buffer="+n+")"),t.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:n}))},n._trySkipBufferHole=function(n){for(var h,t,a=this.config,v=this.hls,i=this.media,e=i.currentTime,l=0,s=c.getBuffered(i),o=0;o<s.length;o++){if(h=s.start(o),e+a.maxBufferHole>=l&&e<h)return t=Math.max(h+.05,i.currentTime+.1),u.b.warn("skipping hole, adjusting currentTime from "+e+" to "+t),this.moved=!0,this.stalled=null,i.currentTime=t,n&&v.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+e+" to "+t,frag:n}),t;l=s.end(o)}return 0},n._tryNudgeBuffer=function(){var n=this.config,o=this.hls,s=this.media,t=s.currentTime,i=(this.nudgeRetry||0)+1,e;(this.nudgeRetry=i,i<n.nudgeMaxRetry)?(e=t+i*n.nudgeOffset,u.b.warn("Nudging 'currentTime' from "+t+" to "+e),s.currentTime=e,o.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_NUDGE_ON_STALL,fatal:!1})):(u.b.error("Playhead still not moving while enough data buffered @"+t+" after "+n.nudgeMaxRetry+" nudges"),o.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_STALLED_ERROR,fatal:!0}))},t}();var uh=function(n){function s(t,i){var r;return(r=n.call(this,t,i,"[stream-controller]")||this).audioCodecSwap=!1,r.gapController=null,r.level=-1,r._forceStartLoad=!1,r.altAudio=!1,r.audioOnly=!1,r.fragPlaying=null,r.onvplaying=null,r.onvseeked=null,r.fragLastKbps=0,r.stalled=!1,r.couldBacktrack=!1,r.audioCodecSwitch=!1,r.videoBuffer=null,r._registerListeners(),r}var i,v,y,w,k,t;return v=n,(i=s).prototype=Object.create(v.prototype),i.prototype.constructor=i,af(i,v),t=s.prototype,t._registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.on(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.on(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.on(r.a.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this);n.on(r.a.ERROR,this.onError,this);n.on(r.a.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);n.on(r.a.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);n.on(r.a.BUFFER_CREATED,this.onBufferCreated,this);n.on(r.a.BUFFER_FLUSHED,this.onBufferFlushed,this);n.on(r.a.LEVELS_UPDATED,this.onLevelsUpdated,this);n.on(r.a.FRAG_BUFFERED,this.onFragBuffered,this)},t._unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.off(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.off(r.a.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this);n.off(r.a.ERROR,this.onError,this);n.off(r.a.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);n.off(r.a.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);n.off(r.a.BUFFER_CREATED,this.onBufferCreated,this);n.off(r.a.BUFFER_FLUSHED,this.onBufferFlushed,this);n.off(r.a.LEVELS_UPDATED,this.onLevelsUpdated,this);n.off(r.a.FRAG_BUFFERED,this.onFragBuffered,this)},t.onHandlerDestroying=function(){this._unregisterListeners();this.onMediaDetaching()},t.startLoad=function(n){var r,t,i;this.levels?(r=this.lastCurrentTime,t=this.hls,(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,this.startFragRequested)||(i=t.startLevel,-1===i&&(t.config.testBandwidth?(i=0,this.bitrateTest=!0):i=t.nextAutoLevel),this.level=t.nextLoadLevel=i,this.loadedmetadata=!1),r>0&&-1===n&&(this.log("Override startPosition with lastCurrentTime @"+r.toFixed(3)),n=r),this.state=h,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()):(this._forceStartLoad=!0,this.state=b)},t.stopLoad=function(){this._forceStartLoad=!1;n.prototype.stopLoad.call(this)},t.doTick=function(){var i,f,r;switch(this.state){case h:this.doTickIdle();break;case tt:var n,u=this.levels,e=this.level,t=null==u||null===(n=u[e])||void 0===n?void 0:n.details;if(t&&(!t.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(t))break;this.state=h;break}break;case yt:f=self.performance.now();r=this.retryDate;(!r||f>=r||null!==(i=this.media)&&void 0!==i&&i.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=h)}this.onTickEnd()},t.onTickEnd=function(){n.prototype.onTickEnd.call(this);this.checkBuffer();this.checkFragmentChanged()},t.doTickIdle=function(){var o,s,h=this.hls,k=this.levelLastLoaded,c=this.levels,v=this.media,d=h.config,u=h.nextLoadLevel,y,t,i,p,f,n,w,b;if(null!==k&&(v||!this.startFragRequested&&d.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&c&&c[u])if(y=c[u],this.level=h.nextLoadLevel=u,t=y.details,!t||this.state===tt||t.live&&this.levelLastLoaded!==u)this.state=tt;else if(i=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:v,e.b.MAIN),null!==i&&!(i.len>=this.getMaxBufferLength(y.maxBitrate))){if(this._streamEnded(i,t))return p={},this.altAudio&&(p.type="video"),this.hls.trigger(r.a.BUFFER_EOS,p),void(this.state=bt);f=i.end;n=this.getNextFragment(f,t);this.couldBacktrack&&!this.fragPrevious&&n&&"initSegment"!==n.sn&&(w=n.sn-t.startSN,w>1&&(n=t.fragments[w-1],this.fragmentTracker.removeFragment(n)));n&&this.fragmentTracker.getState(n)===l.OK&&this.nextLoadPosition>f&&(b=this.audioOnly&&!this.altAudio?a.a.AUDIO:a.a.VIDEO,this.afterBufferFlushed(v,b,e.b.MAIN),n=this.getNextFragment(this.nextLoadPosition,t));n&&(!n.initSegment||n.initSegment.data||this.bitrateTest||(n=n.initSegment),"identity"!==(null===(o=n.decryptdata)||void 0===o?void 0:o.keyFormat)||null!==(s=n.decryptdata)&&void 0!==s&&s.key?this.loadFragment(n,t,f):this.loadKey(n,t))}},t.loadFragment=function(t,i,r){var e,u=this.fragmentTracker.getState(t),f;if(this.fragCurrent=t,u===l.BACKTRACKED){if(f=this.fragmentTracker.getBacktrackData(t),f)return this._handleFragmentLoadProgress(f),void this._handleFragmentLoadComplete(f);u=l.NOT_LOADED}u===l.NOT_LOADED||u===l.PARTIAL?"initSegment"===t.sn?this._loadInitSegment(t):this.bitrateTest?(t.bitrateTest=!0,this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t)):(this.startFragRequested=!0,n.prototype.loadFragment.call(this,t,i,r)):u===l.APPENDING?this.reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t):0===(null===(e=this.media)||void 0===e?void 0:e.buffered.length)&&this.fragmentTracker.removeAllFragments()},t.getAppendedFrag=function(n){var t=this.fragmentTracker.getAppendedFrag(n,e.b.MAIN);return t&&"fragment"in t?t.fragment:t},t.getBufferedFrag=function(n){return this.fragmentTracker.getBufferedFrag(n,e.b.MAIN)},t.followingBufferedFrag=function(n){return n?this.getBufferedFrag(n.end+.5):null},t.immediateLevelSwitch=function(){this.abortCurrentFrag();this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.nextLevelSwitch=function(){var o=this.levels,t=this.media,u,i,s,f,r,n;if(null!=t&&t.readyState&&(i=this.getAppendedFrag(t.currentTime),(i&&i.start>1&&this.flushMainBuffer(0,i.start-1),!t.paused&&o)?(s=o[this.hls.nextLoadLevel],f=this.fragLastKbps,u=f&&this.fragCurrent?this.fragCurrent.duration*s.maxBitrate/(1e3*f)+1:0):u=0,r=this.getBufferedFrag(t.currentTime+u),r&&(n=this.followingBufferedFrag(r),n))){this.abortCurrentFrag();var h=n.maxStartPTS?n.maxStartPTS:n.start,e=n.duration,c=Math.max(r.end,h+Math.min(Math.max(e-this.config.maxFragLookUpTolerance,.5*e),.75*e));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}},t.abortCurrentFrag=function(){var n=this.fragCurrent;this.fragCurrent=null;null!=n&&n.loader&&n.loader.abort();this.state===vi&&(this.state=h);this.nextLoadPosition=this.getLoadPosition()},t.flushMainBuffer=function(t,i){n.prototype.flushMainBuffer.call(this,t,i,this.altAudio?"video":null)},t.onMediaAttached=function(t,i){n.prototype.onMediaAttached.call(this,t,i);var r=i.media;this.onvplaying=this.onMediaPlaying.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);r.addEventListener("playing",this.onvplaying);r.addEventListener("seeked",this.onvseeked);this.gapController=new rh(this.config,r,this.fragmentTracker,this.hls)},t.onMediaDetaching=function(){var t=this.media;t&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null);this.fragPlaying=null;this.gapController&&(this.gapController.destroy(),this.gapController=null);n.prototype.onMediaDetaching.call(this)},t.onMediaPlaying=function(){this.tick()},t.onMediaSeeked=function(){var n=this.media,t=n?n.currentTime:null;Object(o.a)(t)&&this.log("Media seeked to "+t.toFixed(3));this.tick()},t.onManifestLoading=function(){this.log("Trigger BUFFER_RESET");this.hls.trigger(r.a.BUFFER_RESET,void 0);this.fragmentTracker.removeAllFragments();this.couldBacktrack=this.stalled=!1;this.startPosition=this.lastCurrentTime=0;this.fragPlaying=null},t.onManifestParsed=function(n,t){var i,r,u,f=!1,e=!1;t.levels.forEach(function(n){(i=n.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(f=!0),-1!==i.indexOf("mp4a.40.5")&&(e=!0))});this.audioCodecSwitch=f&&e&&!("function"==typeof(null==(u=sf())||null===(r=u.prototype)||void 0===r?void 0:r.changeType));this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=t.levels;this.startFragRequested=!1},t.onLevelLoading=function(n,t){var r=this.levels,i;r&&this.state===h&&(i=r[t.level],(!i.details||i.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(i.details))&&(this.state=tt))},t.onLevelLoaded=function(n,t){var o,c=this.levels,u=t.level,i=t.details,l=i.totalduration,f,e,s;if(c){if(this.log("Level "+u+" loaded ["+i.startSN+","+i.endSN+"], cc ["+i.startCC+", "+i.endCC+"] duration:"+l),f=this.fragCurrent,f&&(this.state===ot||this.state===yt)&&f.level!==t.level&&f.loader&&(this.state=h,f.loader.abort()),e=c[u],s=0,i.live||null!==(o=e.details)&&void 0!==o&&o.live){if(i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed)return;s=this.alignPlaylists(i,e.details)}if(e.details=i,this.levelLastLoaded=u,this.hls.trigger(r.a.LEVEL_UPDATED,{details:i,level:u}),this.state===tt){if(this.waitForCdnTuneIn(i))return;this.state=h}this.startFragRequested?i.live&&this.synchronizeToLiveEdge(i):this.setStartPosition(i,s);this.tick()}else this.warn("Levels were reset while loading level "+u)},t._handleFragmentLoadProgress=function(n){var u,t=n.frag,f=n.part,o=n.payload,s=this.levels,r,i;if(s)if(r=s[t.level],i=r.details,i){var c=r.videoCodec,l=i.PTSKnown||!i.live,a=null===(u=t.initSegment)||void 0===u?void 0:u.data,v=this._getAudioCodec(r),y=this.transmuxer=this.transmuxer||new cf(this.hls,e.b.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=f?f.index:-1,p=-1!==h,w=new si(t.level,t.sn,t.stats.chunkCount,o.byteLength,h,p),b=this.initPTS[t.cc];y.push(o,a,v,c,t,f,i.totalduration,l,w,b)}else this.warn("Dropping fragment "+t.sn+" of level "+t.level+" after level details were reset");else this.warn("Levels were reset while fragment load was in progress. Fragment "+t.sn+" of level "+t.level+" will not be buffered")},t.onAudioTrackSwitching=function(n,t){var f=this.altAudio,e=!!t.url,o=t.id,i,u;e||(this.mediaBuffer!==this.media?(this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,i=this.fragCurrent,null!=i&&i.loader&&(this.log("Switching to main audio track, cancel main fragment load"),i.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()):this.audioOnly&&this.resetTransmuxer(),u=this.hls,f&&u.trigger(r.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u.trigger(r.a.AUDIO_TRACK_SWITCHED,{id:o}))},t.onAudioTrackSwitched=function(n,t){var u=t.id,r=!!this.hls.audioTracks[u].url,i;r&&(i=this.videoBuffer,i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i));this.altAudio=r;this.tick()},t.onBufferCreated=function(n,t){var r,o,u=t.tracks,s=!1,i,f,e;for(i in u)f=u[i],"main"===f.id?(o=i,r=f,"video"===i)&&(e=u[i],e&&(this.videoBuffer=e.buffer)):s=!0;s&&r?(this.log("Alternate track found, use "+o+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},t.onFragBuffered=function(n,t){var i=t.frag,r=t.part,u;if(!i||i.type===e.b.MAIN){if(this.fragContextChanged(i))return this.warn("Fragment "+i.sn+(r?" p: "+r.index:"")+" of level "+i.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===wt&&(this.state=h));u=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first));"initSegment"!==i.sn&&(this.fragPrevious=i);this.fragBufferedComplete(i,r)}},t.onError=function(n,t){switch(t.details){case f.a.FRAG_LOAD_ERROR:case f.a.FRAG_LOAD_TIMEOUT:case f.a.KEY_LOAD_ERROR:case f.a.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(e.b.MAIN,t);break;case f.a.LEVEL_LOAD_ERROR:case f.a.LEVEL_LOAD_TIMEOUT:this.state!==st&&(t.fatal?(this.warn(""+t.details),this.state=st):t.levelRetry||this.state!==tt||(this.state=h));break;case f.a.BUFFER_FULL_ERROR:if("main"===t.parent&&(this.state===p||this.state===wt)){var r=!0,i=this.getFwdBufferInfo(this.media,e.b.MAIN);i&&i.len>.5&&(r=!this.reduceMaxBufferLength(i.len));r&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch());this.resetLoadingState()}}},t.checkBuffer=function(){var n=this.media,t=this.gapController,i;n&&t&&n.readyState&&(i=c.getBuffered(n),!this.loadedmetadata&&i.length?(this.loadedmetadata=!0,this.seekToStartPos()):t.poll(this.lastCurrentTime),this.lastCurrentTime=n.currentTime)},t.onFragLoadEmergencyAborted=function(){this.state=h;this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tickImmediate()},t.onBufferFlushed=function(n,t){var i=t.type,r;(i!==a.a.AUDIO||this.audioOnly&&!this.altAudio)&&(r=(i===a.a.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media,this.afterBufferFlushed(r,i,e.b.MAIN))},t.onLevelsUpdated=function(n,t){this.levels=t.levels},t.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},t.seekToStartPos=function(){var i=this.media,r=i.currentTime,n=this.startPosition,f,t;if(n>=0&&r<n){if(i.seeking)return void u.b.log("could not seek to "+n+", already seeking at "+r);f=c.getBuffered(i);t=(f.length?f.start(0):0)-n;t>0&&(t<this.config.maxBufferHole||t<this.config.maxFragLookUpTolerance)&&(u.b.log("adjusting start position by "+t+" to match buffer start"),n+=t,this.startPosition=n);this.log("seek to target start position "+n+" from current time "+r);i.currentTime=n}},t._getAudioCodec=function(n){var t=this.config.defaultAudioCodec||n.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},t._loadBitrateTestFrag=function(n){var t=this;this._doFragLoad(n).then(function(i){var f=t.hls,u;!i||f.nextLoadLevel||t.fragContextChanged(n)||(t.fragLoadError=0,t.state=h,t.startFragRequested=!1,t.bitrateTest=!1,u=n.stats,u.parsing.start=u.parsing.end=u.buffering.start=u.buffering.end=self.performance.now(),f.trigger(r.a.FRAG_LOADED,i))})},t._handleTransmuxComplete=function(n){var w,c="main",l=this.hls,u=n.remuxResult,f=n.chunkMeta,v=this.getCurrentContext(f),y,it,st,ht;if(!v)return this.warn("The loading context changed while buffering fragment "+f.sn+" of level "+f.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(f.level);var t=v.frag,e=v.part,nt=v.level,i=u.video,tt=u.text,b=u.id3,s=u.initSegment,h=this.altAudio?void 0:u.audio;if(!this.fragContextChanged(t)){if((this.state=p,s)&&(s.tracks&&(this._bufferInitSegment(nt,s.tracks,t,f),l.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:c,tracks:s.tracks})),y=s.initPTS,it=s.timescale,Object(o.a)(y)&&(this.initPTS[t.cc]=y,l.trigger(r.a.INIT_PTS_FOUND,{frag:t,id:c,initPTS:y,timescale:it}))),i&&!1!==u.independent){if(nt.details){var k=i.startPTS,d=i.endPTS,rt=i.startDTS,g=i.endDTS;if(e)e.elementaryStreams[i.type]={startPTS:k,endPTS:d,startDTS:rt,endDTS:g};else if(i.firstKeyFrame&&i.independent&&(this.couldBacktrack=!0),i.dropped&&i.independent){if(this.getLoadPosition()+this.config.maxBufferHole<k)return void this.backtrack(t);t.setElementaryStreamInfo(i.type,t.start,d,t.start,g,!0)}t.setElementaryStreamInfo(i.type,k,d,rt,g);this.bufferFragmentData(i,t,e,f)}}else if(!1===u.independent)return void this.backtrack(t);if(h){var ut=h.startPTS,ft=h.endPTS,et=h.startDTS,ot=h.endDTS;e&&(e.elementaryStreams[a.a.AUDIO]={startPTS:ut,endPTS:ft,startDTS:et,endDTS:ot});t.setElementaryStreamInfo(a.a.AUDIO,ut,ft,et,ot);this.bufferFragmentData(h,t,e,f)}null!=b&&null!==(w=b.samples)&&void 0!==w&&w.length&&(st={frag:t,id:c,samples:b.samples},l.trigger(r.a.FRAG_PARSING_METADATA,st));tt&&(ht={frag:t,id:c,samples:tt.samples},l.trigger(r.a.FRAG_PARSING_USERDATA,ht))}},t._bufferInitSegment=function(n,t,i,u){var c=this,f,h;if(this.state===p){this.audioOnly=!!t.audio&&!t.video;this.altAudio&&!this.audioOnly&&delete t.audio;var e=t.audio,o=t.video,s=t.audiovideo;e&&(f=n.audioCodec,h=navigator.userAgent.toLowerCase(),this.audioCodecSwitch&&(f&&(f=-1!==f.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==e.metadata.channelCount&&-1===h.indexOf("firefox")&&(f="mp4a.40.5")),-1!==h.indexOf("android")&&"audio/mpeg"!==e.container&&(f="mp4a.40.2",this.log("Android: force audio codec to "+f)),n.audioCodec&&n.audioCodec!==f&&this.log('Swapping manifest audio codec "'+n.audioCodec+'" for "'+f+'"'),e.levelCodec=f,e.id="main",this.log("Init audio buffer, container:"+e.container+", codecs[selected/level/parsed]=["+(f||"")+"/"+(n.audioCodec||"")+"/"+e.codec+"]"));o&&(o.levelCodec=n.videoCodec,o.id="main",this.log("Init video buffer, container:"+o.container+", codecs[level/parsed]=["+(n.videoCodec||"")+"/"+o.codec+"]"));s&&this.log("Init audiovideo buffer, container:"+s.container+", codecs[level/parsed]=["+(n.attrs.CODECS||"")+"/"+s.codec+"]");this.hls.trigger(r.a.BUFFER_CODECS,t);Object.keys(t).forEach(function(n){var f=t[n].initSegment;null!=f&&f.byteLength&&c.hls.trigger(r.a.BUFFER_APPENDING,{type:n,data:f,frag:i,part:null,chunkMeta:u,parent:i.type})});this.tick()}},t.backtrack=function(n){this.couldBacktrack=!0;this.resetTransmuxer();this.flushBufferGap(n);var t=this.fragmentTracker.backtrack(n);this.fragPrevious=null;this.nextLoadPosition=n.start;t?this.resetFragmentLoading(n):this.state=yi},t.checkFragmentChanged=function(){var i=this.media,n=null,u,t,f;i&&i.readyState>1&&!1===i.seeking&&(u=i.currentTime,(c.isBuffered(i,u)?n=this.getAppendedFrag(u):c.isBuffered(i,u+.1)&&(n=this.getAppendedFrag(u+.1)),n)&&(t=this.fragPlaying,f=n.level,t&&n.sn===t.sn&&t.level===f&&n.urlId===t.urlId||(this.hls.trigger(r.a.FRAG_CHANGED,{frag:n}),t&&t.level===f||this.hls.trigger(r.a.LEVEL_SWITCHED,{level:f}),this.fragPlaying=n)))},y=s,(w=[{key:"nextLevel",get:function(){var n=this.nextBufferedFrag;return n?n.level:-1}},{key:"currentLevel",get:function(){var t=this.media,n;return t&&(n=this.getAppendedFrag(t.currentTime),n)?n.level:-1}},{key:"nextBufferedFrag",get:function(){var n=this.media,t;return n?(t=this.getAppendedFrag(n.currentTime),this.followingBufferedFrag(t)):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&lf(y.prototype,w),k&&lf(y,k),s}(pi),kt=function(){function t(n,t,i){void 0===t&&(t=0);void 0===i&&(i=0);this.halfLife=void 0;this.alpha_=void 0;this.estimate_=void 0;this.totalWeight_=void 0;this.halfLife=n;this.alpha_=n?Math.exp(Math.log(.5)/n):0;this.estimate_=t;this.totalWeight_=i}var n=t.prototype;return n.sample=function(n,t){var i=Math.pow(this.alpha_,n);this.estimate_=t*(1-i)+i*this.estimate_;this.totalWeight_+=n},n.getTotalWeight=function(){return this.totalWeight_},n.getEstimate=function(){if(this.alpha_){var n=1-Math.pow(this.alpha_,this.totalWeight_);if(n)return this.estimate_/n}return this.estimate_},t}(),fh=function(){function t(n,t,i){this.defaultEstimate_=void 0;this.minWeight_=void 0;this.minDelayMs_=void 0;this.slow_=void 0;this.fast_=void 0;this.defaultEstimate_=i;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new kt(n);this.fast_=new kt(t)}var n=t.prototype;return n.update=function(n,t){var i=this.slow_,r=this.fast_;this.slow_.halfLife!==n&&(this.slow_=new kt(n,i.getEstimate(),i.getTotalWeight()));this.fast_.halfLife!==t&&(this.fast_=new kt(t,r.getEstimate(),r.getTotalWeight()))},n.sample=function(n,t){var i=(n=Math.max(n,this.minDelayMs_))/1e3,r=8*t/i;this.fast_.sample(i,r);this.slow_.sample(i,r)},n.canEstimate=function(){var n=this.fast_;return n&&n.getTotalWeight()>=this.minWeight_},n.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},n.destroy=function(){},t}();yf=function(){function t(n){this.hls=void 0;this.lastLoadedFragLevel=0;this._nextAutoLevel=-1;this.timer=void 0;this.onCheck=this._abandonRulesCheck.bind(this);this.fragCurrent=null;this.partCurrent=null;this.bitrateTestDelay=0;this.bwEstimator=void 0;this.hls=n;var t=n.config;this.bwEstimator=new fh(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate);this.registerListeners()}var i,s,h,n=t.prototype;return n.registerListeners=function(){var n=this.hls;n.on(r.a.FRAG_LOADING,this.onFragLoading,this);n.on(r.a.FRAG_LOADED,this.onFragLoaded,this);n.on(r.a.FRAG_BUFFERED,this.onFragBuffered,this);n.on(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.on(r.a.ERROR,this.onError,this)},n.unregisterListeners=function(){var n=this.hls;n.off(r.a.FRAG_LOADING,this.onFragLoading,this);n.off(r.a.FRAG_LOADED,this.onFragLoaded,this);n.off(r.a.FRAG_BUFFERED,this.onFragBuffered,this);n.off(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.off(r.a.ERROR,this.onError,this)},n.destroy=function(){this.unregisterListeners();this.clearTimer();this.hls=this.onCheck=null;this.fragCurrent=this.partCurrent=null},n.onFragLoading=function(n,t){var i,r=t.frag;r.type===e.b.MAIN&&(this.timer||(this.fragCurrent=r,this.partCurrent=null!=(i=t.part)?i:null,this.timer=self.setInterval(this.onCheck,100)))},n.onLevelLoaded=function(n,t){var i=this.hls.config;t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)},n._abandonRulesCheck=function(){var t=this.fragCurrent,i=this.partCurrent,f=this.hls,g=f.autoLevelEnabled,nt=f.config,e=f.media,n,h,l,a,s,y,w;if(t&&e){if(n=i?i.stats:t.stats,h=i?i.duration:t.duration,n.aborted)return u.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(g&&!e.paused&&e.playbackRate&&e.readyState&&(l=performance.now()-n.loading.start,a=Math.abs(e.playbackRate),!(l<=500*h/a))){var b=f.levels,tt=f.minAutoLevel,it=b[t.level],rt=n.total||Math.max(n.loaded,Math.round(h*it.maxBitrate/8)),k=Math.max(1,n.bwEstimate?n.bwEstimate/8:1e3*n.loaded/l),p=(rt-n.loaded)/k,d=e.currentTime,v=(c.bufferInfo(e,d,nt.maxBufferHole).end-d)/a;if(!(v>=2*h/a||p<=v)){for(y=Number.POSITIVE_INFINITY,s=t.level-1;s>tt;s--)if((y=h*b[s].maxBitrate/(6.4*k))<v)break;y>=p||(w=this.bwEstimator.getEstimate(),u.b.warn("Fragment "+t.sn+(i?" part "+i.index:"")+" of level "+t.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+s+"\n      Current BW estimate: "+(Object(o.a)(w)?(w/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+p.toFixed(3)+" s\n      Estimated load time for the next fragment: "+y.toFixed(3)+" s\n      Time to underbuffer: "+v.toFixed(3)+" s"),f.nextLoadLevel=s,this.bwEstimator.sample(l,n.loaded),this.clearTimer(),t.loader&&(this.fragCurrent=this.partCurrent=null,t.loader.abort()),f.trigger(r.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:i,stats:n}))}}}},n.onFragLoaded=function(n,t){var i=t.frag,f=t.part,s,h,a;if(i.type===e.b.MAIN&&Object(o.a)(i.sn)){if(s=f?f.stats:i.stats,h=f?f.duration:i.duration,this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var u=this.hls.levels[i.level],c=(u.loaded?u.loaded.bytes:0)+s.loaded,l=(u.loaded?u.loaded.duration:0)+h;u.loaded={bytes:c,duration:l};u.realBitrate=Math.round(8*c/l)}i.bitrateTest&&(a={stats:s,frag:i,part:f,id:i.type},this.onFragBuffered(r.a.FRAG_BUFFERED,a),i.bitrateTest=!1)}},n.onFragBuffered=function(n,t){var r=t.frag,f=t.part,i=f?f.stats:r.stats,u;i.aborted||r.type!==e.b.MAIN||"initSegment"===r.sn||(u=i.parsing.end-i.loading.start,this.bwEstimator.sample(u,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),this.bitrateTestDelay=r.bitrateTest?u/1e3:0)},n.onError=function(n,t){switch(t.details){case f.a.FRAG_LOAD_ERROR:case f.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},n.clearTimer=function(){self.clearInterval(this.timer);this.timer=void 0},n.getNextABRAutoLevel=function(){var h=this.fragCurrent,l=this.partCurrent,i=this.hls,a=i.maxAutoLevel,n=i.config,v=i.minAutoLevel,t=i.media,r=l?l.duration:h?h.duration:0,y=t?t.currentTime:0,k=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,p=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,f=(c.bufferInfo(t,y,n.maxBufferHole).end-y)/k,e=this.findBestLevel(p,v,a,f,n.abrBandWidthFactor,n.abrBandWidthUpFactor),o;if(e>=0)return e;u.b.trace((f?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var s=r?Math.min(r,n.maxStarvationDelay):n.maxStarvationDelay,w=n.abrBandWidthFactor,b=n.abrBandWidthUpFactor;return f||(o=this.bitrateTestDelay,o&&(s=(r?Math.min(r,n.maxLoadingDelay):n.maxLoadingDelay)-o,u.b.trace("bitrate test took "+Math.round(1e3*o)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*s)+" ms"),w=b=1)),e=this.findBestLevel(p,v,a,f+s,w,b),Math.max(e,0)},n.findBestLevel=function(n,t,i,r,f,e){for(var h,a,v,y,b=this.fragCurrent,p=this.partCurrent,k=this.lastLoadedFragLevel,w=this.hls.levels,s=w[k],nt=!(null==s||null===(y=s.details)||void 0===y||!y.live),d=null==s?void 0:s.codecSet,tt=p?p.duration:b?b.duration:0,o=i;o>=t;o--)if(h=w[o],h&&(!d||h.codecSet===d)){var c=h.details,g=(p?null==c?void 0:c.partTarget:null==c?void 0:c.averagetargetduration)||tt,l=void 0;if(l=o<=k?f*n:e*n,a=w[o].maxBitrate,v=a*g/l,u.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+o+"/"+Math.round(l)+"/"+a+"/"+g+"/"+r+"/"+v),l>a&&(!v||nt&&!this.bitrateTestDelay||v<r))return o}return-1},i=t,(s=[{key:"nextAutoLevel",get:function(){var n=this._nextAutoLevel,i=this.bwEstimator,t;return(-1===n||i&&i.canEstimate())?(t=this.getNextABRAutoLevel(),-1!==n&&(t=Math.min(n,t)),t):n},set:function(n){this._nextAutoLevel=n}}])&&vf(i.prototype,s),h&&vf(i,h),t}();ki=i(13);wf=function(n){function v(t,i){var r;return(r=n.call(this,t,i,"[audio-stream-controller]")||this).videoBuffer=null,r.videoTrackCC=-1,r.waitingVideoCC=-1,r.audioSwitch=!1,r.trackId=-1,r.waitingData=null,r.mainDetails=null,r.bufferFlushed=!1,r._registerListeners(),r}var i,s,t;return s=n,(i=v).prototype=Object.create(s.prototype),i.prototype.constructor=i,pf(i,s),t=v.prototype,t.onHandlerDestroying=function(){this._unregisterListeners();this.mainDetails=null},t._registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.on(r.a.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this);n.on(r.a.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);n.on(r.a.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);n.on(r.a.ERROR,this.onError,this);n.on(r.a.BUFFER_RESET,this.onBufferReset,this);n.on(r.a.BUFFER_CREATED,this.onBufferCreated,this);n.on(r.a.BUFFER_FLUSHED,this.onBufferFlushed,this);n.on(r.a.INIT_PTS_FOUND,this.onInitPtsFound,this);n.on(r.a.FRAG_BUFFERED,this.onFragBuffered,this)},t._unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.off(r.a.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this);n.off(r.a.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);n.off(r.a.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);n.off(r.a.ERROR,this.onError,this);n.off(r.a.BUFFER_RESET,this.onBufferReset,this);n.off(r.a.BUFFER_CREATED,this.onBufferCreated,this);n.off(r.a.BUFFER_FLUSHED,this.onBufferFlushed,this);n.off(r.a.INIT_PTS_FOUND,this.onInitPtsFound,this);n.off(r.a.FRAG_BUFFERED,this.onFragBuffered,this)},t.onInitPtsFound=function(n,t){var r=t.frag,f=t.id,u=t.initPTS,i;"main"===f&&(i=r.cc,this.initPTS[r.cc]=u,this.log("InitPTS for cc: "+i+" found from main: "+u),this.videoTrackCC=i,this.state===ht&&this.tick())},t.startLoad=function(n){if(!this.levels)return this.startPosition=n,void(this.state=b);var t=this.lastCurrentTime;this.stopLoad();this.setInterval(100);this.fragLoadError=0;t>0&&-1===n?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=h):(this.loadedmetadata=!1,this.state=pt);this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n;this.tick()},t.doTick=function(){var f,v,e,t,o,y,s;switch(this.state){case h:this.doTickIdle();break;case pt:var r,l=this.levels,p=this.trackId,a=null==l||null===(r=l[p])||void 0===r?void 0:r.details;if(a){if(this.waitForCdnTuneIn(a))break;this.state=ht}break;case yt:v=performance.now();e=this.retryDate;(!e||v>=e||null!==(f=this.media)&&void 0!==f&&f.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=h);break;case ht:if(t=this.waitingData,t){var i=t.frag,w=t.part,b=t.cache,k=t.complete;void 0!==this.initPTS[i.cc]?(this.waitingData=null,this.waitingVideoCC=-1,this.state=ot,o={frag:i,part:w,payload:b.flush(),networkDetails:null},this._handleFragmentLoadProgress(o),k&&n.prototype._handleFragmentLoadComplete.call(this,o)):this.videoTrackCC!==this.waitingVideoCC?(u.b.log("Waiting fragment cc ("+i.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment()):(y=this.getLoadPosition(),s=c.bufferInfo(this.mediaBuffer,y,this.config.maxBufferHole),li(s.end,this.config.maxFragLookUpTolerance,i)<0&&(u.b.log("Waiting fragment cc ("+i.cc+") @ "+i.start+" cancelled because another fragment at "+s.end+" is needed"),this.clearWaitingFragment()))}else this.state=h}this.onTickEnd()},t.clearWaitingFragment=function(){var n=this.waitingData;n&&(this.fragmentTracker.removeFragment(n.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=h)},t.onTickEnd=function(){var n=this.media,t;n&&n.readyState&&(t=(this.mediaBuffer?this.mediaBuffer:n).buffered,!this.loadedmetadata&&t.length&&(this.loadedmetadata=!0),this.lastCurrentTime=n.currentTime)},t.doTickIdle=function(){var o,s,y=this.hls,h=this.levels,p=this.media,c=this.trackId,w=y.config,n,t,u,f,v,i;if(h&&h[c]&&(p||!this.startFragRequested&&w.startFragPrefetch))if(n=h[c].details,!n||n.live&&this.levelLastLoaded!==c||this.waitForCdnTuneIn(n))this.state=pt;else if(this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,a.a.AUDIO,e.b.AUDIO)),t=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,e.b.AUDIO),null!==t){var b=t.len,k=this.getMaxBufferLength(),l=this.audioSwitch;if(!(b>=k)||l){if(!l&&this._streamEnded(t,n))return y.trigger(r.a.BUFFER_EOS,{type:"audio"}),void(this.state=bt);u=n.fragments[0].start;f=t.end;l&&(v=this.getLoadPosition(),f=v,n.PTSKnown&&v<u&&(t.end>u||t.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),p.currentTime=u+.05));i=this.getNextFragment(f,n);i?"identity"!==(null===(o=i.decryptdata)||void 0===o?void 0:o.keyFormat)||null!==(s=i.decryptdata)&&void 0!==s&&s.key?this.loadFragment(i,n,f):this.loadKey(i,n):this.bufferFlushed=!0}}},t.getMaxBufferLength=function(){var t=n.prototype.getMaxBufferLength.call(this),i=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,e.b.MAIN);return null===i?t:Math.max(t,i.len)},t.onMediaDetaching=function(){this.videoBuffer=null;n.prototype.onMediaDetaching.call(this)},t.onAudioTracksUpdated=function(n,t){var i=t.audioTracks;this.resetTransmuxer();this.levels=i.map(function(n){return new lt(n)})},t.onAudioTrackSwitching=function(n,t){var r=!!t.url,i;this.trackId=t.id;i=this.fragCurrent;null!=i&&i.loader&&i.loader.abort();this.fragCurrent=null;this.clearWaitingFragment();r?this.setInterval(100):this.resetTransmuxer();r?(this.audioSwitch=!0,this.state=h):this.state=b;this.tick()},t.onManifestLoading=function(){this.mainDetails=null;this.fragmentTracker.removeAllFragments();this.startPosition=this.lastCurrentTime=0;this.bufferFlushed=!1},t.onLevelLoaded=function(n,t){this.mainDetails=t.details},t.onAudioTrackLoaded=function(n,t){var o,s=this.levels,i=t.details,u=t.id,r,f,e;if(s){if(this.log("Track "+u+" loaded ["+i.startSN+","+i.endSN+"],duration:"+i.totalduration),r=s[u],f=0,i.live||null!==(o=r.details)&&void 0!==o&&o.live){if(e=this.mainDetails,i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed||!e)return;!r.details&&i.hasProgramDateTime&&e.hasProgramDateTime?(du(i,e),f=i.fragments[0].start):f=this.alignPlaylists(i,r.details)}r.details=i;this.levelLastLoaded=u;this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(r.details,f);this.state!==pt||this.waitForCdnTuneIn(i)||(this.state=h);this.tick()}else this.warn("Audio tracks were reset while loading level "+u)},t._handleFragmentLoadProgress=function(n){var r,t=n.frag,i=n.part,f=n.payload,p=this.config,c=this.trackId,l=this.levels,h,v;if(l){var a=l[c],o=a.details,w=p.defaultAudioCodec||a.audioCodec||"mp4a.40.2",s=this.transmuxer;if(s||(s=this.transmuxer=new cf(this.hls,e.b.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this))),h=this.initPTS[t.cc],v=null===(r=t.initSegment)||void 0===r?void 0:r.data,void 0!==h){var y=i?i.index:-1,b=-1!==y,k=new si(t.level,t.sn,t.stats.chunkCount,f.byteLength,y,b);s.push(f,v,w,"",t,i,o.totalduration,!1,k,h)}else u.b.log("Unknown video PTS for cc "+t.cc+", waiting for video PTS before demuxing audio frag "+t.sn+" of ["+o.startSN+" ,"+o.endSN+"],track "+c),(this.waitingData=this.waitingData||{frag:t,part:i,cache:new ki.a,complete:!1}).cache.push(new Uint8Array(f)),this.waitingVideoCC=this.videoTrackCC,this.state=ht}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+t.sn+" of level "+t.level+" will not be buffered")},t._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:n.prototype._handleFragmentLoadComplete.call(this,t)},t.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1},t.onBufferCreated=function(n,t){var i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer);t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},t.onFragBuffered=function(n,t){var i=t.frag,u=t.part;i.type===e.b.AUDIO&&(this.fragContextChanged(i)?this.warn("Fragment "+i.sn+(u?" p: "+u.index:"")+" of level "+i.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==i.sn&&(this.fragPrevious=i,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(r.a.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(i,u)))},t.onError=function(t,i){switch(i.details){case f.a.FRAG_LOAD_ERROR:case f.a.FRAG_LOAD_TIMEOUT:case f.a.KEY_LOAD_ERROR:case f.a.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(e.b.AUDIO,i);break;case f.a.AUDIO_TRACK_LOAD_ERROR:case f.a.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==st&&this.state!==b&&(this.state=i.fatal?st:h,this.warn(i.details+" while loading frag, switching to "+this.state+" state"));break;case f.a.BUFFER_FULL_ERROR:if("audio"===i.parent&&(this.state===p||this.state===wt)){var u=!0,r=this.getFwdBufferInfo(this.mediaBuffer,e.b.AUDIO);r&&r.len>.5&&(u=!this.reduceMaxBufferLength(r.len));u&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,n.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));this.resetLoadingState()}}},t.onBufferFlushed=function(n,t){t.type===a.a.AUDIO&&(this.bufferFlushed=!0)},t._handleTransmuxComplete=function(n){var o,s="audio",h=this.hls,f=n.remuxResult,u=n.chunkMeta,c=this.getCurrentContext(u),g,nt;if(!c)return this.warn("The loading context changed while buffering fragment "+u.sn+" of level "+u.level+". This chunk will not be buffered."),void this.resetLiveStartWhenNotLoaded(u.level);var t=c.frag,l=c.part,i=f.audio,y=f.text,v=f.id3,e=f.initSegment;if(!this.fragContextChanged(t)){if(this.state=p,this.audioSwitch&&i&&this.completeAudioSwitch(),null!=e&&e.tracks&&(this._bufferInitSegment(e.tracks,t,u),h.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,{frag:t,id:s,tracks:e.tracks})),i){var w=i.startPTS,b=i.endPTS,k=i.startDTS,d=i.endDTS;l&&(l.elementaryStreams[a.a.AUDIO]={startPTS:w,endPTS:b,startDTS:k,endDTS:d});t.setElementaryStreamInfo(a.a.AUDIO,w,b,k,d);this.bufferFragmentData(i,t,l,u)}null!=v&&null!==(o=v.samples)&&void 0!==o&&o.length&&(g=di({frag:t,id:s},v),h.trigger(r.a.FRAG_PARSING_METADATA,g));y&&(nt=di({frag:t,id:s},y),h.trigger(r.a.FRAG_PARSING_USERDATA,nt))}},t._bufferInitSegment=function(n,t,i){var u,f,e;this.state===p&&(n.video&&delete n.video,u=n.audio,u&&(u.levelCodec=u.codec,u.id="audio",this.log("Init audio buffer, container:"+u.container+", codecs[parsed]=["+u.codec+"]"),this.hls.trigger(r.a.BUFFER_CODECS,n),f=u.initSegment,null!=f&&f.byteLength&&(e={type:"audio",frag:t,part:null,chunkMeta:i,parent:t.type,data:f},this.hls.trigger(r.a.BUFFER_APPENDING,e)),this.tick()))},t.loadFragment=function(t,i,r){var u=this.fragmentTracker.getState(t);this.fragCurrent=t;(this.audioSwitch||u===l.NOT_LOADED||u===l.PARTIAL)&&("initSegment"===t.sn?this._loadInitSegment(t):i.live&&!Object(o.a)(this.initPTS[t.cc])?(this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=ht):(this.startFragRequested=!0,n.prototype.loadFragment.call(this,t,i,r)))},t.completeAudioSwitch=function(){var t=this.hls,i=this.media,u=this.trackId;i&&(this.log("Switching audio track : flushing all audio"),n.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));this.audioSwitch=!1;t.trigger(r.a.AUDIO_TRACK_SWITCHED,{id:u})},v}(pi);df=function(n){function u(t){var i;return(i=n.call(this,t,"[audio-track-controller]")||this).tracks=[],i.groupId=null,i.tracksInGroup=[],i.trackId=-1,i.trackName="",i.selectDefaultTrack=!0,i.registerListeners(),i}var i,o,s,h,c,t;return o=n,(i=u).prototype=Object.create(o.prototype),i.prototype.constructor=i,kf(i,o),t=u.prototype,t.registerListeners=function(){var n=this.hls;n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.on(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.on(r.a.LEVEL_SWITCHING,this.onLevelSwitching,this);n.on(r.a.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);n.on(r.a.ERROR,this.onError,this)},t.unregisterListeners=function(){var n=this.hls;n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.off(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.off(r.a.LEVEL_SWITCHING,this.onLevelSwitching,this);n.off(r.a.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);n.off(r.a.ERROR,this.onError,this)},t.destroy=function(){this.unregisterListeners();this.tracks.length=0;this.tracksInGroup.length=0;n.prototype.destroy.call(this)},t.onManifestLoading=function(){this.tracks=[];this.groupId=null;this.tracksInGroup=[];this.trackId=-1;this.trackName="";this.selectDefaultTrack=!0},t.onManifestParsed=function(n,t){this.tracks=t.audioTracks||[]},t.onAudioTrackLoaded=function(n,t){var i=t.id,u=t.details,r=this.tracksInGroup[i],f;r?(f=r.details,r.details=t.details,this.log("audioTrack "+i+" loaded ["+u.startSN+"-"+u.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,t,f))):this.warn("Invalid audio track id "+i)},t.onLevelLoading=function(n,t){this.switchLevel(t.level)},t.onLevelSwitching=function(n,t){this.switchLevel(t.level)},t.switchLevel=function(n){var u=this.hls.levels[n],t,i,f;null!=u&&u.audioGroupIds&&(t=u.audioGroupIds[u.urlId],this.groupId!==t&&(this.groupId=t,i=this.tracks.filter(function(n){return!t||n.groupId===t}),this.selectDefaultTrack&&!i.some(function(n){return n.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=i,f={audioTracks:i},this.log("Updating audio tracks, "+i.length+' track(s) found in "'+t+'" group-id'),this.hls.trigger(r.a.AUDIO_TRACKS_UPDATED,f),this.selectInitialTrack()))},t.onError=function(t,i){n.prototype.onError.call(this,t,i);!i.fatal&&i.context&&i.context.type===e.a.AUDIO_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.retryLoadingOrFail(i)},t.setAudioTrack=function(n){var i=this.tracksInGroup,u,o;if(n<0||n>=i.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();u=i[this.trackId];this.log("Now switching to audio-track index "+n);var t=i[n],s=t.id,f=t.groupId,h=void 0===f?"":f,e=t.name,c=t.type,l=t.url;(this.trackId=n,this.trackName=e,this.selectDefaultTrack=!1,this.hls.trigger(r.a.AUDIO_TRACK_SWITCHING,{id:s,groupId:h,name:e,type:c,url:l}),!t.details||t.details.live)&&(o=this.switchParams(t.url,null==u?void 0:u.details),this.loadPlaylist(o))}},t.selectInitialTrack=function(){this.tracksInGroup;var t=this.trackName,n=this.findTrackId(t)||this.findTrackId();-1!==n?this.setAudioTrack(n):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},t.findTrackId=function(n){for(var i,r=this.tracksInGroup,t=0;t<r.length;t++)if(i=r[t],(!this.selectDefaultTrack||i.default)&&(!n||n===i.name))return i.id;return-1},t.loadPlaylist=function(n){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var u=t.id,f=t.groupId,i=t.url;if(n)try{i=n.addDirectives(i)}catch(n){this.warn("Could not construct new URL with HLS Delivery Directives: "+n)}this.log("loading audio-track playlist for id: "+u);this.clearTimer();this.hls.trigger(r.a.AUDIO_TRACK_LOADING,{url:i,id:u,groupId:f,deliveryDirectives:n||null})}},s=u,(h=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(n){this.selectDefaultTrack=!1;this.setAudioTrack(n)}}])&&bf(s.prototype,h),c&&bf(s,c),u}(at);te=function(n){function u(t,i){var r;return(r=n.call(this,t,i,"[subtitle-stream-controller]")||this).levels=[],r.currentTrackId=-1,r.tracksBuffered=[],r.mainDetails=null,r._registerListeners(),r}var i,f,o,s,a,t;return f=n,(i=u).prototype=Object.create(f.prototype),i.prototype.constructor=i,ne(i,f),t=u.prototype,t.onHandlerDestroying=function(){this._unregisterListeners();this.mainDetails=null},t._registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.on(r.a.ERROR,this.onError,this);n.on(r.a.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);n.on(r.a.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this);n.on(r.a.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);n.on(r.a.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this);n.on(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this)},t._unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.LEVEL_LOADED,this.onLevelLoaded,this);n.off(r.a.ERROR,this.onError,this);n.off(r.a.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);n.off(r.a.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this);n.off(r.a.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);n.off(r.a.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this);n.off(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this)},t.startLoad=function(){this.stopLoad();this.state=h;this.setInterval(500);this.tick()},t.onManifestLoading=function(){this.mainDetails=null;this.fragmentTracker.removeAllFragments()},t.onLevelLoaded=function(n,t){this.mainDetails=t.details},t.onSubtitleFragProcessed=function(n,t){var u=t.frag,s=t.success,i,f,e,r,o;if((this.fragPrevious=u,this.state=h,s)&&(i=this.tracksBuffered[this.currentTrackId],i)){for(e=u.start,r=0;r<i.length;r++)if(e>=i[r].start&&e<=i[r].end){f=i[r];break}o=u.start+u.duration;f?f.end=o:(f={start:e,end:o},i.push(f));this.fragmentTracker.fragBuffered(u)}},t.onBufferFlushing=function(n,t){var f=t.startOffset,o=t.endOffset,u,r,i;if(0===f&&o!==Number.POSITIVE_INFINITY){if(u=this.currentTrackId,r=this.levels,!r.length||!r[u]||!r[u].details)return;if(i=o-r[u].details.targetduration,i<=0)return;t.endOffsetSubtitles=Math.max(0,i);this.tracksBuffered.forEach(function(n){for(var t=0;t<n.length;)if(n[t].end<=i)n.shift();else{if(!(n[t].start<i))break;n[t].start=i;t++}});this.fragmentTracker.removeFragmentsInRange(f,i,e.b.SUBTITLE)}},t.onError=function(n,t){var i,r=t.frag;r&&r.type===e.b.SUBTITLE&&(null!==(i=this.fragCurrent)&&void 0!==i&&i.loader&&this.fragCurrent.loader.abort(),this.state=h)},t.onSubtitleTracksUpdated=function(n,t){var i=this,r=t.subtitleTracks;this.tracksBuffered=[];this.levels=r.map(function(n){return new lt(n)});this.fragmentTracker.removeAllFragments();this.fragPrevious=null;this.levels.forEach(function(n){i.tracksBuffered[n.id]=[]});this.mediaBuffer=null},t.onSubtitleTrackSwitch=function(n,t){if(this.currentTrackId=t.id,this.levels.length&&-1!==this.currentTrackId){var i=this.levels[this.currentTrackId];this.mediaBuffer=null!=i&&i.details?this.mediaBufferTimeRanges:null;i&&this.setInterval(500)}else this.clearInterval()},t.onSubtitleTrackLoaded=function(n,t){var e,i=t.details,o=t.id,c=this.currentTrackId,s=this.levels,r,u,f;if(s.length&&(r=s[c],!(o>=s.length||o!==c)&&r)){if(this.mediaBuffer=this.mediaBufferTimeRanges,i.live||null!==(e=r.details)&&void 0!==e&&e.live){if(u=this.mainDetails,i.deltaUpdateFailed||!u)return;f=u.fragments[0];r.details?0===this.alignPlaylists(i,r.details)&&f&&oi(i,f.start):i.hasProgramDateTime&&u.hasProgramDateTime?du(i,u):f&&oi(i,f.start)}(r.details=i,this.levelLastLoaded=o,this.tick(),i.live&&!this.fragCurrent&&this.media&&this.state===h)&&(ci(null,i.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),r.details=void 0))}},t._handleFragmentLoadComplete=function(n){var i=n.frag,u=n.payload,t=i.decryptdata,e=this.hls,f;!this.fragContextChanged(i)&&u&&u.byteLength>0&&t&&t.key&&t.iv&&"AES-128"===t.method&&(f=performance.now(),this.decrypter.webCryptoDecrypt(new Uint8Array(u),t.key.buffer,t.iv.buffer).then(function(n){var t=performance.now();e.trigger(r.a.FRAG_DECRYPTED,{frag:i,payload:n,stats:{tstart:f,tdecrypt:t}})}))},t.doTick=function(){var f,u,t;if(this.media){if(this.state===h){if(u=this.currentTrackId,t=this.levels,!t.length||!t[u]||!t[u].details)return;var i=t[u].details,s=i.targetduration,a=this.config,y=this.media,v=c.bufferedInfo(this.mediaBufferTimeRanges,y.currentTime-s,a.maxBufferHole),e=v.end;if(v.len>this.getMaxBufferLength()+s)return;var n,r=i.fragments,p=r.length,w=i.edge,o=this.fragPrevious;e<w?!(n=ci(o,r,e,a.maxFragLookUpTolerance))&&o&&o.start<r[0].start&&(n=r[0]):n=r[p-1];null!==(f=n)&&void 0!==f&&f.encrypted?this.loadKey(n,i):n&&this.fragmentTracker.getState(n)===l.NOT_LOADED&&this.loadFragment(n,i,e)}}else this.state=h},t.loadFragment=function(t,i,r){this.fragCurrent=t;n.prototype.loadFragment.call(this,t,i,r)},o=u,(s=[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}])&&gf(o.prototype,s),a&&gf(o,a),u}(pi);var s,eh=function(n){function u(t){var i;return(i=n.call(this,t,"[subtitle-track-controller]")||this).media=null,i.tracks=[],i.groupId=null,i.tracksInGroup=[],i.trackId=-1,i.selectDefaultTrack=!0,i.queuedDefaultTrack=-1,i.trackChangeListener=function(){return i.onTextTracksChanged()},i.asyncPollTrackChange=function(){return i.pollTrackChange(0)},i.useTextTrackPolling=!1,i.subtitlePollingInterval=-1,i.subtitleDisplay=!0,i.registerListeners(),i}var i,f,o,s,h,t;return f=n,(i=u).prototype=Object.create(f.prototype),i.prototype.constructor=i,re(i,f),t=u.prototype,t.destroy=function(){this.unregisterListeners();this.tracks.length=0;this.tracksInGroup.length=0;this.trackChangeListener=this.asyncPollTrackChange=null;n.prototype.destroy.call(this)},t.registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.on(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.on(r.a.LEVEL_SWITCHING,this.onLevelSwitching,this);n.on(r.a.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);n.on(r.a.ERROR,this.onError,this)},t.unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.off(r.a.LEVEL_LOADING,this.onLevelLoading,this);n.off(r.a.LEVEL_SWITCHING,this.onLevelSwitching,this);n.off(r.a.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);n.off(r.a.ERROR,this.onError,this)},t.onMediaAttached=function(n,t){this.media=t.media;this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},t.pollTrackChange=function(n){self.clearInterval(this.subtitlePollingInterval);this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,n)},t.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),gi(this.media.textTracks).forEach(function(n){nt(n)}),this.subtitleTrack=-1,this.media=null)},t.onManifestLoading=function(){this.tracks=[];this.groupId=null;this.tracksInGroup=[];this.trackId=-1;this.selectDefaultTrack=!0},t.onManifestParsed=function(n,t){this.tracks=t.subtitleTracks},t.onSubtitleTrackLoaded=function(n,t){var i=t.id,u=t.details,e=this.trackId,r=this.tracksInGroup[e],f;r?(f=r.details,r.details=t.details,this.log("subtitle track "+i+" loaded ["+u.startSN+"-"+u.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,t,f))):this.warn("Invalid subtitle track id "+i)},t.onLevelLoading=function(n,t){this.switchLevel(t.level)},t.onLevelSwitching=function(n,t){this.switchLevel(t.level)},t.switchLevel=function(n){var i=this.hls.levels[n],t,u,f,e,o;null!=i&&i.textGroupIds&&(t=i.textGroupIds[i.urlId],this.groupId!==t&&(u=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,f=this.tracks.filter(function(n){return!t||n.groupId===t}),this.tracksInGroup=f,e=this.findTrackId(null==u?void 0:u.name)||this.findTrackId(),this.groupId=t,o={subtitleTracks:f},this.log("Updating subtitle tracks, "+f.length+' track(s) found in "'+t+'" group-id'),this.hls.trigger(r.a.SUBTITLE_TRACKS_UPDATED,o),-1!==e&&this.setSubtitleTrack(e,u)))},t.findTrackId=function(n){for(var i,r=this.tracksInGroup,t=0;t<r.length;t++)if(i=r[t],(!this.selectDefaultTrack||i.default)&&(!n||n===i.name))return i.id;return-1},t.onError=function(t,i){n.prototype.onError.call(this,t,i);!i.fatal&&i.context&&i.context.type===e.a.SUBTITLE_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.retryLoadingOrFail(i)},t.loadPlaylist=function(n){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var u=t.id,f=t.groupId,i=t.url;if(n)try{i=n.addDirectives(i)}catch(n){this.warn("Could not construct new URL with HLS Delivery Directives: "+n)}this.log("Loading subtitle playlist for id "+u);this.hls.trigger(r.a.SUBTITLE_TRACK_LOADING,{url:i,id:u,groupId:f,deliveryDirectives:n||null})}},t.toggleTrackModes=function(n){var e=this,f=this.media,o=this.subtitleDisplay,s=this.trackId,t,i,r,u;f&&(t=gi(f.textTracks),i=t.filter(function(n){return n.groupId===e.groupId}),-1===n?[].slice.call(t).forEach(function(n){n.mode="disabled"}):(r=i[s],r&&(r.mode="disabled")),u=i[n],u&&(u.mode=o?"showing":"hidden"))},t.setSubtitleTrack=function(n,t){var u,f=this.tracksInGroup,i,o;if(this.media){if(this.trackId!==n&&this.toggleTrackModes(n),!(this.trackId===n&&(-1===n||null!==(u=f[n])&&void 0!==u&&u.details)||n<-1||n>=f.length))if(this.clearTimer(),i=f[n],this.log("Switching to subtitle track "+n),this.trackId=n,i){var s=i.id,e=i.groupId,h=void 0===e?"":e,c=i.name,l=i.type,a=i.url;this.hls.trigger(r.a.SUBTITLE_TRACK_SWITCH,{id:s,groupId:h,name:c,type:l,url:a});o=this.switchParams(i.url,null==t?void 0:t.details);this.loadPlaylist(o)}else this.hls.trigger(r.a.SUBTITLE_TRACK_SWITCH,{id:n})}else this.queuedDefaultTrack=n},t.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var t=-1,i=gi(this.media.textTracks),n=0;n<i.length;n++)if("hidden"===i[n].mode)t=n;else if("showing"===i[n].mode){t=n;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}},o=u,(s=[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(n){this.selectDefaultTrack=!1;var t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(n,t)}}])&&ie(o.prototype,s),h&&ie(o,h),u}(at),oh=function(){function t(n){this.buffers=void 0;this.queues={video:[],audio:[],audiovideo:[]};this.buffers=n}var n=t.prototype;return n.append=function(n,t){var i=this.queues[t];i.push(n);1===i.length&&this.buffers[t]&&this.executeNext(t)},n.insertAbort=function(n,t){this.queues[t].unshift(n);this.executeNext(t)},n.appendBlocker=function(n){var t,i=new Promise(function(n){t=n}),r={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(r,n),i},n.executeNext=function(n){var r=this.buffers,e=this.queues,f=r[n],t=e[n],i;if(t.length){i=t[0];try{i.execute()}catch(r){u.b.warn("[buffer-operation-queue]: Unhandled exception executing the current operation");i.onError(r);f&&f.updating||(t.shift(),this.executeNext(n))}}},n.shiftAndExecuteNext=function(n){this.queues[n].shift();this.executeNext(n)},n.current=function(n){return this.queues[n][0]},t}(),ue=wi(),fe=/([ha]vc.)(?:\.[^.,]+)+/,sh=function(){function t(n){var t=this;this.details=null;this._objectUrl=null;this.operationQueue=void 0;this.listeners=void 0;this.hls=void 0;this.bufferCodecEventsExpected=0;this._bufferCodecEventsTotal=0;this.media=null;this.mediaSource=null;this.appendError=0;this.tracks={};this.pendingTracks={};this.sourceBuffer=void 0;this._onMediaSourceOpen=function(){var f=t.hls,n=t.media,i=t.mediaSource;u.b.log("[buffer-controller]: Media source opened");n&&(t.updateMediaElementDuration(),f.trigger(r.a.MEDIA_ATTACHED,{media:n}));i&&i.removeEventListener("sourceopen",t._onMediaSourceOpen);t.checkPendingTracks()};this._onMediaSourceClose=function(){u.b.log("[buffer-controller]: Media source closed")};this._onMediaSourceEnded=function(){u.b.log("[buffer-controller]: Media source ended")};this.hls=n;this._initSourceBuffer();this.registerListeners()}var n=t.prototype;return n.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},n.destroy=function(){this.unregisterListeners();this.details=null},n.registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.on(r.a.BUFFER_RESET,this.onBufferReset,this);n.on(r.a.BUFFER_APPENDING,this.onBufferAppending,this);n.on(r.a.BUFFER_CODECS,this.onBufferCodecs,this);n.on(r.a.BUFFER_EOS,this.onBufferEos,this);n.on(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this);n.on(r.a.LEVEL_UPDATED,this.onLevelUpdated,this);n.on(r.a.FRAG_PARSED,this.onFragParsed,this);n.on(r.a.FRAG_CHANGED,this.onFragChanged,this)},n.unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.off(r.a.BUFFER_RESET,this.onBufferReset,this);n.off(r.a.BUFFER_APPENDING,this.onBufferAppending,this);n.off(r.a.BUFFER_CODECS,this.onBufferCodecs,this);n.off(r.a.BUFFER_EOS,this.onBufferEos,this);n.off(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this);n.off(r.a.LEVEL_UPDATED,this.onLevelUpdated,this);n.off(r.a.FRAG_PARSED,this.onFragParsed,this);n.off(r.a.FRAG_CHANGED,this.onFragChanged,this)},n._initSourceBuffer=function(){this.sourceBuffer={};this.operationQueue=new oh(this.sourceBuffer);this.listeners={audio:[],video:[],audiovideo:[]}},n.onManifestParsed=function(n,t){var i=2;(!t.audio||t.video)&&t.altAudio||(i=1);this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i;this.details=null;u.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},n.onMediaAttaching=function(n,t){var r=this.media=t.media,i;r&&ue&&(i=this.mediaSource=new ue,i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(i),this._objectUrl=r.src)},n.onMediaDetaching=function(){var t=this.media,n=this.mediaSource,i=this._objectUrl;if(n){if(u.b.log("[buffer-controller]: media source detaching"),"open"===n.readyState)try{n.endOfStream()}catch(t){u.b.warn("[buffer-controller]: onMediaDetaching: "+t.message+" while calling endOfStream")}this.onBufferReset();n.removeEventListener("sourceopen",this._onMediaSourceOpen);n.removeEventListener("sourceended",this._onMediaSourceEnded);n.removeEventListener("sourceclose",this._onMediaSourceClose);t&&(i&&self.URL.revokeObjectURL(i),t.src===i?(t.removeAttribute("src"),t.load()):u.b.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup"));this.mediaSource=null;this.media=null;this._objectUrl=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;this.pendingTracks={};this.tracks={}}this.hls.trigger(r.a.MEDIA_DETACHED,void 0)},n.onBufferReset=function(){var n=this;this.getSourceBufferTypes().forEach(function(t){var i=n.sourceBuffer[t];try{i&&(n.removeBufferListeners(t),n.mediaSource&&n.mediaSource.removeSourceBuffer(i),n.sourceBuffer[t]=void 0)}catch(n){u.b.warn("[buffer-controller]: Failed to reset the "+t+" buffer",n)}});this._initSourceBuffer()},n.onBufferCodecs=function(n,t){var i=this,r=this.getSourceBufferTypes().length;Object.keys(t).forEach(function(n){var u,s;if(r){if(u=i.tracks[n],u&&"function"==typeof u.buffer.changeType){var f=t[n],e=f.codec,o=f.levelCodec,h=f.container;(u.levelCodec||u.codec).replace(fe,"$1")!==(o||e).replace(fe,"$1")&&(s=h+";codecs="+(o||e),i.appendChangeType(n,s))}}else i.pendingTracks[n]=t[n]});r||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},n.appendChangeType=function(n,t){var r=this,i=this.operationQueue,f={execute:function(){var f=r.sourceBuffer[n];f&&(u.b.log("[buffer-controller]: changing "+n+" sourceBuffer type to "+t),f.changeType(t));i.shiftAndExecuteNext(n)},onStart:function(){},onComplete:function(){},onError:function(t){u.b.warn("[buffer-controller]: Failed to change "+n+" SourceBuffer type",t)}};i.append(f,n)},n.onBufferAppending=function(n,t){var e=this,a=this.hls,b=this.operationQueue,k=this.tracks,d=t.data,o=t.type,i=t.frag,v=t.part,y=t.chunkMeta,l=y.buffering[o],p=self.performance.now(),h,s;l.start=p;h=i.stats.buffering;s=v?v.stats.buffering:null;0===h.start&&(h.start=p);s&&0===s.start&&(s.start=p);var w=k.audio,g="audio"===o&&1===y.id&&"audio/mpeg"===(null==w?void 0:w.container),nt={execute:function(){var n,t;(l.executeStart=self.performance.now(),g)&&(n=e.sourceBuffer[o],n&&(t=i.start-n.timestampOffset,Math.abs(t)>=.1&&(u.b.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+i.start+" (delta: "+t+") sn: "+i.sn+")"),n.timestampOffset=i.start)));e.appendExecutor(d,o)},onStart:function(){},onComplete:function(){var n=self.performance.now(),t,u,f;l.executeEnd=l.end=n;0===h.first&&(h.first=n);s&&0===s.first&&(s.first=n);t=e.sourceBuffer;u={};for(f in t)u[f]=c.getBuffered(t[f]);e.appendError=0;e.hls.trigger(r.a.BUFFER_APPENDED,{type:o,frag:i,part:v,chunkMeta:y,parent:i.type,timeRanges:u})},onError:function(n){u.b.error("[buffer-controller]: Error encountered while trying to append to the "+o+" SourceBuffer",n);var t={type:f.b.MEDIA_ERROR,parent:i.type,details:f.a.BUFFER_APPEND_ERROR,err:n,fatal:!1};n.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=f.a.BUFFER_FULL_ERROR:(e.appendError++,t.details=f.a.BUFFER_APPEND_ERROR,e.appendError>a.config.appendErrorMaxRetry&&(u.b.error("[buffer-controller]: Failed "+a.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),t.fatal=!0));a.trigger(r.a.ERROR,t)}};b.append(nt,o)},n.onBufferFlushing=function(n,t){var i=this,f=this.operationQueue,e=function(n){return{execute:i.removeExecutor.bind(i,n,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){i.hls.trigger(r.a.BUFFER_FLUSHED,{type:n})},onError:function(t){u.b.warn("[buffer-controller]: Failed to remove from "+n+" SourceBuffer",t)}}};t.type?f.append(e(t.type),t.type):this.getSourceBufferTypes().forEach(function(n){f.append(e(n),n)})},n.onFragParsed=function(n,t){var s=this,i=t.frag,f=t.part,e=[],o=f?f.elementaryStreams:i.elementaryStreams;o[a.a.AUDIOVIDEO]?e.push("audiovideo"):(o[a.a.AUDIO]&&e.push("audio"),o[a.a.VIDEO]&&e.push("video"));0===e.length&&u.b.warn("Fragments must have at least one ElementaryStreamType set. type: "+i.type+" level: "+i.level+" sn: "+i.sn);this.blockBuffers(function(){var n=self.performance.now(),t;i.stats.buffering.end=n;f&&(f.stats.buffering.end=n);t=f?f.stats:i.stats;s.hls.trigger(r.a.FRAG_BUFFERED,{frag:i,part:f,stats:t,id:i.type})},e)},n.onFragChanged=function(){this.flushBackBuffer()},n.onBufferEos=function(n,t){var i=this;this.getSourceBufferTypes().reduce(function(n,r){var f=i.sourceBuffer[r];return t.type&&t.type!==r||f&&!f.ended&&(f.ended=!0,u.b.log("[buffer-controller]: "+r+" sourceBuffer now EOS")),n&&!(f&&!f.ended)},!0)&&this.blockBuffers(function(){var n=i.mediaSource;n&&"open"===n.readyState&&n.endOfStream()})},n.onLevelUpdated=function(n,t){var i=t.details;i.fragments.length&&(this.details=i,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},n.flushBackBuffer=function(){var n=this.hls,t=this.details,s=this.media,h=this.sourceBuffer,f,i;if(s&&null!==t&&(f=this.getSourceBufferTypes(),f.length&&(i=t.live&&null!==n.config.liveBackBufferLength?n.config.liveBackBufferLength:n.config.backBufferLength,Object(o.a)(i)&&!(i<0)))){var l=s.currentTime,e=t.levelTargetDuration,a=Math.max(i,e),u=Math.floor(l/e)*e-a;f.forEach(function(i){var e=h[i],f;e&&(f=c.getBuffered(e),f.length>0&&u>f.start(0)&&(n.trigger(r.a.BACK_BUFFER_REACHED,{bufferEnd:u}),t.live&&n.trigger(r.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u}),n.trigger(r.a.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:i})))})}},n.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var n=this.details,f=this.hls,e=this.media,t=this.mediaSource,i=n.fragments[0].start+n.totalduration,r=e.duration,s=Object(o.a)(t.duration)?t.duration:0;n.live&&f.config.liveDurationInfinity?(u.b.log("[buffer-controller]: Media Source duration is set to Infinity"),t.duration=1/0,this.updateSeekableRange(n)):(i>s&&i>r||!Object(o.a)(r))&&(u.b.log("[buffer-controller]: Updating Media Source duration to "+i.toFixed(3)),t.duration=i)}},n.updateSeekableRange=function(n){var i=this.mediaSource,r=n.fragments,t,u;r.length&&n.live&&null!=i&&i.setLiveSeekableRange&&(t=Math.max(0,r[0].start),u=Math.max(t,t+n.totalduration),i.setLiveSeekableRange(t,u))},n.checkPendingTracks=function(){var u=this.bufferCodecEventsExpected,e=this.operationQueue,t=this.pendingTracks,i=Object.keys(t).length,n;if(i&&!u||2===i){if(this.createSourceBuffers(t),this.pendingTracks={},n=this.getSourceBufferTypes(),0===n.length)return void this.hls.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});n.forEach(function(n){e.executeNext(n)})}},n.createSourceBuffers=function(n){var c=this.sourceBuffer,l=this.mediaSource,s,i,t,h,e,a,o;if(!l)throw Error("createSourceBuffers called when mediaSource was null");s=0;for(i in n)if(!c[i]){if(t=n[i],!t)throw Error("source buffer exists for track "+i+", however track does not");h=t.levelCodec||t.codec;e=t.container+";codecs="+h;u.b.log("[buffer-controller]: creating sourceBuffer("+e+")");try{a=c[i]=l.addSourceBuffer(e);o=i;this.addBufferListener(o,"updatestart",this._onSBUpdateStart);this.addBufferListener(o,"updateend",this._onSBUpdateEnd);this.addBufferListener(o,"error",this._onSBUpdateError);this.tracks[i]={buffer:a,codec:h,container:t.container,levelCodec:t.levelCodec,id:t.id};s++}catch(n){u.b.error("[buffer-controller]: error while trying to add sourceBuffer: "+n.message);this.hls.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:n,mimeType:e})}}s&&this.hls.trigger(r.a.BUFFER_CREATED,{tracks:this.tracks})},n._onSBUpdateStart=function(n){this.operationQueue.current(n).onStart()},n._onSBUpdateEnd=function(n){var t=this.operationQueue;t.current(n).onComplete();t.shiftAndExecuteNext(n)},n._onSBUpdateError=function(n,t){u.b.error("[buffer-controller]: "+n+" SourceBuffer error",t);this.hls.trigger(r.a.ERROR,{type:f.b.MEDIA_ERROR,details:f.a.BUFFER_APPENDING_ERROR,fatal:!1});var i=this.operationQueue.current(n);i&&i.onError(t)},n.removeExecutor=function(n,t,i){var r=this.media,f=this.mediaSource,h=this.operationQueue,c=this.sourceBuffer[n];if(!r||!f||!c)return u.b.warn("[buffer-controller]: Attempting to remove from the "+n+" SourceBuffer, but it does not exist"),void h.shiftAndExecuteNext(n);var l=Object(o.a)(r.duration)?r.duration:1/0,a=Object(o.a)(f.duration)?f.duration:1/0,e=Math.max(0,t),s=Math.min(i,l,a);s>e?(u.b.log("[buffer-controller]: Removing ["+e+","+s+"] from the "+n+" SourceBuffer"),c.remove(e,s)):h.shiftAndExecuteNext(n)},n.appendExecutor=function(n,t){var r=this.operationQueue,i=this.sourceBuffer[t];if(!i)return u.b.warn("[buffer-controller]: Attempting to append to the "+t+" SourceBuffer, but it does not exist"),void r.shiftAndExecuteNext(t);i.ended=!1;i.appendBuffer(n)},n.blockBuffers=function(n,t){var f=this,i,r;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return u.b.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve(n);i=this.operationQueue;r=t.map(function(n){return i.appendBlocker(n)});Promise.all(r).then(function(){n();t.forEach(function(n){var t=f.sourceBuffer[n];t&&t.updating||i.shiftAndExecuteNext(n)})})},n.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},n.addBufferListener=function(n,t,i){var u=this.sourceBuffer[n],r;u&&(r=i.bind(this,n),this.listeners[n].push({event:t,listener:r}),u.addEventListener(t,r))},n.removeBufferListeners=function(n){var t=this.sourceBuffer[n];t&&this.listeners[n].forEach(function(n){t.removeEventListener(n.event,n.listener)})},t}(),ee={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},oe=function(n){var t=n;return ee.hasOwnProperty(n)&&(t=ee[n]),String.fromCharCode(t)},hh={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ch={17:2,18:4,21:6,22:8,23:10,19:13,20:15},lh={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},ah={25:2,26:4,29:6,30:8,31:10,27:13,28:15},vh=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(n){n[n.ERROR=0]="ERROR";n[n.TEXT=1]="TEXT";n[n.WARNING=2]="WARNING";n[n.INFO=2]="INFO";n[n.DEBUG=3]="DEBUG";n[n.DATA=3]="DATA"}(s||(s={}));var yh=function(){function n(){this.time=null;this.verboseLevel=s.ERROR}return n.prototype.log=function(n,t){this.verboseLevel>=n&&u.b.log(this.time+" ["+n+"] "+t)},n}(),g=function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].toString(16));return i},se=function(){function t(n,t,i,r,u){this.foreground=void 0;this.underline=void 0;this.italics=void 0;this.background=void 0;this.flash=void 0;this.foreground=n||"white";this.underline=t||!1;this.italics=i||!1;this.background=r||"black";this.flash=u||!1}var n=t.prototype;return n.reset=function(){this.foreground="white";this.underline=!1;this.italics=!1;this.background="black";this.flash=!1},n.setStyles=function(n){for(var i,r=["foreground","underline","italics","background","flash"],t=0;t<r.length;t++)i=r[t],n.hasOwnProperty(i)&&(this[i]=n[i])},n.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},n.equals=function(n){return this.foreground===n.foreground&&this.underline===n.underline&&this.italics===n.italics&&this.background===n.background&&this.flash===n.flash},n.copy=function(n){this.foreground=n.foreground;this.underline=n.underline;this.italics=n.italics;this.background=n.background;this.flash=n.flash},n.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),ph=function(){function t(n,t,i,r,u,f){this.uchar=void 0;this.penState=void 0;this.uchar=n||" ";this.penState=new se(t,i,r,u,f)}var n=t.prototype;return n.reset=function(){this.uchar=" ";this.penState.reset()},n.setChar=function(n,t){this.uchar=n;this.penState.copy(t)},n.setPenState=function(n){this.penState.copy(n)},n.equals=function(n){return this.uchar===n.uchar&&this.penState.equals(n.penState)},n.copy=function(n){this.uchar=n.uchar;this.penState.copy(n.penState)},n.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),wh=function(){function t(n){this.chars=void 0;this.pos=void 0;this.currPenState=void 0;this.cueStartTime=void 0;this.logger=void 0;this.chars=[];for(var t=0;t<100;t++)this.chars.push(new ph);this.logger=n;this.pos=0;this.currPenState=new se}var n=t.prototype;return n.equals=function(n){for(var i=!0,t=0;t<100;t++)if(!this.chars[t].equals(n.chars[t])){i=!1;break}return i},n.copy=function(n){for(var t=0;t<100;t++)this.chars[t].copy(n.chars[t])},n.isEmpty=function(){for(var t=!0,n=0;n<100;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t},n.setCursor=function(n){this.pos!==n&&(this.pos=n);this.pos<0?(this.logger.log(s.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(s.DEBUG,"Too large cursor position "+this.pos),this.pos=100)},n.moveCursor=function(n){var i=this.pos+n,t;if(n>1)for(t=this.pos+1;t<i+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(i)},n.backSpace=function(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)},n.insertChar=function(n){n>=144&&this.backSpace();var t=oe(n);this.pos>=100?this.logger.log(s.ERROR,"Cannot insert "+n.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},n.clearFromPos=function(n){for(var t=n;t<100;t++)this.chars[t].reset()},n.clear=function(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()},n.clearToEndOfRow=function(){this.clearFromPos(this.pos)},n.getTextString=function(){for(var t,i=[],r=!0,n=0;n<100;n++)t=this.chars[n].uchar," "!==t&&(r=!1),i.push(t);return r?"":i.join("")},n.setPenStyles=function(n){this.currPenState.setStyles(n);this.chars[this.pos].setPenState(this.currPenState)},t}(),nr=function(){function t(n){this.rows=void 0;this.currRow=void 0;this.nrRollUpRows=void 0;this.lastOutputScreen=void 0;this.logger=void 0;this.rows=[];for(var t=0;t<15;t++)this.rows.push(new wh(n));this.logger=n;this.currRow=14;this.nrRollUpRows=null;this.lastOutputScreen=null;this.reset()}var n=t.prototype;return n.reset=function(){for(var n=0;n<15;n++)this.rows[n].clear();this.currRow=14},n.equals=function(n){for(var i=!0,t=0;t<15;t++)if(!this.rows[t].equals(n.rows[t])){i=!1;break}return i},n.copy=function(n){for(var t=0;t<15;t++)this.rows[t].copy(n.rows[t])},n.isEmpty=function(){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t},n.backSpace=function(){this.rows[this.currRow].backSpace()},n.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},n.insertChar=function(n){this.rows[this.currRow].insertChar(n)},n.setPen=function(n){this.rows[this.currRow].setPenStyles(n)},n.moveCursor=function(n){this.rows[this.currRow].moveCursor(n)},n.setCursor=function(n){this.logger.log(s.INFO,"setCursor: "+n);this.rows[this.currRow].setCursor(n)},n.setPAC=function(n){var t,r,f,u,e,o,i,h,c,l,a;if(this.logger.log(s.INFO,"pacData = "+JSON.stringify(n)),t=n.row-1,this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(r=0;r<15;r++)this.rows[r].clear();if(f=this.currRow+1-this.nrRollUpRows,u=this.lastOutputScreen,u&&(e=u.rows[f].cueStartTime,o=this.logger.time,e&&null!==o&&e<o))for(i=0;i<this.nrRollUpRows;i++)this.rows[t-this.nrRollUpRows+i+1].copy(u.rows[f+i])}this.currRow=t;h=this.rows[this.currRow];null!==n.indent&&(c=n.indent,l=Math.max(c-1,0),h.setCursor(n.indent),n.color=h.chars[l].penState.foreground);a={foreground:n.color,underline:n.underline,italics:n.italics,background:"black",flash:!1};this.setPen(a)},n.setBkgData=function(n){this.logger.log(s.INFO,"bkgData = "+JSON.stringify(n));this.backSpace();this.setPen(n);this.insertChar(32)},n.setRollUpRows=function(n){this.nrRollUpRows=n},n.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(s.TEXT,this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear();this.rows.splice(this.currRow,0,n);this.logger.log(s.INFO,"Rolling up")}else this.logger.log(s.DEBUG,"roll_up but nrRollUpRows not set yet")},n.getDisplayText=function(n){var r;n=n||!1;for(var t=[],u="",f=-1,i=0;i<15;i++)r=this.rows[i].getTextString(),r&&(f=i+1,n?t.push("Row "+f+": '"+r+"'"):t.push(r.trim()));return t.length>0&&(u=n?"["+t.join(" | ")+"]":t.join("\n")),u},n.getTextAndFormat=function(){return this.rows},t}(),he=function(){function t(n,t,i){this.chNr=void 0;this.outputFilter=void 0;this.mode=void 0;this.verbose=void 0;this.displayedMemory=void 0;this.nonDisplayedMemory=void 0;this.lastOutputScreen=void 0;this.currRollUpRow=void 0;this.writeScreen=void 0;this.cueStartTime=void 0;this.logger=void 0;this.chNr=n;this.outputFilter=t;this.mode=null;this.verbose=0;this.displayedMemory=new nr(i);this.nonDisplayedMemory=new nr(i);this.lastOutputScreen=new nr(i);this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.logger=i}var n=t.prototype;return n.reset=function(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.outputFilter.reset();this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null},n.getHandler=function(){return this.outputFilter},n.setHandler=function(n){this.outputFilter=n},n.setPAC=function(n){this.writeScreen.setPAC(n)},n.setBkgData=function(n){this.writeScreen.setBkgData(n)},n.setMode=function(n){n!==this.mode&&(this.mode=n,this.logger.log(s.INFO,"MODE="+n),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=n)},n.insertChars=function(n){for(var i,t=0;t<n.length;t++)this.writeScreen.insertChar(n[t]);i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(s.INFO,i+": "+this.writeScreen.getDisplayText(!0));"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(s.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},n.ccRCL=function(){this.logger.log(s.INFO,"RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")},n.ccBS=function(){this.logger.log(s.INFO,"BS - BackSpace");"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},n.ccAOF=function(){},n.ccAON=function(){},n.ccDER=function(){this.logger.log(s.INFO,"DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()},n.ccRU=function(n){this.logger.log(s.INFO,"RU("+n+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(n)},n.ccFON=function(){this.logger.log(s.INFO,"FON - Flash On");this.writeScreen.setPen({flash:!0})},n.ccRDC=function(){this.logger.log(s.INFO,"RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")},n.ccTR=function(){this.logger.log(s.INFO,"TR");this.setMode("MODE_TEXT")},n.ccRTD=function(){this.logger.log(s.INFO,"RTD");this.setMode("MODE_TEXT")},n.ccEDM=function(){this.logger.log(s.INFO,"EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)},n.ccCR=function(){this.logger.log(s.INFO,"CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)},n.ccENM=function(){this.logger.log(s.INFO,"ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()},n.ccEOC=function(){if(this.logger.log(s.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var n=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=n;this.writeScreen=this.nonDisplayedMemory;this.logger.log(s.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},n.ccTO=function(n){this.logger.log(s.INFO,"TO("+n+") - Tab Offset");this.writeScreen.moveCursor(n)},n.ccMIDROW=function(n){var t={flash:!1},i;(t.underline=n%2==1,t.italics=n>=46,t.italics)?t.foreground="white":(i=Math.floor(n/2)-16,t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]);this.logger.log(s.INFO,"MIDROW: "+JSON.stringify(t));this.writeScreen.setPen(t)},n.outputDataUpdate=function(n){void 0===n&&(n=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),n&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},n.cueSplitAtTime=function(n){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,n,this.displayedMemory),this.cueStartTime=n))},t}();var le=function(){function t(n,t,i){this.channels=void 0;this.currentChannel=0;this.cmdHistory=void 0;this.logger=void 0;var r=new yh;this.channels=[null,new he(n,t,r),new he(n+1,i,r)];this.cmdHistory={a:null,b:null};this.logger=r}var n=t.prototype;return n.getHandler=function(n){return this.channels[n].getHandler()},n.setHandler=function(n,t){this.channels[n].setHandler(t)},n.addData=function(n,t){var f,i,r,o=!1,u,e;for(this.logger.time=n,u=0;u<t.length;u+=2)(i=127&t[u],r=127&t[u+1],0!==i||0!==r)&&((this.logger.log(s.DATA,"["+g([t[u],t[u+1]])+"] -> ("+g([i,r])+")"),(f=this.parseCmd(i,r))||(f=this.parseMidrow(i,r)),f||(f=this.parsePAC(i,r)),f||(f=this.parseBackgroundAttributes(i,r)),!f&&(o=this.parseChars(i,r)))&&(e=this.currentChannel,e&&e>0?this.channels[e].insertChars(o):this.logger.log(s.WARNING,"No channel found yet. TEXT-MODE?")),f||o||this.logger.log(s.WARNING,"Couldn't parse cleaned data "+g([i,r])+" orig: "+g([t[u],t[u+1]])))},n.parseCmd=function(n,t){var r=this.cmdHistory,u,i;return!((20===n||28===n||21===n||29===n)&&t>=32&&t<=47)&&!((23===n||31===n)&&t>=33&&t<=35)?!1:ce(n,t,r)?(rt(null,null,r),this.logger.log(s.DEBUG,"Repeated command ("+g([n,t])+") is dropped"),!0):(u=20===n||21===n||23===n?1:2,i=this.channels[u],20===n||21===n||28===n||29===n?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),rt(n,t,r),this.currentChannel=u,!0)},n.parseMidrow=function(n,t){var r=0,i;return(17===n||25===n)&&t>=32&&t<=47?(r=17===n?1:2)!==this.currentChannel?(this.logger.log(s.ERROR,"Mismatch channel in midrow parsing"),!1):(i=this.channels[r],!!i&&(i.ccMIDROW(t),this.logger.log(s.DEBUG,"MIDROW ("+g([n,t])+")"),!0)):!1},n.parsePAC=function(n,t){var f,r=this.cmdHistory,i,u;return!((n>=17&&n<=23||n>=25&&n<=31)&&t>=64&&t<=127)&&!((16===n||24===n)&&t>=64&&t<=95)?!1:ce(n,t,r)?(rt(null,null,r),!0):(i=n<=23?1:2,f=t>=64&&t<=95?1===i?hh[n]:lh[n]:1===i?ch[n]:ah[n],u=this.channels[i],!!u&&(u.setPAC(this.interpretPAC(f,t)),rt(n,t,r),this.currentChannel=i,!0))},n.interpretPAC=function(n,t){var i,r={color:null,italics:!1,indent:null,underline:!1,row:n};return i=t>95?t-96:t-64,r.underline=1==(1&i),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r},n.parseChars=function(n,t){var u,f,r=null,i=null,e;return(n>=25?(u=2,i=n-8):(u=1,i=n),i>=17&&i<=19)?(f=17===i?t+80:18===i?t+112:t+144,this.logger.log(s.INFO,"Special char '"+oe(f)+"' in channel "+u),r=[f]):n>=32&&n<=127&&(r=0===t?[n]:[n,t]),r&&(e=g(r),this.logger.log(s.DEBUG,"Char codes =  "+e.join(",")),rt(n,t,this.cmdHistory)),r},n.parseBackgroundAttributes=function(n,t){var r,i,u;return!((16===n||24===n)&&t>=32&&t<=47)&&!((23===n||31===n)&&t>=45&&t<=47)?!1:(i={},16===n||24===n?(r=Math.floor((t-32)/2),i.background=vh[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),u=n<=23?1:2,this.channels[u].setBkgData(i),rt(n,t,this.cmdHistory),!0)},n.reset=function(){for(var t,n=0;n<Object.keys(this.channels).length;n++)t=this.channels[n],t&&t.reset();this.cmdHistory={a:null,b:null}},n.cueSplitAtTime=function(n){for(var i,t=0;t<this.channels.length;t++)i=this.channels[t],i&&i.cueSplitAtTime(n)},t}(),dt=function(){function t(n,t){this.timelineController=void 0;this.cueRanges=[];this.trackName=void 0;this.startTime=null;this.endTime=null;this.screen=null;this.timelineController=n;this.trackName=t}var n=t.prototype;return n.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},n.newCue=function(n,t,i){(null===this.startTime||this.startTime>n)&&(this.startTime=n);this.endTime=t;this.screen=i;this.timelineController.createCaptionsTrack(this.trackName)},n.reset=function(){this.cueRanges=[];this.startTime=null},t}(),tr=function(){function i(n,t){if("string"!=typeof t||!Array.isArray(n))return!1;var i=t.toLowerCase();return!!~n.indexOf(i)&&i}function t(n){return i(f,n)}function n(n){for(var i,u,f,r=arguments.length,e=new Array(r>1?r-1:0),t=1;t<r;t++)e[t-1]=arguments[t];for(i=1;i<arguments.length;i++){u=arguments[i];for(f in u)n[f]=u[f]}return n}function r(r,f,e){var o=this,s={enumerable:!0};o.hasBeenReset=!1;var h="",c=!1,l=r,a=f,v=e,y=null,p="",w=!0,b="auto",k="start",d=50,g="middle",nt=50,tt="middle";Object.defineProperty(o,"id",n({},s,{get:function(){return h},set:function(n){h=""+n}}));Object.defineProperty(o,"pauseOnExit",n({},s,{get:function(){return c},set:function(n){c=!!n}}));Object.defineProperty(o,"startTime",n({},s,{get:function(){return l},set:function(n){if("number"!=typeof n)throw new TypeError("Start time must be set to a number.");l=n;this.hasBeenReset=!0}}));Object.defineProperty(o,"endTime",n({},s,{get:function(){return a},set:function(n){if("number"!=typeof n)throw new TypeError("End time must be set to a number.");a=n;this.hasBeenReset=!0}}));Object.defineProperty(o,"text",n({},s,{get:function(){return v},set:function(n){v=""+n;this.hasBeenReset=!0}}));Object.defineProperty(o,"region",n({},s,{get:function(){return y},set:function(n){y=n;this.hasBeenReset=!0}}));Object.defineProperty(o,"vertical",n({},s,{get:function(){return p},set:function(n){var t=function(n){return i(u,n)}(n);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");p=t;this.hasBeenReset=!0}}));Object.defineProperty(o,"snapToLines",n({},s,{get:function(){return w},set:function(n){w=!!n;this.hasBeenReset=!0}}));Object.defineProperty(o,"line",n({},s,{get:function(){return b},set:function(n){if("number"!=typeof n&&"auto"!==n)throw new SyntaxError("An invalid number or illegal string was specified.");b=n;this.hasBeenReset=!0}}));Object.defineProperty(o,"lineAlign",n({},s,{get:function(){return k},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");k=i;this.hasBeenReset=!0}}));Object.defineProperty(o,"position",n({},s,{get:function(){return d},set:function(n){if(n<0||n>100)throw new Error("Position must be between 0 and 100.");d=n;this.hasBeenReset=!0}}));Object.defineProperty(o,"positionAlign",n({},s,{get:function(){return g},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");g=i;this.hasBeenReset=!0}}));Object.defineProperty(o,"size",n({},s,{get:function(){return nt},set:function(n){if(n<0||n>100)throw new Error("Size must be between 0 and 100.");nt=n;this.hasBeenReset=!0}}));Object.defineProperty(o,"align",n({},s,{get:function(){return tt},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");tt=i;this.hasBeenReset=!0}}));o.displayState=void 0}if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var u=["","lr","rl"],f=["start","middle","end","left","right"];return r.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},r}(),bh=function(){function n(){}return n.prototype.decode=function(n){if(!n)return"";if("string"!=typeof n)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))},n}();ve=function(){function t(){this.values=Object.create(null)}var n=t.prototype;return n.set=function(n,t){this.get(n)||""===t||(this.values[n]=t)},n.get=function(n,t,i){return i?this.has(n)?this.values[n]:t[i]:this.has(n)?this.values[n]:t},n.has=function(n){return n in this.values},n.alt=function(n,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(n,t);break}},n.integer=function(n,t){/^-?\d+$/.test(t)&&this.set(n,parseInt(t,10))},n.percent=function(n,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var i=parseFloat(t);if(i>=0&&i<=100)return this.set(n,i),!0}return!1},t}();gt=new tr(0,0,"");ct="middle"===gt.align?"middle":"center";var dh=function(){function n(){this.state="INITIAL";this.buffer="";this.decoder=new bh;this.regionList=[];this.cue=null;this.oncue=void 0;this.onparsingerror=void 0;this.onflush=void 0}var t=n.prototype;return t.parse=function(n){function f(){for(var i=t.buffer,n=0,r,i=pe(i);n<i.length&&"\r"!==i[n]&&"\n"!==i[n];)++n;return r=i.substr(0,n),"\r"===i[n]&&++n,"\n"===i[n]&&++n,t.buffer=i.substr(n),r}var t=this,i,u,r,e;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if(i="","INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;if(u=(i=f()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/),!u||!u[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:i=f(),t.state){case"HEADER":/:/.test(i)?ye(i,function(){},/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new tr(0,0,""),t.state="CUE",-1===i.indexOf("-->")){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{kh(i,t.cue,t.regionList)}catch(n){t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(e=-1!==i.indexOf("-->"),!i||e&&(r=!0)){t.oncue&&t.cue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n");t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID")}}}catch(n){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue);t.cue=null;t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){try{if((this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state||"BADWEBVTT"===this.state)throw new Error("Malformed WebVTT signature.");}catch(n){this.onparsingerror&&this.onparsingerror(n)}return this.onflush&&this.onflush(),this},n}(),we=i(8),gh=i(16),nc=/\r\n|\n\r|\n|\r/g,ir=function(n,t,i){return void 0===i&&(i=0),n.substr(i,t.length)===t},rr=function(n){for(var t=5381,i=n.length;i;)t=33*t^n.charCodeAt(--i);return(t>>>0).toString()};var ke=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,de=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ic={left:"start",center:"center",right:"end",start:"start",end:"end"};ro=function(){function t(n){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,"new":!1}},this.captionsProperties=void 0,this.hls=n,this.config=n.config,this.Cues=n.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var t=new dt(this,"textTrack1"),i=new dt(this,"textTrack2"),u=new dt(this,"textTrack3"),f=new dt(this,"textTrack4");this.cea608Parser1=new le(1,t,i);this.cea608Parser2=new le(3,u,f)}n.on(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.on(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.on(r.a.MANIFEST_LOADED,this.onManifestLoaded,this);n.on(r.a.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);n.on(r.a.FRAG_LOADING,this.onFragLoading,this);n.on(r.a.FRAG_LOADED,this.onFragLoaded,this);n.on(r.a.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this);n.on(r.a.FRAG_DECRYPTED,this.onFragDecrypted,this);n.on(r.a.INIT_PTS_FOUND,this.onInitPtsFound,this);n.on(r.a.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this);n.on(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this)}var n=t.prototype;return n.destroy=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this);n.off(r.a.MANIFEST_LOADING,this.onManifestLoading,this);n.off(r.a.MANIFEST_LOADED,this.onManifestLoaded,this);n.off(r.a.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);n.off(r.a.FRAG_LOADING,this.onFragLoading,this);n.off(r.a.FRAG_LOADED,this.onFragLoaded,this);n.off(r.a.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this);n.off(r.a.FRAG_DECRYPTED,this.onFragDecrypted,this);n.off(r.a.INIT_PTS_FOUND,this.onInitPtsFound,this);n.off(r.a.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this);n.off(r.a.BUFFER_FLUSHING,this.onBufferFlushing,this);this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},n.addCues=function(n,t,i,u,f){for(var c,l,a,v,e,h,y,p,o=!1,s=f.length;s--;)if(e=f[s],h=(c=e[0],l=e[1],a=t,v=i,Math.min(l,v)-Math.max(c,a)),h>=0&&(e[0]=Math.min(e[0],t),e[1]=Math.max(e[1],i),o=!0,h/(i-t)>.5))return;(o||f.push([t,i]),this.config.renderTextTracksNatively)?(y=this.captionsTracks[n],this.Cues.newCue(y,t,i,u)):(p=this.Cues.newCue(null,t,i,u),this.hls.trigger(r.a.CUES_PARSED,{type:"captions",cues:p,track:n}))},n.onInitPtsFound=function(n,t){var f=this,i=t.frag,e=t.id,o=t.initPTS,s=t.timescale,u=this.unparsedVttFrags;"main"===e&&(this.initPTS[i.cc]=o,this.timescale[i.cc]=s);u.length&&(this.unparsedVttFrags=[],u.forEach(function(n){f.onFragLoaded(r.a.FRAG_LOADED,n)}))},n.getExistingTrack=function(n){var i=this.media,t,r;if(i)for(t=0;t<i.textTracks.length;t++)if(r=i.textTracks[t],r[n])return r;return null},n.createCaptionsTrack=function(n){this.config.renderTextTracksNatively?this.createNativeTrack(n):this.createNonNativeTrack(n)},n.createNativeTrack=function(n){var i;if(!this.captionsTracks[n]){var f=this.captionsProperties,t=this.captionsTracks,e=this.media,r=f[n],o=r.label,s=r.languageCode,u=this.getExistingTrack(n);u?(t[n]=u,nt(t[n]),gr(t[n],e)):(i=this.createTextTrack("captions",o,s),i&&(i[n]=!0,t[n]=i))}},n.createNonNativeTrack=function(n){var t,i;this.nonNativeCaptionsTracks[n]||(t=this.captionsProperties[n],t&&(i={_id:n,label:t.label,kind:"captions","default":!!t.media&&!!t.media.default,closedCaptions:t.media},this.nonNativeCaptionsTracks[n]=i,this.hls.trigger(r.a.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})))},n.createTextTrack=function(n,t,i){var r=this.media;if(r)return r.addTextTrack(n,t,i)},n.onMediaAttaching=function(n,t){this.media=t.media;this._cleanTracks()},n.onMediaDetaching=function(){var n=this.captionsTracks;Object.keys(n).forEach(function(t){nt(n[t]);delete n[t]});this.nonNativeCaptionsTracks={}},n.onManifestLoading=function(){this.lastSn=-1;this.lastPartIndex=-1;this.prevCC=-1;this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,"new":!1}};this._cleanTracks();this.tracks=[];this.captionsTracks={};this.nonNativeCaptionsTracks={};this.textTracks=[];this.unparsedVttFrags=this.unparsedVttFrags||[];this.initPTS=[];this.timescale=[];this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},n._cleanTracks=function(){var i=this.media,n,t;if(i&&(n=i.textTracks,n))for(t=0;t<n.length;t++)nt(n[t])},n.onSubtitleTracksUpdated=function(n,t){var f=this,i,e,o,u,s;this.textTracks=[];i=t.subtitleTracks||[];e=i.some(function(n){return"stpp.ttml.im1t"===n.textCodec});(this.config.enableWebVTT||e&&this.config.enableIMSC1)&&(o=this.tracks&&i&&this.tracks.length===i.length,(this.tracks=i||[],this.config.renderTextTracksNatively)?(u=this.media?this.media.textTracks:[],this.tracks.forEach(function(n,t){var i,e,r;if(t<u.length){for(e=null,r=0;r<u.length;r++)if(rc(u[r],n)){e=u[r];break}e&&(i=e)}i?nt(i):(i=f.createTextTrack("subtitles",n.name,n.lang))&&(i.mode="disabled");i&&(i.groupId=n.groupId,f.textTracks.push(i))})):!o&&this.tracks&&this.tracks.length&&(s=this.tracks.map(function(n){return{label:n.name,kind:n.type.toLowerCase(),"default":n.default,subtitleTrack:n}}),this.hls.trigger(r.a.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:s})))},n.onManifestLoaded=function(n,t){var i=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(function(n){var r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId),u,t;r&&(u="textTrack"+r[1],t=i.captionsProperties[u],t&&(t.label=n.name,n.lang&&(t.languageCode=n.lang),t.media=n))})},n.onFragLoading=function(n,t){var f=this.cea608Parser1,o=this.cea608Parser2,s=this.lastSn,c=this.lastPartIndex,h,r,i,u;this.enabled&&f&&o&&t.frag.type===e.b.MAIN&&(i=t.frag.sn,u=null!=(h=null==t||null===(r=t.part)||void 0===r?void 0:r.index)?h:-1,i===s+1||i===s&&u===c+1||(f.reset(),o.reset()),this.lastSn=i,this.lastPartIndex=u)},n.onFragLoaded=function(n,t){var i=t.frag,s=t.payload,c=this.initPTS,a=this.unparsedVttFrags,u,l,h,f;if(i.type===e.b.SUBTITLE)if(s.byteLength){if(!Object(o.a)(c[i.cc]))return a.push(t),void(c.length&&this.hls.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Missing initial subtitle PTS")}));u=i.decryptdata;l="stats"in t;(null==u||null==u.key||"AES-128"!==u.method||l)&&(h=this.tracks[i.level],f=this.vttCCs,f[i.cc]||(f[i.cc]={start:i.start,prevCC:this.prevCC,"new":!0},this.prevCC=i.cc),h&&"stpp.ttml.im1t"===h.textCodec?this._parseIMSC1(i,s):this._parseVTTs(i,s,f))}else this.hls.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})},n._parseIMSC1=function(n,t){var f=this,i=this.hls;ge(t,this.initPTS[n.cc],this.timescale[n.cc],function(t){f._appendCues(t,n.level);i.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(t){u.b.log("Failed to parse IMSC1: "+t);i.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})})},n._parseVTTs=function(n,t,i){var f=this,e=this.hls;tc(t,this.initPTS[n.cc],this.timescale[n.cc],i,n.cc,n.start,function(t){f._appendCues(t,n.level);e.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},function(i){f._fallbackToIMSC1(n,t);u.b.log("Failed to parse VTT cue: "+i);e.trigger(r.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:i})})},n._fallbackToIMSC1=function(n,t){var r=this,i=this.tracks[n.level];i.textCodec||ge(t,this.initPTS[n.cc],this.timescale[n.cc],function(){i.textCodec="stpp.ttml.im1t";r._parseIMSC1(n,t)},function(){i.textCodec="wvtt"})},n._appendCues=function(n,t){var f=this.hls,i,u;if(this.config.renderTextTracksNatively){if(i=this.textTracks[t],"disabled"===i.mode)return;n.forEach(function(n){return nu(i,n)})}else u=this.tracks[t].default?"default":"subtitles"+t,f.trigger(r.a.CUES_PARSED,{type:"subtitles",cues:n,track:u})},n.onFragDecrypted=function(n,t){var i=t.frag;if(i.type===e.b.SUBTITLE){if(!Object(o.a)(this.initPTS[i.cc]))return void this.unparsedVttFrags.push(t);this.onFragLoaded(r.a.FRAG_LOADED,t)}},n.onSubtitleTracksCleared=function(){this.tracks=[];this.captionsTracks={}},n.onFragParsingUserdata=function(n,t){var f=this.cea608Parser1,e=this.cea608Parser2,i,r,u;if(this.enabled&&f&&e)for(i=0;i<t.samples.length;i++)r=t.samples[i].bytes,r&&(u=this.extractCea608Data(r),f.addData(t.samples[i].pts,u[0]),e.addData(t.samples[i].pts,u[1]))},n.onBufferFlushing=function(n,t){var i=t.startOffset,f=t.endOffset,e=t.endOffsetSubtitles,o=t.type,s=this.media,r,u;!s||s.currentTime<f||(o&&"video"!==o||(r=this.captionsTracks,Object.keys(r).forEach(function(n){return ui(r[n],i,f)})),this.config.renderTextTracksNatively&&0===i&&void 0!==e&&(u=this.textTracks,Object.keys(u).forEach(function(n){return ui(u[n],i,e)})))},n.extractCea608Data=function(n){for(var s=31&n[0],i=2,r=[[],[]],u=0;u<s;u++){var f=n[i++],e=127&n[i++],o=127&n[i++],t=3&f;0===e&&0===o||0!=(4&f)&&(0!==t&&1!==t||(r[t].push(e),r[t].push(o)))}return r},t}();fo=function(){function t(n){this.autoLevelCapping=void 0;this.firstLevel=void 0;this.media=void 0;this.restrictedLevels=void 0;this.timer=void 0;this.hls=void 0;this.streamController=void 0;this.clientRect=void 0;this.hls=n;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.firstLevel=-1;this.media=null;this.restrictedLevels=[];this.timer=void 0;this.clientRect=null;this.registerListeners()}var i,f,u,n=t.prototype;return n.setStreamController=function(n){this.streamController=n},n.destroy=function(){this.unregisterListener();this.hls.config.capLevelToPlayerSize&&this.stopCapping();this.media=null;this.clientRect=null;this.hls=this.streamController=null},n.registerListeners=function(){var n=this.hls;n.on(r.a.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this);n.on(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this);n.on(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.on(r.a.BUFFER_CODECS,this.onBufferCodecs,this);n.on(r.a.MEDIA_DETACHING,this.onMediaDetaching,this)},n.unregisterListener=function(){var n=this.hls;n.off(r.a.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this);n.off(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this);n.off(r.a.MANIFEST_PARSED,this.onManifestParsed,this);n.off(r.a.BUFFER_CODECS,this.onBufferCodecs,this);n.off(r.a.MEDIA_DETACHING,this.onMediaDetaching,this)},n.onFpsDropLevelCapping=function(n,i){t.isLevelAllowed(i.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(i.droppedLevel)},n.onMediaAttaching=function(n,t){this.media=t.media instanceof HTMLVideoElement?t.media:null},n.onManifestParsed=function(n,t){var i=this.hls;this.restrictedLevels=[];this.firstLevel=t.firstLevel;i.config.capLevelToPlayerSize&&t.video&&this.startCapping()},n.onBufferCodecs=function(n,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},n.onMediaDetaching=function(){this.stopCapping()},n.detectPlayerSize=function(){var t,n;this.media&&this.mediaHeight>0&&this.mediaWidth>0&&(t=this.hls.levels,t.length&&(n=this.hls,n.autoLevelCapping=this.getMaxLevel(t.length-1),n.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping))},n.getMaxLevel=function(n){var u=this,i=this.hls.levels,r;return i.length?(r=i.filter(function(i,r){return t.isLevelAllowed(r,u.restrictedLevels)&&r<=n}),this.clientRect=null,t.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)):-1},n.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},n.stopCapping=function(){this.restrictedLevels=[];this.firstLevel=-1;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},n.getDimensions=function(){var i,n,t;return this.clientRect?this.clientRect:(i=this.media,n={width:0,height:0},i&&(t=i.getBoundingClientRect(),n.width=t.width,n.height=t.height,n.width||n.height||(n.width=t.right-t.left||i.width||0,n.height=t.bottom-t.top||i.height||0)),this.clientRect=n,n)},t.isLevelAllowed=function(n,t){return void 0===t&&(t=[]),-1===t.indexOf(n)},t.getMaxLevelByMediaSize=function(n,t,i){var f,e,o,r,u;if(!n||!n.length)return-1;for(o=n.length-1,r=0;r<n.length;r+=1)if(u=n[r],(u.width>=t||u.height>=i)&&(f=u,!(e=n[r+1])||f.width!==e.width||f.height!==e.height)){o=r;break}return o},i=t,u=[{key:"contentScaleFactor",get:function(){var n=1;try{n=self.devicePixelRatio}catch(n){}return n}}],(f=[{key:"mediaWidth",get:function(){return this.getDimensions().width*t.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*t.contentScaleFactor}}])&&uo(i.prototype,f),u&&uo(i,u),t}();eo=function(){function t(n){this.hls=void 0;this.isVideoPlaybackQualityAvailable=!1;this.timer=void 0;this.media=null;this.lastTime=void 0;this.lastDroppedFrames=0;this.lastDecodedFrames=0;this.streamController=void 0;this.hls=n;this.registerListeners()}var n=t.prototype;return n.setStreamController=function(n){this.streamController=n},n.registerListeners=function(){this.hls.on(r.a.MEDIA_ATTACHING,this.onMediaAttaching,this)},n.unregisterListeners=function(){this.hls.off(r.a.MEDIA_ATTACHING,this.onMediaAttaching)},n.destroy=function(){this.timer&&clearInterval(this.timer);this.unregisterListeners();this.isVideoPlaybackQualityAvailable=!1;this.media=null},n.onMediaAttaching=function(n,t){var r=this.hls.config,i;r.capLevelOnFPSDrop&&(i=t.media instanceof self.HTMLVideoElement?t.media:null,this.media=i,i&&"function"==typeof i.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod))},n.checkFPS=function(n,t,i){var s=performance.now(),e;if(t){if(this.lastTime){var c=s-this.lastTime,o=i-this.lastDroppedFrames,h=t-this.lastDecodedFrames,l=1e3*o/c,f=this.hls;(f.trigger(r.a.FPS_DROP,{currentDropped:o,currentDecoded:h,totalDroppedFrames:i}),l>0&&o>f.config.fpsDroppedMonitoringThreshold*h)&&(e=f.currentLevel,u.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===f.autoLevelCapping||f.autoLevelCapping>=e)&&(e-=1,f.trigger(r.a.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:f.currentLevel}),f.autoLevelCapping=e,this.streamController.nextLevelSwitch()))}this.lastTime=s;this.lastDroppedFrames=i;this.lastDecodedFrames=t}},n.checkFPSInterval=function(){var n=this.media,t;n&&(this.isVideoPlaybackQualityAvailable?(t=n.getVideoPlaybackQuality(),this.checkFPS(n,t.totalVideoFrames,t.droppedVideoFrames)):this.checkFPS(n,n.webkitDecodedFrameCount,n.webkitDroppedFrameCount))},t}();!function(n){n.WIDEVINE="com.widevine.alpha";n.PLAYREADY="com.microsoft.playready"}(ut||(ut={}));oo="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;co=function(){function t(n){this.hls=void 0;this._widevineLicenseUrl=void 0;this._licenseXhrSetup=void 0;this._licenseResponseCallback=void 0;this._emeEnabled=void 0;this._requestMediaKeySystemAccess=void 0;this._drmSystemOptions=void 0;this._config=void 0;this._mediaKeysList=[];this._media=null;this._hasSetMediaKeys=!1;this._requestLicenseFailureCount=0;this.mediaKeysPromise=null;this._onMediaEncrypted=this.onMediaEncrypted.bind(this);this.hls=n;this._config=n.config;this._widevineLicenseUrl=this._config.widevineLicenseUrl;this._licenseXhrSetup=this._config.licenseXhrSetup;this._licenseResponseCallback=this._config.licenseResponseCallback;this._emeEnabled=this._config.emeEnabled;this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc;this._drmSystemOptions=this._config.drmSystemOptions;this._registerListeners()}var i,e,o,n=t.prototype;return n.destroy=function(){this._unregisterListeners();this.hls=this._onMediaEncrypted=null;this._requestMediaKeySystemAccess=null},n._registerListeners=function(){this.hls.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.on(r.a.MEDIA_DETACHED,this.onMediaDetached,this);this.hls.on(r.a.MANIFEST_PARSED,this.onManifestParsed,this)},n._unregisterListeners=function(){this.hls.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.off(r.a.MEDIA_DETACHED,this.onMediaDetached,this);this.hls.off(r.a.MANIFEST_PARSED,this.onManifestParsed,this)},n.getLicenseServerUrl=function(n){switch(n){case ut.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+n+'"');},n._attemptKeySystemAccess=function(n,t,i){var f=this,e=function(n,t,i,r){switch(n){case ut.WIDEVINE:return function(n,t,i){var r={audioCapabilities:[],videoCapabilities:[]};return n.forEach(function(n){r.audioCapabilities.push({contentType:'audio/mp4; codecs="'+n+'"',robustness:i.audioRobustness||""})}),t.forEach(function(n){r.videoCapabilities.push({contentType:'video/mp4; codecs="'+n+'"',robustness:i.videoRobustness||""})}),[r]}(t,i,r);default:throw new Error("Unknown key-system: "+n);}}(n,t,i,this._drmSystemOptions),r;u.b.log("Requesting encrypted media key-system access");r=this.requestMediaKeySystemAccess(n,e);this.mediaKeysPromise=r.then(function(t){return f._onMediaKeySystemAccessObtained(n,t)});r.catch(function(t){u.b.error('Failed to obtain key-system "'+n+'" access:',t)})},n._onMediaKeySystemAccessObtained=function(n,t){var f=this,i,r;return u.b.log('Access for key-system "'+n+'" obtained'),i={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:n},this._mediaKeysList.push(i),r=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(t){return i.mediaKeys=t,u.b.log('Media-keys created for key-system "'+n+'"'),f._onMediaKeysCreated(),t}),r.catch(function(n){u.b.error("Failed to create media-keys:",n)}),r},n._onMediaKeysCreated=function(){var n=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),n._onNewMediaKeySession(t.mediaKeysSession))})},n._onNewMediaKeySession=function(n){var t=this;u.b.log("New key-system session "+n.sessionId);n.addEventListener("message",function(i){t._onKeySessionMessage(n,i.message)},!1)},n._onKeySessionMessage=function(n,t){u.b.log("Got EME message event, creating license request");this._requestLicense(t,function(t){u.b.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session");n.update(t)})},n.onMediaEncrypted=function(n){var t=this,i;if(u.b.log('Media is encrypted using "'+n.initDataType+'" init data type'),!this.mediaKeysPromise)return u.b.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_KEYS,fatal:!0});i=function(i){t._media&&(t._attemptSetMediaKeys(i),t._generateRequestWithPreferredKeySession(n.initDataType,n.initData))};this.mediaKeysPromise.then(i).catch(i)},n._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var n=this._mediaKeysList[0];if(!n||!n.mediaKeys)return u.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_KEYS,fatal:!0});u.b.log("Setting keys for encrypted media");this._media.setMediaKeys(n.mediaKeys);this._hasSetMediaKeys=!0}},n._generateRequestWithPreferredKeySession=function(n,t){var o=this,i=this._mediaKeysList[0],e;if(!i)return u.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(i.mediaKeysSessionInitialized)u.b.warn("Key-Session already initialized but requested again");else{if(e=i.mediaKeysSession,!e)return u.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return u.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});u.b.log('Generating key-session request for "'+n+'" init data type');i.mediaKeysSessionInitialized=!0;e.generateRequest(n,t).then(function(){u.b.debug("Key-session generation succeeded")}).catch(function(n){u.b.error("Error generating key-session request:",n);o.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},n._createLicenseXhr=function(n,t,i){var r=new XMLHttpRequest,f;if(r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,n,t,i),f=this._licenseXhrSetup,f)try{f.call(this.hls,r,n);f=void 0}catch(n){u.b.error(n)}try{r.readyState||r.open("POST",n,!0);f&&f.call(this.hls,r,n)}catch(n){throw new Error("issue setting up KeySystem license XHR "+n);}return r},n._onLicenseRequestReadyStageChange=function(n,t,i,e){var o,s,h;switch(n.readyState){case 4:if(200===n.status){if(this._requestLicenseFailureCount=0,u.b.log("License request succeeded"),o=n.response,s=this._licenseResponseCallback,s)try{o=s.call(this.hls,n,t)}catch(n){u.b.error(n)}e(o)}else{if(u.b.error("License Request XHR failed ("+t+"). Status: "+n.status+" ("+n.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});h=4-this._requestLicenseFailureCount;u.b.warn("Retrying license request, "+h+" attempts left");this._requestLicense(i,e)}}},n._generateLicenseRequestChallenge=function(n,t){switch(n.mediaKeySystemDomain){case ut.WIDEVINE:return t}throw new Error("unsupported key-system: "+n.mediaKeySystemDomain);},n._requestLicense=function(n,t){var i,e,o,s;if(u.b.log("Requesting content license for key-system"),i=this._mediaKeysList[0],!i)return u.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{e=this.getLicenseServerUrl(i.mediaKeySystemDomain);o=this._createLicenseXhr(e,n,t);u.b.log("Sending license request to URL: "+e);s=this._generateLicenseRequestChallenge(i,n);o.send(s)}catch(n){u.b.error("Failure requesting DRM license: "+n);this.hls.trigger(r.a.ERROR,{type:f.b.KEY_SYSTEM_ERROR,details:f.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},n.onMediaAttached=function(n,t){if(this._emeEnabled){var i=t.media;this._media=i;i.addEventListener("encrypted",this._onMediaEncrypted)}},n.onMediaDetached=function(){var n=this._media,t=this._mediaKeysList;n&&(n.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(n){if(n.mediaKeysSession)return n.mediaKeysSession.close().catch(function(){})})).then(function(){return n.setMediaKeys(null)}).catch(function(){}))},n.onManifestParsed=function(n,t){if(this._emeEnabled){var i=t.levels.map(function(n){return n.audioCodec}).filter(function(n){return!!n}),r=t.levels.map(function(n){return n.videoCodec}).filter(function(n){return!!n});this._attemptKeySystemAccess(ut.WIDEVINE,i,r)}},i=t,(e=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&so(i.prototype,e),o&&so(i,o),t}();!function(n){n.MANIFEST="m";n.AUDIO="a";n.VIDEO="v";n.MUXED="av";n.INIT="i";n.CAPTION="c";n.TIMED_TEXT="tt";n.KEY="k";n.OTHER="o"}(v||(v={})),function(n){n.DASH="d";n.HLS="h";n.SMOOTH="s";n.OTHER="o"}(or||(or={})),function(n){n.VOD="v";n.LIVE="l"}(ho||(ho={}));var uc=function(){function n(t){var i=this,f,r;this.hls=void 0;this.config=void 0;this.media=void 0;this.sid=void 0;this.cid=void 0;this.useHeaders=!1;this.initialized=!1;this.starved=!1;this.buffering=!0;this.audioBuffer=void 0;this.videoBuffer=void 0;this.onWaiting=function(){i.initialized&&(i.starved=!0);i.buffering=!0};this.onPlaying=function(){i.initialized||(i.initialized=!0);i.buffering=!1};this.applyPlaylistData=function(n){try{i.apply(n,{ot:v.MANIFEST,su:!i.initialized})}catch(n){u.b.warn("Could not generate manifest CMCD data.",n)}};this.applyFragmentData=function(n){try{var f=n.frag,e=i.hls.levels[f.level],t=i.getObjectType(f),r={d:1e3*f.duration,ot:t};t!==v.VIDEO&&t!==v.AUDIO&&t!=v.MUXED||(r.br=e.bitrate/1e3,r.tb=i.getTopBandwidth(t)/1e3,r.bl=i.getBufferLength(t));i.apply(n,r)}catch(n){u.b.warn("Could not generate segment CMCD data.",n)}};this.hls=t;f=this.config=t.config;r=f.cmcd;null!=r&&(f.pLoader=this.createPlaylistLoader(),f.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||n.uuid(),this.cid=r.contentId,this.useHeaders=!0===r.useHeaders,this.registerListeners())}var t=n.prototype;return t.registerListeners=function(){var n=this.hls;n.on(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.on(r.a.MEDIA_DETACHED,this.onMediaDetached,this);n.on(r.a.BUFFER_CREATED,this.onBufferCreated,this)},t.unregisterListeners=function(){var n=this.hls;n.off(r.a.MEDIA_ATTACHED,this.onMediaAttached,this);n.off(r.a.MEDIA_DETACHED,this.onMediaDetached,this);n.off(r.a.BUFFER_CREATED,this.onBufferCreated,this);this.onMediaDetached()},t.destroy=function(){this.unregisterListeners();this.hls=this.config=this.audioBuffer=this.videoBuffer=null},t.onMediaAttached=function(n,t){this.media=t.media;this.media.addEventListener("waiting",this.onWaiting);this.media.addEventListener("playing",this.onPlaying)},t.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},t.onBufferCreated=function(n,t){var i,r;this.audioBuffer=null===(i=t.tracks.audio)||void 0===i?void 0:i.buffer;this.videoBuffer=null===(r=t.tracks.video)||void 0===r?void 0:r.buffer},t.createData=function(){var n;return{v:1,sf:or.HLS,sid:this.sid,cid:this.cid,pr:null===(n=this.media)||void 0===n?void 0:n.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},t.apply=function(t,i){var f,r,u;if(void 0===i&&(i={}),sr(i,this.createData()),f=i.ot===v.INIT||i.ot===v.VIDEO||i.ot===v.MUXED,this.starved&&f&&(i.bs=!0,i.su=!0,this.starved=!1),null==i.su&&(i.su=this.buffering),this.useHeaders){if(r=n.toHeaders(i),!Object.keys(r).length)return;t.headers||(t.headers={});sr(t.headers,r)}else{if(u=n.toQuery(i),!u)return;t.url=n.appendQueryToUri(t.url,u)}},t.getObjectType=function(n){var t=n.type;return"subtitle"===t?v.TIMED_TEXT:"initSegment"===n.sn?v.INIT:"audio"===t?v.AUDIO:"main"===t?this.hls.audioTracks.length?v.VIDEO:v.MUXED:void 0},t.getTopBandwidth=function(n){var r,t=0,i=this.hls,u,e,o,s,f;for(n===v.AUDIO?r=i.audioTracks:(u=i.maxAutoLevel,e=u>-1?u+1:i.levels.length,r=i.levels.slice(0,e)),s=vo(r);!(o=s()).done;)f=o.value,f.bitrate>t&&(t=f.bitrate);return t>0?t:NaN},t.getBufferLength=function(n){var t=this.hls.media,i=n===v.AUDIO?this.audioBuffer:this.videoBuffer;return i&&t?1e3*c.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len:NaN},t.createPlaylistLoader=function(){var n=this.config.pLoader,t=this.applyPlaylistData,i=n||this.config.loader;return function(){function n(n){this.loader=void 0;this.loader=new i(n)}var r=n.prototype;return r.destroy=function(){this.loader.destroy()},r.abort=function(){this.loader.abort()},r.load=function(n,i,r){t(n);this.loader.load(n,i,r)},ao(n,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),n}()},t.createFragmentLoader=function(){var n=this.config.fLoader,t=this.applyFragmentData,i=n||this.config.loader;return function(){function n(n){this.loader=void 0;this.loader=new i(n)}var r=n.prototype;return r.destroy=function(){this.loader.destroy()},r.abort=function(){this.loader.abort()},r.load=function(n,i,r){t(n);this.loader.load(n,i,r)},ao(n,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),n}()},n.uuid=function(){var n=URL.createObjectURL(new Blob),t=n.toString();return URL.revokeObjectURL(n),t.substr(t.lastIndexOf("/")+1)},n.serialize=function(n){for(var t,i,f,e,o,s,h=[],c=function(n){return!Number.isNaN(n)&&null!=n&&""!==n&&!1!==n},r=function(n){return Math.round(n)},u=function(n){return 100*r(n/100)},l={br:r,d:r,bl:u,dl:u,mtp:u,nor:function(n){return encodeURIComponent(n)},rtp:u,tb:r},a=vo(Object.keys(n||{}).sort());!(s=a()).done;)t=s.value,i=n[t],!c(i)||"v"===t&&1===i||"pr"==t&&1===i||(f=l[t],f&&(i=f(i)),e=typeof i,o=void 0,o="ot"===t||"sf"===t||"st"===t?t+"="+i:"boolean"===e?t:"number"===e?t+"="+i:t+"="+JSON.stringify(i),h.push(o));return h.join(",")},n.toHeaders=function(t){for(var i,r,e,o={},c=["Object","Request","Session","Status"],u=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},f=0,h=Object.keys(t);f<h.length;f++)i=h[f],u[null!=s[i]?s[i]:1][i]=t[i];for(r=0;r<u.length;r++)e=n.serialize(u[r]),e&&(o["CMCD-"+c[r]]=e);return o},n.toQuery=function(t){return"CMCD="+encodeURIComponent(n.serialize(t))},n.appendQueryToUri=function(n,t){if(!t)return n;var i=n.includes("?")?"&":"?";return""+n+i+t},n}(),po=i(12),fc=/^age:\s*[\d.]+\s*$/m,wo=function(){function t(n){this.xhrSetup=void 0;this.requestTimeout=void 0;this.retryTimeout=void 0;this.retryDelay=void 0;this.config=null;this.callbacks=null;this.context=void 0;this.loader=null;this.stats=void 0;this.xhrSetup=n?n.xhrSetup:null;this.stats=new po.a;this.retryDelay=0}var n=t.prototype;return n.destroy=function(){this.callbacks=null;this.abortInternal();this.loader=null;this.config=null},n.abortInternal=function(){var n=this.loader;self.clearTimeout(this.requestTimeout);self.clearTimeout(this.retryTimeout);n&&(n.onreadystatechange=null,n.onprogress=null,4!==n.readyState&&(this.stats.aborted=!0,n.abort()))},n.abort=function(){var n;this.abortInternal();null!==(n=this.callbacks)&&void 0!==n&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},n.load=function(n,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now();this.context=n;this.config=t;this.callbacks=i;this.retryDelay=t.retryDelay;this.loadInternal()},n.loadInternal=function(){var u=this.config,t=this.context,n,f,i,r,e;if(u){n=this.loader=new self.XMLHttpRequest;f=this.stats;f.loading.first=0;f.loaded=0;i=this.xhrSetup;try{if(i)try{i(n,t.url)}catch(u){n.open("GET",t.url,!0);i(n,t.url)}if(n.readyState||n.open("GET",t.url,!0),r=this.context.headers,r)for(e in r)n.setRequestHeader(e,r[e])}catch(u){return void this.callbacks.onError({code:n.status,text:u.message},t,n)}t.rangeEnd&&n.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1));n.onreadystatechange=this.readystatechange.bind(this);n.onprogress=this.loadprogress.bind(this);n.responseType=t.responseType;self.clearTimeout(this.requestTimeout);this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),u.timeout);n.send()}},n.readystatechange=function(){var r=this.context,n=this.loader,t=this.stats,o,f,i,e,h,s,c;if(r&&n&&(o=n.readyState,f=this.config,!t.aborted&&o>=2))if(self.clearTimeout(this.requestTimeout),0===t.loading.first&&(t.loading.first=Math.max(self.performance.now(),t.loading.start)),4===o)if(n.onreadystatechange=null,n.onprogress=null,i=n.status,i>=200&&i<300){if(t.loading.end=Math.max(self.performance.now(),t.loading.first),h="arraybuffer"===r.responseType?(e=n.response).byteLength:(e=n.responseText).length,t.loaded=t.total=h,!this.callbacks)return;if(s=this.callbacks.onProgress,s&&s(t,r,e,n),!this.callbacks)return;c={url:n.responseURL,data:e};this.callbacks.onSuccess(c,t,r,n)}else t.retry>=f.maxRetry||i>=400&&i<499?(u.b.error(i+" while loading "+r.url),this.callbacks.onError({code:i,text:n.statusText},r,n)):(u.b.warn(i+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,f.maxRetryDelay),t.retry++);else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),f.timeout)},n.loadtimeout=function(){u.b.warn("timeout while loading "+this.context.url);var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))},n.loadprogress=function(n){var t=this.stats;t.loaded=n.loaded;n.lengthComputable&&(t.total=n.total)},n.getCacheAge=function(){var t=null,n;return this.loader&&fc.test(this.loader.getAllResponseHeaders())&&(n=this.loader.getResponseHeader("age"),t=n?parseFloat(n):null),t},t}();ts=function(){function t(n){this.fetchSetup=void 0;this.requestTimeout=void 0;this.request=void 0;this.response=void 0;this.controller=void 0;this.context=void 0;this.config=null;this.callbacks=null;this.stats=void 0;this.loader=null;this.fetchSetup=n.fetchSetup||oc;this.controller=new self.AbortController;this.stats=new po.a}var n=t.prototype;return n.destroy=function(){this.loader=this.callbacks=null;this.abortInternal()},n.abortInternal=function(){var n=this.response;n&&n.ok||(this.stats.aborted=!0,this.controller.abort())},n.abort=function(){var n;this.abortInternal();null!==(n=this.callbacks)&&void 0!==n&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},n.load=function(n,t,i){var u=this,r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();var s=function(n,t){var i={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(ns({},n.headers))};return n.rangeEnd&&i.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),i}(n,this.controller.signal),f=i.onProgress,e="arraybuffer"===n.responseType,h=e?"byteLength":"length";this.context=n;this.config=t;this.callbacks=i;this.request=this.fetchSetup(n,s);self.clearTimeout(this.requestTimeout);this.requestTimeout=self.setTimeout(function(){u.abortInternal();i.onTimeout(r,n,u.response)},t.timeout);self.fetch(this.request).then(function(i){if(u.response=u.loader=i,!i.ok){var s=i.status,h=i.statusText;throw new sc(h||"fetch, bad network response",s,i);}return r.loading.first=Math.max(self.performance.now(),r.loading.start),r.total=parseInt(i.headers.get("Content-Length")||"0"),f&&Object(o.a)(t.highWaterMark)?u.loadProgressively(i,r,n,t.highWaterMark,f):e?i.arrayBuffer():i.text()}).then(function(e){var s=u.response,c;self.clearTimeout(u.requestTimeout);r.loading.end=Math.max(self.performance.now(),r.loading.first);r.loaded=r.total=e[h];c={url:s.url,data:e};f&&!Object(o.a)(t.highWaterMark)&&f(r,n,e,s);i.onSuccess(c,r,n,s)}).catch(function(t){if(self.clearTimeout(u.requestTimeout),!r.aborted){var f=t.code||0;i.onError({code:f,text:t.message},n,t.details)}})},n.getCacheAge=function(){var t=null,n;return this.response&&(n=this.response.headers.get("age"),t=n?parseFloat(n):null),t},n.loadProgressively=function(n,t,i,r,u){void 0===r&&(r=0);var f=new ki.a,e=n.body.getReader();return function o(){return e.read().then(function(e){if(e.done)return f.dataLength&&u(t,i,f.flush(),n),Promise.resolve(new ArrayBuffer(0));var s=e.value,h=s.length;return t.loaded+=h,h<r||f.dataLength?(f.push(s),f.dataLength>=r&&u(t,i,f.flush(),n)):u(t,i,s,n),o()}).catch(function(){return Promise.reject()})}()},t}();var sc=function(n){function r(t,i,r){var u;return(u=n.call(this,t)||this).code=void 0,u.details=void 0,u.code=i,u.details=r,u}var t,i;return i=n,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,ni(t,i),r}(bo(Error)),is=ts,hc=/\s/;es=fs(fs({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:wo,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:yf,bufferController:sh,capLevelController:fo,fpsController:eo,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:oo,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},{cueHandler:{newCue:function(n,t,i,r){for(var s,a,v,f,e,c,u,l,o=[],y=self.VTTCue||self.TextTrackCue,h=0;h<r.rows.length;h++)if(c=!0,u=0,l="",!(f=r.rows[h]).isEmpty()){for(s=0;s<f.chars.length;s++)hc.test(f.chars[s].uchar)&&c?u++:(l+=f.chars[s].uchar,c=!1);f.cueStartTime=t;t===i&&(i+=.0001);u>=16?u--:u++;a=pe(l.trim());v=ur(t,i,a);n&&n.cues&&n.cues.getCueById(v)||((e=new y(t,i,a)).id=v,e.line=h+1,e.align="left",e.position=10+Math.min(80,10*Math.floor(u/4)),o.push(e))}return n&&o.length&&(o.sort(function(n,t){return"auto"===n.line||"auto"===t.line?0:n.line>8&&t.line>8?t.line-n.line:n.line-t.line}),o.forEach(function(t){return nu(n,t)})),o}},enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:te,subtitleTrackController:eh,timelineController:ro,audioStreamController:wf,audioTrackController:df,emeController:co,cmcdController:uc});hr=function(){function t(n){var i,r,f;void 0===n&&(n={});this.config=void 0;this.userConfig=void 0;this.coreComponents=void 0;this.networkControllers=void 0;this._emitter=new hf.EventEmitter;this._autoLevelCapping=void 0;this.abrController=void 0;this.bufferController=void 0;this.capLevelController=void 0;this.latencyController=void 0;this.levelController=void 0;this.streamController=void 0;this.audioTrackController=void 0;this.subtitleTrackController=void 0;this.emeController=void 0;this.cmcdController=void 0;this._media=null;this.url=null;i=this.config=function(n,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return rs({},n,t)}(t.DefaultConfig,n);this.userConfig=n;Object(u.a)(i.debug);this._autoLevelCapping=-1;i.progressive&&lc(i);var c=i.abrController,l=i.bufferController,a=i.capLevelController,v=i.fpsController,y=this.abrController=new c(this),p=this.bufferController=new l(this),s=this.capLevelController=new a(this),h=new v(this),w=new kr(this),b=new dr(this),k=new tu(this),d=this.levelController=new vu(this),e=new yu(this),o=this.streamController=new uh(this,e);s.setStreamController(o);h.setStreamController(o);r=[d,o];this.networkControllers=r;f=[w,b,y,p,s,h,k,e];this.audioTrackController=this.createController(i.audioTrackController,null,r);this.createController(i.audioStreamController,e,r);this.subtitleTrackController=this.createController(i.subtitleTrackController,null,r);this.createController(i.subtitleStreamController,e,r);this.createController(i.timelineController,null,f);this.emeController=this.createController(i.emeController,null,f);this.cmcdController=this.createController(i.cmcdController,null,f);this.latencyController=this.createController(ru,null,f);this.coreComponents=f}t.isSupported=function(){return function(){var n=wi();if(!n)return!1;var t=sf(),i=n&&"function"==typeof n.isTypeSupported&&n.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!r}()};var i,o,e,n=t.prototype;return n.createController=function(n,t,i){if(n){var r=t?new n(this,t):new n(this);return i&&i.push(r),r}return null},n.on=function(n,t,i){void 0===i&&(i=this);this._emitter.on(n,t,i)},n.once=function(n,t,i){void 0===i&&(i=this);this._emitter.once(n,t,i)},n.removeAllListeners=function(n){this._emitter.removeAllListeners(n)},n.off=function(n,t,i,r){void 0===i&&(i=this);this._emitter.off(n,t,i,r)},n.listeners=function(n){return this._emitter.listeners(n)},n.emit=function(n,t,i){return this._emitter.emit(n,t,i)},n.trigger=function(n,t){if(this.config.debug)return this.emit(n,n,t);try{return this.emit(n,n,t)}catch(t){u.b.error("An internal error happened while handling event "+n+'. Error message: "'+t.message+'". Here is a stacktrace:',t);this.trigger(r.a.ERROR,{type:f.b.OTHER_ERROR,details:f.a.INTERNAL_EXCEPTION,fatal:!1,event:n,error:t})}return!1},n.listenerCount=function(n){return this._emitter.listenerCount(n)},n.destroy=function(){u.b.log("destroy");this.trigger(r.a.DESTROYING,void 0);this.detachMedia();this.removeAllListeners();this._autoLevelCapping=-1;this.url=null;this.networkControllers.forEach(function(n){return n.destroy()});this.networkControllers.length=0;this.coreComponents.forEach(function(n){return n.destroy()});this.coreComponents.length=0},n.attachMedia=function(n){u.b.log("attachMedia");this._media=n;this.trigger(r.a.MEDIA_ATTACHING,{media:n})},n.detachMedia=function(){u.b.log("detachMedia");this.trigger(r.a.MEDIA_DETACHING,void 0);this._media=null},n.loadSource=function(n){this.stopLoad();var t=this.media,i=this.url,f=this.url=ti.buildAbsoluteURL(self.location.href,n,{alwaysNormalize:!0});u.b.log("loadSource:"+f);t&&i&&i!==f&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(t));this.trigger(r.a.MANIFEST_LOADING,{url:n})},n.startLoad=function(n){void 0===n&&(n=-1);u.b.log("startLoad("+n+")");this.networkControllers.forEach(function(t){t.startLoad(n)})},n.stopLoad=function(){u.b.log("stopLoad");this.networkControllers.forEach(function(n){n.stopLoad()})},n.swapAudioCodec=function(){u.b.log("swapAudioCodec");this.streamController.swapAudioCodec()},n.recoverMediaError=function(){u.b.log("recoverMediaError");var n=this._media;this.detachMedia();n&&this.attachMedia(n)},n.removeLevel=function(n,t){void 0===t&&(t=0);this.levelController.removeLevel(n,t)},i=t,e=[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return r.a}},{key:"ErrorTypes",get:function(){return f.b}},{key:"ErrorDetails",get:function(){return f.a}},{key:"DefaultConfig",get:function(){return t.defaultConfig?t.defaultConfig:es},set:function(n){t.defaultConfig=n}}],(o=[{key:"levels",get:function(){var n=this.levelController.levels;return n||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(n){u.b.log("set currentLevel:"+n);this.loadLevel=n;this.abrController.clearTimer();this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(n){u.b.log("set nextLevel:"+n);this.levelController.manualLevel=n;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(n){u.b.log("set loadLevel:"+n);this.levelController.manualLevel=n}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(n){this.levelController.nextLoadLevel=n}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(n){u.b.log("set firstLevel:"+n);this.levelController.firstLevel=n}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(n){u.b.log("set startLevel:"+n);-1!==n&&(n=Math.max(n,this.minAutoLevel));this.levelController.startLevel=n}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(n){var t=!!n;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(n){this._autoLevelCapping!==n&&(u.b.log("set autoLevelCapping:"+n),this._autoLevelCapping=n)}},{key:"bandwidthEstimate",get:function(){var n=this.abrController.bwEstimator;return n?n.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var t=this.levels,r=this.config.minAutoBitrate,i,n;if(!t)return 0;for(i=t.length,n=0;n<i;n++)if(t[n].maxBitrate>r)return n;return 0}},{key:"maxAutoLevel",get:function(){var n=this.levels,t=this.autoLevelCapping;return-1===t&&n&&n.length?n.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(n){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,n)}},{key:"audioTracks",get:function(){var n=this.audioTrackController;return n?n.audioTracks:[]}},{key:"audioTrack",get:function(){var n=this.audioTrackController;return n?n.audioTrack:-1},set:function(n){var t=this.audioTrackController;t&&(t.audioTrack=n)}},{key:"subtitleTracks",get:function(){var n=this.subtitleTrackController;return n?n.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var n=this.subtitleTrackController;return n?n.subtitleTrack:-1},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleTrack=n)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var n=this.subtitleTrackController;return!!n&&n.subtitleDisplay},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=n)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(n){this.config.lowLatencyMode=n}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&os(i.prototype,o),e&&os(i,e),t}();hr.defaultConfig=void 0}]).default}),function(){var n,i,u,f,e,o,t,s,r=[].slice,h={}.hasOwnProperty,c=function(n,t){function r(){this.constructor=n}for(var i in t)h.call(t,i)&&(n[i]=t[i]);return r.prototype=t.prototype,n.prototype=new r,n.__super__=t.prototype,n};t=function(){};i=function(){function n(){}return n.prototype.addEventListener=n.prototype.on,n.prototype.on=function(n,t){return this._callbacks=this._callbacks||{},this._callbacks[n]||(this._callbacks[n]=[]),this._callbacks[n].push(t),this},n.prototype.emit=function(){var i,u,n,f,t,e;if(f=arguments[0],i=2<=arguments.length?r.call(arguments,1):[],this._callbacks=this._callbacks||{},n=this._callbacks[f],n)for(t=0,e=n.length;t<e;t++)u=n[t],u.apply(this,i);return this},n.prototype.removeListener=n.prototype.off,n.prototype.removeAllListeners=n.prototype.off,n.prototype.removeEventListener=n.prototype.off,n.prototype.off=function(n,t){var f,i,r,u,e;if(!this._callbacks||arguments.length===0)return this._callbacks={},this;if(i=this._callbacks[n],!i)return this;if(arguments.length===1)return delete this._callbacks[n],this;for(r=u=0,e=i.length;u<e;r=++u)if(f=i[r],f===t){i.splice(r,1);break}return this},n}();n=function(n){function u(n,t){var r,i,e;if(this.element=n,this.version=u.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],typeof this.element=="string"&&(this.element=document.querySelector(this.element)),!(this.element&&this.element.nodeType!=null))throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(u.instances.push(this),this.element.dropzone=this,r=(e=u.optionsForElement(this.element))!=null?e:{},this.options=f({},this.defaultOptions,r,t!=null?t:{}),this.options.forceFallback||!u.isBrowserSupported())return this.options.fallback.call(this);if(this.options.url==null&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes);this.options.method=this.options.method.toUpperCase();(i=this.getExistingFallback())&&i.parentNode&&i.parentNode.removeChild(i);this.options.previewsContainer!==!1&&(this.previewsContainer=this.options.previewsContainer?u.getElement(this.options.previewsContainer,"previewsContainer"):this.element);this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:u.getElements(this.options.clickable,"clickable"));this.init()}var f,e;return c(u,n),u.prototype.Emitter=i,u.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],u.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(n,t){return t()},init:function(){return t},forceFallback:!1,fallback:function(){var i,t,n,r,e,f;for(this.element.className=""+this.element.className+" dz-browser-not-supported",f=this.element.getElementsByTagName("div"),r=0,e=f.length;r<e;r++)if(i=f[r],/(^| )dz-message($| )/.test(i.className)){t=i;i.className="dz-message";continue}return t||(t=u.createElement('<div class="dz-message"><span><\/span><\/div>'),this.element.appendChild(t)),n=t.getElementsByTagName("span")[0],n&&(n.textContent!=null?n.textContent=this.options.dictFallbackMessage:n.innerText!=null&&(n.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(n){var t,i,r;return t={srcX:0,srcY:0,srcWidth:n.width,srcHeight:n.height},i=n.width/n.height,t.optWidth=this.options.thumbnailWidth,t.optHeight=this.options.thumbnailHeight,t.optWidth==null&&t.optHeight==null?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):t.optWidth==null?t.optWidth=i*t.optHeight:t.optHeight==null&&(t.optHeight=1/i*t.optWidth),r=t.optWidth/t.optHeight,n.height<t.optHeight||n.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>r?(t.srcHeight=n.height,t.srcWidth=t.srcHeight*r):(t.srcWidth=n.width,t.srcHeight=t.srcWidth/r),t.srcX=(n.width-t.srcWidth)/2,t.srcY=(n.height-t.srcHeight)/2,t},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:t,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},paste:t,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(n){var t,c,l,i,r,f,a,v,y,e,o,s,h;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(n.previewElement=u.createElement(this.options.previewTemplate.trim()),n.previewTemplate=n.previewElement,this.previewsContainer.appendChild(n.previewElement),e=n.previewElement.querySelectorAll("[data-dz-name]"),i=0,a=e.length;i<a;i++)t=e[i],t.textContent=this._renameFilename(n.name);for(o=n.previewElement.querySelectorAll("[data-dz-size]"),r=0,v=o.length;r<v;r++)t=o[r],t.innerHTML=this.filesize(n.size);for(this.options.addRemoveLinks&&(n._removeLink=u.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"<\/a>"),n.previewElement.appendChild(n._removeLink)),c=function(t){return function(i){return i.preventDefault(),i.stopPropagation(),n.status===u.UPLOADING?u.confirm(t.options.dictCancelUploadConfirmation,function(){return t.removeFile(n)}):t.options.dictRemoveFileConfirmation?u.confirm(t.options.dictRemoveFileConfirmation,function(){return t.removeFile(n)}):t.removeFile(n)}}(this),s=n.previewElement.querySelectorAll("[data-dz-remove]"),h=[],f=0,y=s.length;f<y;f++)l=s[f],h.push(l.addEventListener("click",c));return h}},removedfile:function(n){var t;return n.previewElement&&(t=n.previewElement)!=null&&t.parentNode.removeChild(n.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(n,t){var r,i,f,u;if(n.previewElement){for(n.previewElement.classList.remove("dz-file-preview"),u=n.previewElement.querySelectorAll("[data-dz-thumbnail]"),i=0,f=u.length;i<f;i++)r=u[i],r.alt=n.name,r.src=t;return setTimeout(function(){return function(){return n.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(n,t){var f,i,e,r,u;if(n.previewElement){for(n.previewElement.classList.add("dz-error"),typeof t!="String"&&t.error&&(t=t.error),r=n.previewElement.querySelectorAll("[data-dz-errormessage]"),u=[],i=0,e=r.length;i<e;i++)f=r[i],u.push(f.textContent=t);return u}},errormultiple:t,processing:function(n){if(n.previewElement&&(n.previewElement.classList.add("dz-processing"),n._removeLink))return n._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:t,uploadprogress:function(n,t){var i,r,e,f,u;if(n.previewElement){for(f=n.previewElement.querySelectorAll("[data-dz-uploadprogress]"),u=[],r=0,e=f.length;r<e;r++)i=f[r],i.nodeName==="PROGRESS"?u.push(i.value=t):u.push(i.style.width=""+t+"%");return u}},totaluploadprogress:t,sending:t,sendingmultiple:t,success:function(n){if(n.previewElement)return n.previewElement.classList.add("dz-success")},successmultiple:t,canceled:function(n){return this.emit("error",n,"Upload canceled.")},canceledmultiple:t,complete:function(n){return n._removeLink&&(n._removeLink.textContent=this.options.dictRemoveFile),n.previewElement?n.previewElement.classList.add("dz-complete"):void 0},completemultiple:t,maxfilesexceeded:t,maxfilesreached:t,queuecomplete:t,addedfiles:t,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><Image data-dz-thumbnail /><\/div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size><\/span><\/div>\n    <div class="dz-filename"><span data-dz-name><\/span><\/div>\n  <\/div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress><\/span><\/div>\n  <div class="dz-error-message"><span data-dz-errormessage><\/span><\/div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check<\/title>\n      <defs><\/defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"><\/path>\n      <\/g>\n    <\/svg>\n  <\/div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error<\/title>\n      <defs><\/defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"><\/path>\n        <\/g>\n      <\/g>\n    <\/svg>\n  <\/div>\n<\/div>'},f=function(){var t,i,u,f,e,n,o;for(f=arguments[0],u=2<=arguments.length?r.call(arguments,1):[],n=0,o=u.length;n<o;n++){i=u[n];for(t in i)e=i[t],f[t]=e}return f},u.prototype.getAcceptedFiles=function(){var t,n,u,i,r;for(i=this.files,r=[],n=0,u=i.length;n<u;n++)t=i[n],t.accepted&&r.push(t);return r},u.prototype.getRejectedFiles=function(){var t,n,u,i,r;for(i=this.files,r=[],n=0,u=i.length;n<u;n++)t=i[n],t.accepted||r.push(t);return r},u.prototype.getFilesWithStatus=function(n){var i,t,f,r,u;for(r=this.files,u=[],t=0,f=r.length;t<f;t++)i=r[t],i.status===n&&u.push(i);return u},u.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(u.QUEUED)},u.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(u.UPLOADING)},u.prototype.getAddedFiles=function(){return this.getFilesWithStatus(u.ADDED)},u.prototype.getActiveFiles=function(){var n,t,f,i,r;for(i=this.files,r=[],t=0,f=i.length;t<f;t++)n=i[t],(n.status===u.UPLOADING||n.status===u.QUEUED)&&r.push(n);return r},u.prototype.init=function(){var i,n,r,t,e,o,f;for(this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(u.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"<\/span><\/div>")),this.clickableElements.length&&(r=function(n){return function(){return n.hiddenFileInput&&n.hiddenFileInput.parentNode.removeChild(n.hiddenFileInput),n.hiddenFileInput=document.createElement("input"),n.hiddenFileInput.setAttribute("type","file"),(n.options.maxFiles==null||n.options.maxFiles>1)&&n.hiddenFileInput.setAttribute("multiple","multiple"),n.hiddenFileInput.className="dz-hidden-input",n.options.acceptedFiles!=null&&n.hiddenFileInput.setAttribute("accept",n.options.acceptedFiles),n.options.capture!=null&&n.hiddenFileInput.setAttribute("capture",n.options.capture),n.hiddenFileInput.style.visibility="hidden",n.hiddenFileInput.style.position="absolute",n.hiddenFileInput.style.top="0",n.hiddenFileInput.style.left="0",n.hiddenFileInput.style.height="0",n.hiddenFileInput.style.width="0",document.querySelector(n.options.hiddenInputContainer).appendChild(n.hiddenFileInput),n.hiddenFileInput.addEventListener("change",function(){var u,t,i,f;if(t=n.hiddenFileInput.files,t.length)for(i=0,f=t.length;i<f;i++)u=t[i],n.addFile(u);return n.emit("addedfiles",t),r()})}}(this),r()),this.URL=(o=window.URL)!=null?o:window.webkitURL,f=this.events,t=0,e=f.length;t<e;t++){i=f[t];this.on(i,this.options[i])}this.on("uploadprogress",function(n){return function(){return n.updateTotalUploadProgress()}}(this));this.on("removedfile",function(n){return function(){return n.updateTotalUploadProgress()}}(this));this.on("canceled",function(n){return function(t){return n.emit("complete",t)}}(this));this.on("complete",function(n){return function(){if(n.getAddedFiles().length===0&&n.getUploadingFiles().length===0&&n.getQueuedFiles().length===0)return setTimeout(function(){return n.emit("queuecomplete")},0)}}(this));return n=function(n){return n.stopPropagation(),n.preventDefault?n.preventDefault():n.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(n){return function(t){return n.emit("dragstart",t)}}(this),dragenter:function(t){return function(i){return n(i),t.emit("dragenter",i)}}(this),dragover:function(t){return function(i){var r;try{r=i.dataTransfer.effectAllowed}catch(u){}return i.dataTransfer.dropEffect="move"===r||"linkMove"===r?"move":"copy",n(i),t.emit("dragover",i)}}(this),dragleave:function(n){return function(t){return n.emit("dragleave",t)}}(this),drop:function(t){return function(i){return n(i),t.drop(i)}}(this),dragend:function(n){return function(t){return n.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(n){return function(t){return n.listeners.push({element:t,events:{click:function(i){return(t!==n.element||i.target===n.element||u.elementInside(i.target,n.element.querySelector(".dz-message")))&&n.hiddenFileInput.click(),!0}}})}}(this)),this.enable(),this.options.init.call(this)},u.prototype.destroy=function(){var n;return this.disable(),this.removeAllFiles(!0),((n=this.hiddenFileInput)!=null?n.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,u.instances.splice(u.instances.indexOf(this),1)},u.prototype.updateTotalUploadProgress=function(){var e,r,n,t,u,i,o,f;if(t=0,n=0,e=this.getActiveFiles(),e.length){for(f=this.getActiveFiles(),i=0,o=f.length;i<o;i++)r=f[i],t+=r.upload.bytesSent,n+=r.upload.total;u=100*t/n}else u=100;return this.emit("totaluploadprogress",u,n,t)},u.prototype._getParamName=function(n){return typeof this.options.paramName=="function"?this.options.paramName(n):""+this.options.paramName+(this.options.uploadMultiple?"["+n+"]":"")},u.prototype._renameFilename=function(n){return typeof this.options.renameFilename!="function"?n:this.options.renameFilename(n)},u.prototype.getFallbackForm=function(){var r,i,n,t;return(r=this.getExistingFallback())?r:(n='<div class="dz-fallback">',this.options.dictFallbackText&&(n+="<p>"+this.options.dictFallbackText+"<\/p>"),n+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"><\/div>',i=u.createElement(n),this.element.tagName!=="FORM"?(t=u.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"><\/form>'),t.appendChild(i)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),t!=null?t:i)},u.prototype.getExistingFallback=function(){var i,r,u,n,f,t;for(r=function(n){for(var i,t=0,r=n.length;t<r;t++)if(i=n[t],/(^| )fallback($| )/.test(i.className))return i},t=["div","form"],n=0,f=t.length;n<f;n++)if(u=t[n],i=r(this.element.getElementsByTagName(u)))return i},u.prototype.setupEventListeners=function(){var t,i,f,n,e,r,u;for(r=this.listeners,u=[],n=0,e=r.length;n<e;n++)t=r[n],u.push(function(){var n,r;n=t.events;r=[];for(i in n)f=n[i],r.push(t.element.addEventListener(i,f,!1));return r}());return u},u.prototype.removeEventListeners=function(){var t,i,f,n,e,r,u;for(r=this.listeners,u=[],n=0,e=r.length;n<e;n++)t=r[n],u.push(function(){var n,r;n=t.events;r=[];for(i in n)f=n[i],r.push(t.element.removeEventListener(i,f,!1));return r}());return u},u.prototype.disable=function(){var r,n,u,t,i;for(this.clickableElements.forEach(function(n){return n.classList.remove("dz-clickable")}),this.removeEventListeners(),t=this.files,i=[],n=0,u=t.length;n<u;n++)r=t[n],i.push(this.cancelUpload(r));return i},u.prototype.enable=function(){return this.clickableElements.forEach(function(n){return n.classList.add("dz-clickable")}),this.setupEventListeners()},u.prototype.filesize=function(n){var e,t,i,r,o,u,f,s;if(i=0,r="b",n>0){for(u=["TB","GB","MB","KB","b"],t=f=0,s=u.length;f<s;t=++f)if(o=u[t],e=Math.pow(this.options.filesizeBase,4-t)/10,n>=e){i=n/Math.pow(this.options.filesizeBase,4-t);r=o;break}i=Math.round(10*i)/10}return"<strong>"+i+"<\/strong> "+r},u.prototype._updateMaxFilesReachedClass=function(){return this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},u.prototype.drop=function(n){var i,t;n.dataTransfer&&(this.emit("drop",n),i=n.dataTransfer.files,this.emit("addedfiles",i),i.length&&(t=n.dataTransfer.items,t&&t.length&&t[0].webkitGetAsEntry!=null?this._addFilesFromItems(t):this.handleFiles(i)))},u.prototype.paste=function(n){var t,i;if((n!=null?(i=n.clipboardData)!=null?i.items:void 0:void 0)!=null)return this.emit("paste",n),t=n.clipboardData.items,t.length?this._addFilesFromItems(t):void 0},u.prototype.handleFiles=function(n){var r,t,u,i;for(i=[],t=0,u=n.length;t<u;t++)r=n[t],i.push(this.addFile(r));return i},u.prototype._addFilesFromItems=function(n){var r,t,u,f,i;for(i=[],u=0,f=n.length;u<f;u++)t=n[u],t.webkitGetAsEntry!=null&&(r=t.webkitGetAsEntry())?r.isFile?i.push(this.addFile(t.getAsFile())):r.isDirectory?i.push(this._addFilesFromDirectory(r,r.name)):i.push(void 0):t.getAsFile!=null?t.kind==null||t.kind==="file"?i.push(this.addFile(t.getAsFile())):i.push(void 0):i.push(void 0);return i},u.prototype._addFilesFromDirectory=function(n,t){var r,u,i;return r=n.createReader(),u=function(n){if(typeof console!="undefined"&&console!==null)return typeof console.log=="function"?console.log(n):void 0},i=function(n){return function(){return r.readEntries(function(r){var u,f,e;if(r.length>0){for(f=0,e=r.length;f<e;f++)u=r[f],u.isFile?u.file(function(i){if(!n.options.ignoreHiddenFiles||i.name.substring(0,1)!==".")return i.fullPath=""+t+"/"+i.name,n.addFile(i)}):u.isDirectory&&n._addFilesFromDirectory(u,""+t+"/"+u.name);i()}return null},u)}}(this),i()},u.prototype.accept=function(n,t){return n.size>this.options.maxFilesize*1048576?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(n.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):u.isValidFile(n,this.options.acceptedFiles)?this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",n)):this.options.accept.call(this,n,t):t(this.options.dictInvalidFileType)},u.prototype.addFile=function(n){return n.upload={progress:0,total:n.size,bytesSent:0},this.files.push(n),n.status=u.ADDED,this.emit("addedfile",n),this._enqueueThumbnail(n),this.accept(n,function(t){return function(i){return i?(n.accepted=!1,t._errorProcessing([n],i)):(n.accepted=!0,t.options.autoQueue&&t.enqueueFile(n)),t._updateMaxFilesReachedClass()}}(this))},u.prototype.enqueueFiles=function(n){for(var i,t=0,r=n.length;t<r;t++)i=n[t],this.enqueueFile(i);return null},u.prototype.enqueueFile=function(n){if(n.status===u.ADDED&&n.accepted===!0){if(n.status=u.QUEUED,this.options.autoProcessQueue)return setTimeout(function(n){return function(){return n.processQueue()}}(this),0)}else throw new Error("This file can't be queued because it has already been processed or was rejected.");},u.prototype._thumbnailQueue=[],u.prototype._processingThumbnail=!1,u.prototype._enqueueThumbnail=function(n){if(this.options.createImageThumbnails&&n.type.match(/image.*/)&&n.size<=this.options.maxThumbnailFilesize*1048576)return this._thumbnailQueue.push(n),setTimeout(function(n){return function(){return n._processThumbnailQueue()}}(this),0)},u.prototype._processThumbnailQueue=function(){if(!this._processingThumbnail&&this._thumbnailQueue.length!==0)return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(n){return function(){return n._processingThumbnail=!1,n._processThumbnailQueue()}}(this))},u.prototype.removeFile=function(n){return n.status===u.UPLOADING&&this.cancelUpload(n),this.files=s(this.files,n),this.emit("removedfile",n),this.files.length===0?this.emit("reset"):void 0},u.prototype.removeAllFiles=function(n){var i,t,f,r;for(n==null&&(n=!1),r=this.files.slice(),t=0,f=r.length;t<f;t++)i=r[t],(i.status!==u.UPLOADING||n)&&this.removeFile(i);return null},u.prototype.createThumbnail=function(n,t){var i;return i=new FileReader,i.onload=function(r){return function(){if(n.type==="image/svg+xml"){r.emit("thumbnail",n,i.result);t!=null&&t();return}return r.createThumbnailFromUrl(n,i.result,t)}}(this),i.readAsDataURL(n)},u.prototype.createThumbnailFromUrl=function(n,t,i,r){var u;return u=document.createElement("img"),r&&(u.crossOrigin=r),u.onload=function(t){return function(){var f,e,r,s,h,c,l,a;return n.width=u.width,n.height=u.height,r=t.options.resize.call(t,n),r.trgWidth==null&&(r.trgWidth=r.optWidth),r.trgHeight==null&&(r.trgHeight=r.optHeight),f=document.createElement("canvas"),e=f.getContext("2d"),f.width=r.trgWidth,f.height=r.trgHeight,o(e,u,(h=r.srcX)!=null?h:0,(c=r.srcY)!=null?c:0,r.srcWidth,r.srcHeight,(l=r.trgX)!=null?l:0,(a=r.trgY)!=null?a:0,r.trgWidth,r.trgHeight),s=f.toDataURL("image/png"),t.emit("thumbnail",n,s),i!=null?i():void 0}}(this),i!=null&&(u.onerror=i),u.src=t},u.prototype.processQueue=function(){var r,t,i,n;if((t=this.options.parallelUploads,i=this.getUploadingFiles().length,r=i,!(i>=t))&&(n=this.getQueuedFiles(),n.length>0)){if(this.options.uploadMultiple)return this.processFiles(n.slice(0,t-i));while(r<t){if(!n.length)return;this.processFile(n.shift());r++}}},u.prototype.processFile=function(n){return this.processFiles([n])},u.prototype.processFiles=function(n){for(var t,i=0,r=n.length;i<r;i++)t=n[i],t.processing=!0,t.status=u.UPLOADING,this.emit("processing",t);return this.options.uploadMultiple&&this.emit("processingmultiple",n),this.uploadFiles(n)},u.prototype._getFilesWithXhr=function(n){var t;return function(){var i,f,r,u;for(r=this.files,u=[],i=0,f=r.length;i<f;i++)t=r[i],t.xhr===n&&u.push(t);return u}.call(this)},u.prototype.cancelUpload=function(n){var i,t,r,f,e,o,s;if(n.status===u.UPLOADING){for(t=this._getFilesWithXhr(n.xhr),r=0,e=t.length;r<e;r++)i=t[r],i.status=u.CANCELED;for(n.xhr.abort(),f=0,o=t.length;f<o;f++)i=t[f],this.emit("canceled",i);this.options.uploadMultiple&&this.emit("canceledmultiple",t)}else((s=n.status)===u.ADDED||s===u.QUEUED)&&(n.status=u.CANCELED,this.emit("canceled",n),this.options.uploadMultiple&&this.emit("canceledmultiple",[n]));if(this.options.autoProcessQueue)return this.processQueue()},e=function(){var t,n;return(n=arguments[0],t=2<=arguments.length?r.call(arguments,1):[],typeof n=="function")?n.apply(this,t):n},u.prototype.uploadFile=function(n){return this.uploadFiles([n])},u.prototype.uploadFiles=function(n){var i,r,b,k,d,a,h,o,g,nt,tt,ot,it,st,s,rt,ht,ct,t,v,y,p,w,lt,at,vt,yt,c,pt,ut,ft,et,wt,l;for(t=new XMLHttpRequest,v=0,lt=n.length;v<lt;v++)i=n[v],i.xhr=t;ot=e(this.options.method,n);ht=e(this.options.url,n);t.open(ot,ht,!0);t.withCredentials=!!this.options.withCredentials;s=null;b=function(r){return function(){var u,e,f;for(f=[],u=0,e=n.length;u<e;u++)i=n[u],f.push(r._errorProcessing(n,s||r.options.dictResponseError.replace("{{statusCode}}",t.status),t));return f}}(this);rt=function(t){return function(r){var s,u,f,e,o,c,l,a,h;if(r!=null)for(u=100*r.loaded/r.total,f=0,c=n.length;f<c;f++)i=n[f],i.upload={progress:u,total:r.total,bytesSent:r.loaded};else{for(s=!0,u=100,e=0,l=n.length;e<l;e++)i=n[e],i.upload.progress===100&&i.upload.bytesSent===i.upload.total||(s=!1),i.upload.progress=u,i.upload.bytesSent=i.upload.total;if(s)return}for(h=[],o=0,a=n.length;o<a;o++)i=n[o],h.push(t.emit("uploadprogress",i,u,i.upload.bytesSent));return h}}(this);t.onload=function(i){return function(r){var f;if(n[0].status!==u.CANCELED&&t.readyState===4){if(s=t.responseText,t.getResponseHeader("content-type")&&~t.getResponseHeader("content-type").indexOf("application/json"))try{s=JSON.parse(s)}catch(e){r=e;s="Invalid JSON response from server."}return rt(),200<=(f=t.status)&&f<300?i._finished(n,s,r):b()}}}(this);t.onerror=function(){return function(){if(n[0].status!==u.CANCELED)return b()}}(this);st=(pt=t.upload)!=null?pt:t;st.onprogress=rt;a={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};this.options.headers&&f(a,this.options.headers);for(k in a)d=a[k],d&&t.setRequestHeader(k,d);if(r=new FormData,this.options.params){ut=this.options.params;for(tt in ut)ct=ut[tt],r.append(tt,ct)}for(y=0,at=n.length;y<at;y++)i=n[y],this.emit("sending",i,t,r);if(this.options.uploadMultiple&&this.emit("sendingmultiple",n,t,r),this.element.tagName==="FORM")for(ft=this.element.querySelectorAll("input, textarea, select, button"),p=0,vt=ft.length;p<vt;p++)if(o=ft[p],g=o.getAttribute("name"),nt=o.getAttribute("type"),o.tagName==="SELECT"&&o.hasAttribute("multiple"))for(et=o.options,w=0,yt=et.length;w<yt;w++)it=et[w],it.selected&&r.append(g,it.value);else(!nt||(wt=nt.toLowerCase())!=="checkbox"&&wt!=="radio"||o.checked)&&r.append(g,o.value);for(h=c=0,l=n.length-1;0<=l?c<=l:c>=l;h=0<=l?++c:--c)r.append(this._getParamName(h),n[h],this._renameFilename(n[h].name));return this.submitRequest(t,r,n)},u.prototype.submitRequest=function(n,t){return n.send(t)},u.prototype._finished=function(n,t,i){for(var r,f=0,e=n.length;f<e;f++)r=n[f],r.status=u.SUCCESS,this.emit("success",r,t,i),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("successmultiple",n,t,i),this.emit("completemultiple",n)),this.options.autoProcessQueue?this.processQueue():void 0},u.prototype._errorProcessing=function(n,t,i){for(var r,f=0,e=n.length;f<e;f++)r=n[f],r.status=u.ERROR,this.emit("error",r,t,i),this.emit("complete",r);return this.options.uploadMultiple&&(this.emit("errormultiple",n,t,i),this.emit("completemultiple",n)),this.options.autoProcessQueue?this.processQueue():void 0},u}(i);n.version="4.3.0";n.options={};n.optionsForElement=function(t){if(t.getAttribute("id"))return n.options[u(t.getAttribute("id"))]};n.instances=[];n.forElement=function(n){if(typeof n=="string"&&(n=document.querySelector(n)),(n!=null?n.dropzone:void 0)==null)throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return n.dropzone};n.autoDiscover=!0;n.discover=function(){var u,f,t,i,e,r;for(document.querySelectorAll?t=document.querySelectorAll(".dropzone"):(t=[],u=function(n){var u,i,f,r;for(r=[],i=0,f=n.length;i<f;i++)u=n[i],/(^| )dropzone($| )/.test(u.className)?r.push(t.push(u)):r.push(void 0);return r},u(document.getElementsByTagName("div")),u(document.getElementsByTagName("form"))),r=[],i=0,e=t.length;i<e;i++)f=t[i],n.optionsForElement(f)!==!1?r.push(new n(f)):r.push(void 0);return r};n.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];n.isBrowserSupported=function(){var t,u,i,f,r;if(t=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a")){for(r=n.blacklistedBrowsers,i=0,f=r.length;i<f;i++)if(u=r[i],u.test(navigator.userAgent)){t=!1;continue}}else t=!1;else t=!1;return t};s=function(n,t){var r,i,f,u;for(u=[],i=0,f=n.length;i<f;i++)r=n[i],r!==t&&u.push(r);return u};u=function(n){return n.replace(/[\-_](\w)/g,function(n){return n.charAt(1).toUpperCase()})};n.createElement=function(n){var t;return t=document.createElement("div"),t.innerHTML=n,t.childNodes[0]};n.elementInside=function(n,t){if(n===t)return!0;while(n=n.parentNode)if(n===t)return!0;return!1};n.getElement=function(n,t){var i;if(typeof n=="string"?i=document.querySelector(n):n.nodeType!=null&&(i=n),i==null)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i};n.getElements=function(n,t){var h,r,i,u,f,o,s,e;if(n instanceof Array){i=[];try{for(u=0,o=n.length;u<o;u++)r=n[u],i.push(this.getElement(r,t))}catch(c){h=c;i=null}}else if(typeof n=="string")for(i=[],e=document.querySelectorAll(n),f=0,s=e.length;f<s;f++)r=e[f],i.push(r);else n.nodeType!=null&&(i=[n]);if(!(i!=null&&i.length))throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return i};n.confirm=function(n,t,i){return window.confirm(n)?t():i!=null?i():void 0};n.isValidFile=function(n,t){var f,u,i,r,e;if(!t)return!0;for(t=t.split(","),u=n.type,f=u.replace(/\/.*$/,""),r=0,e=t.length;r<e;r++)if(i=t[r],i=i.trim(),i.charAt(0)==="."){if(n.name.toLowerCase().indexOf(i.toLowerCase(),n.name.length-i.length)!==-1)return!0}else if(/\/\*$/.test(i)){if(f===i.replace(/\/.*$/,""))return!0}else if(u===i)return!0;return!1};typeof jQuery!="undefined"&&jQuery!==null&&(jQuery.fn.dropzone=function(t){return this.each(function(){return new n(this,t)})});typeof module!="undefined"&&module!==null?module.exports=n:window.Dropzone=n;n.ADDED="added";n.QUEUED="queued";n.ACCEPTED=n.QUEUED;n.UPLOADING="uploading";n.PROCESSING=n.UPLOADING;n.CANCELED="canceled";n.ERROR="error";n.SUCCESS="success";e=function(n){var s,r,f,h,e,i,c,t,o,u;for(c=n.naturalWidth,i=n.naturalHeight,r=document.createElement("canvas"),r.width=1,r.height=i,f=r.getContext("2d"),f.drawImage(n,0,0),h=f.getImageData(0,0,1,i).data,u=0,e=i,t=i;t>u;)s=h[(t-1)*4+3],s===0?e=t:u=t,t=e+u>>1;return o=t/i,o===0?1:o};o=function(n,t,i,r,u,f,o,s,h,c){var l;return l=e(t),n.drawImage(t,i,r,u,f,o,s,h,c/l)};f=function(n,t){var f,i,e,r,o,u,c,s,h;if(e=!1,h=!0,i=n.document,s=i.documentElement,f=i.addEventListener?"addEventListener":"attachEvent",c=i.addEventListener?"removeEventListener":"detachEvent",u=i.addEventListener?"":"on",r=function(f){if(f.type!=="readystatechange"||i.readyState==="complete")return(f.type==="load"?n:i)[c](u+f.type,r,!1),!e&&(e=!0)?t.call(n,f.type||f):void 0},o=function(){var n;try{s.doScroll("left")}catch(t){n=t;setTimeout(o,50);return}return r("poll")},i.readyState!=="complete"){if(i.createEventObject&&s.doScroll){try{h=!n.frameElement}catch(l){}h&&o()}return i[f](u+"DOMContentLoaded",r,!1),i[f](u+"readystatechange",r,!1),n[f](u+"load",r,!1)}};n._autoDiscoverFunction=function(){if(n.autoDiscover)return n.discover()};f(window,n._autoDiscoverFunction)}.call(this);
/*!
 * imagesLoaded PACKAGED v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
(function(n,t){typeof define=="function"&&define.amd?define("ev-emitter/ev-emitter",t):typeof module=="object"&&module.exports?module.exports=t():n.EvEmitter=t()})(typeof window!="undefined"?window:this,function(){function t(){}var n=t.prototype;return n.on=function(n,t){if(n&&t){var i=this._events=this._events||{},r=i[n]=i[n]||[];return r.indexOf(t)==-1&&r.push(t),this}},n.once=function(n,t){if(n&&t){this.on(n,t);var i=this._onceEvents=this._onceEvents||{},r=i[n]=i[n]||{};return r[t]=!0,this}},n.off=function(n,t){var i=this._events&&this._events[n],r;if(i&&i.length)return r=i.indexOf(t),r!=-1&&i.splice(r,1),this},n.emitEvent=function(n,t){var i=this._events&&this._events[n],u,f,r,e;if(i&&i.length){for(i=i.slice(0),t=t||[],u=this._onceEvents&&this._onceEvents[n],f=0;f<i.length;f++)r=i[f],e=u&&u[r],e&&(this.off(n,r),delete u[r]),r.apply(this,t);return this}},n.allOff=function(){delete this._events;delete this._onceEvents},t});
/*!
 * imagesLoaded v4.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
(function(n,t){"use strict";typeof define=="function"&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return t(n,i)}):typeof module=="object"&&module.exports?module.exports=t(n,require("ev-emitter")):n.imagesLoaded=t(n,n.EvEmitter)})(typeof window!="undefined"?window:this,function(n,t){function o(n,t){for(var i in t)n[i]=t[i];return n}function c(n){if(Array.isArray(n))return n;var t=typeof n=="object"&&typeof n.length=="number";return t?h.call(n):[n]}function i(n,t,r){if(!(this instanceof i))return new i(n,t,r);var f=n;if(typeof n=="string"&&(f=document.querySelectorAll(n)),!f){e.error("Bad element for imagesLoaded "+(f||n));return}if(this.elements=c(f),this.options=o({},this.options),typeof t=="function"?r=t:o(this.options,t),r)this.on("always",r);this.getImages();u&&(this.jqDeferred=new u.Deferred);setTimeout(this.check.bind(this))}function r(n){this.img=n}function f(n,t){this.url=n;this.element=t;this.img=new Image}var u=n.jQuery,e=n.console,h=Array.prototype.slice,s;return i.prototype=Object.create(t.prototype),i.prototype.options={},i.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)},i.prototype.addElementImages=function(n){var i,r,t,f,u,e;if(n.nodeName=="IMG"&&this.addImage(n),this.options.background===!0&&this.addElementBackgroundImages(n),i=n.nodeType,i&&s[i]){for(r=n.querySelectorAll("img"),t=0;t<r.length;t++)f=r[t],this.addImage(f);if(typeof this.options.background=="string")for(u=n.querySelectorAll(this.options.background),t=0;t<u.length;t++)e=u[t],this.addElementBackgroundImages(e)}},s={1:!0,9:!0,11:!0},i.prototype.addElementBackgroundImages=function(n){var i=getComputedStyle(n),r,t,u;if(i)for(r=/url\((['"])?(.*?)\1\)/gi,t=r.exec(i.backgroundImage);t!==null;)u=t&&t[2],u&&this.addBackground(u,n),t=r.exec(i.backgroundImage)},i.prototype.addImage=function(n){var t=new r(n);this.images.push(t)},i.prototype.addBackground=function(n,t){var i=new f(n,t);this.images.push(i)},i.prototype.check=function(){function t(t,i,r){setTimeout(function(){n.progress(t,i,r)})}var n=this;if(this.progressedCount=0,this.hasAnyBroken=!1,!this.images.length){this.complete();return}this.images.forEach(function(n){n.once("progress",t);n.check()})},i.prototype.progress=function(n,t,i){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!n.isLoaded;this.emitEvent("progress",[this,n,t]);this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,n);this.progressedCount==this.images.length&&this.complete();this.options.debug&&e&&e.log("progress: "+i,n,t)},i.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done",n;this.isComplete=!0;this.emitEvent(t,[this]);this.emitEvent("always",[this]);this.jqDeferred&&(n=this.hasAnyBroken?"reject":"resolve",this.jqDeferred[n](this))},r.prototype=Object.create(t.prototype),r.prototype.check=function(){var n=this.getIsImageComplete();if(n){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}this.proxyImage=new Image;this.proxyImage.addEventListener("load",this);this.proxyImage.addEventListener("error",this);this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.proxyImage.src=this.img.src},r.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},r.prototype.confirm=function(n,t){this.isLoaded=n;this.emitEvent("progress",[this,this.img,t])},r.prototype.handleEvent=function(n){var t="on"+n.type;this[t]&&this[t](n)},r.prototype.onload=function(){this.confirm(!0,"onload");this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)},f.prototype=Object.create(r.prototype),f.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;var n=this.getIsImageComplete();n&&(this.confirm(this.img.naturalWidth!==0,"naturalWidth"),this.unbindEvents())},f.prototype.unbindEvents=function(){this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)},f.prototype.confirm=function(n,t){this.isLoaded=n;this.emitEvent("progress",[this,this.element,t])},i.makeJQueryPlugin=function(t){(t=t||n.jQuery,t)&&(u=t,u.fn.imagesLoaded=function(n,t){var r=new i(this,n,t);return r.jqDeferred.promise(u(this))})},i.makeJQueryPlugin(),i});
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
(function(n,t){"use strict";var i;if(typeof exports=="object"){try{i=require("moment")}catch(r){}module.exports=t(i)}else typeof define=="function"&&define.amd?define(function(n){try{i=n("moment")}catch(r){}return t(i)}):n.Pikaday=t(n.moment)})(this,function(n){"use strict";var o=typeof n=="function",l=!!window.addEventListener,t=window.document,a=window.setTimeout,u=function(n,t,i,r){l?n.addEventListener(t,i,!!r):n.attachEvent("on"+t,i)},e=function(n,t,i,r){l?n.removeEventListener(t,i,!!r):n.detachEvent("on"+t,i)},y=function(n,i,r){var u;t.createEvent?(u=t.createEvent("HTMLEvents"),u.initEvent(i,!0,!1),u=s(u,r),n.dispatchEvent(u)):t.createEventObject&&(u=t.createEventObject(),u=s(u,r),n.fireEvent("on"+i,u))},d=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},i=function(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")!==-1},g=function(n,t){i(n,t)||(n.className=n.className===""?t:n.className+" "+t)},nt=function(n,t){n.className=d((" "+n.className+" ").replace(" "+t+" "," "))},v=function(n){return/Array/.test(Object.prototype.toString.call(n))},r=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},tt=function(n){var t=n.getDay();return t===0||t===6},it=function(n){return n%4==0&&n%100!=0||n%400==0},p=function(n,t){return[31,it(n)?29:28,31,30,31,30,31,31,30,31,30,31][t]},h=function(n){r(n)&&n.setHours(0,0,0,0)},c=function(n,t){return n.getTime()===t.getTime()},s=function(n,t,i){var u,f;for(u in t)f=n[u]!==undefined,f&&typeof t[u]=="object"&&t[u]!==null&&t[u].nodeName===undefined?r(t[u])?i&&(n[u]=new Date(t[u].getTime())):v(t[u])?i&&(n[u]=t[u].slice(0)):n[u]=s({},t[u],i):(i||!f)&&(n[u]=t[u]);return n},w=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},f={field:null,bound:undefined,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:undefined,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},b=function(n,t,i){for(t+=n.firstDay;t>=7;)t-=7;return i?n.i18n.weekdaysShort[t]:n.i18n.weekdays[t]},rt=function(n){var t=[],i="false";if(n.isEmpty)if(n.showDaysInNextAndPreviousMonths)t.push("is-outside-current-month");else return'<td class="is-empty"><\/td>';return n.isDisabled&&t.push("is-disabled"),n.isToday&&t.push("is-today"),n.isSelected&&(t.push("is-selected"),i="true"),n.isInRange&&t.push("is-inrange"),n.isStartRange&&t.push("is-startrange"),n.isEndRange&&t.push("is-endrange"),'<td data-day="'+n.day+'" class="'+t.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+n.year+'" data-pika-month="'+n.month+'" data-pika-day="'+n.day+'">'+n.day+"<\/button><\/td>"},ut=function(n,t,i){var r=new Date(i,0,1),u=Math.ceil(((new Date(i,t,n)-r)/864e5+r.getDay()+1)/7);return'<td class="pika-week">'+u+"<\/td>"},ft=function(n,t){return"<tr>"+(t?n.reverse():n).join("")+"<\/tr>"},et=function(n){return"<tbody>"+n.join("")+"<\/tbody>"},ot=function(n){var t,i=[];for(n.showWeekNumber&&i.push("<th><\/th>"),t=0;t<7;t++)i.push('<th scope="col"><abbr title="'+b(n,t)+'">'+b(n,t,!0)+"<\/abbr><\/th>");return"<thead><tr>"+(n.isRTL?i.reverse():i).join("")+"<\/tr><\/thead>"},st=function(n,t,i,r,u,f){for(var c,e=n._o,y=i===e.minYear,p=i===e.maxYear,h='<div id="'+f+'" class="pika-title" role="heading" aria-live="assertive">',l,a,w=!0,b=!0,s=[],o=0;o<12;o++)s.push('<option value="'+(i===u?o-t:12+o-t)+'"'+(o===r?' selected="selected"':"")+(y&&o<e.minMonth||p&&o>e.maxMonth?'disabled="disabled"':"")+">"+e.i18n.months[o]+"<\/option>");for(l='<div class="pika-label">'+e.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+s.join("")+"<\/select><\/div>",v(e.yearRange)?(o=e.yearRange[0],c=e.yearRange[1]+1):(o=i-e.yearRange,c=1+i+e.yearRange),s=[];o<c&&o<=e.maxYear;o++)o>=e.minYear&&s.push('<option value="'+o+'"'+(o===i?' selected="selected"':"")+">"+o+"<\/option>");return a='<div class="pika-label">'+i+e.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+s.join("")+"<\/select><\/div>",h+=e.showMonthAfterYear?a+l:l+a,y&&(r===0||e.minMonth>=r)&&(w=!1),p&&(r===11||e.maxMonth<=r)&&(b=!1),t===0&&(h+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+e.i18n.previousMonth+"<\/button>"),t===n._o.numberOfMonths-1&&(h+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+e.i18n.nextMonth+"<\/button>"),h+"<\/div>"},ht=function(n,t,i){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+ot(n)+et(t)+"<\/table>"},k=function(f){var e=this,s=e.config(f),h;e._onMouseDown=function(n){if(e._v){n=n||window.event;var t=n.target||n.srcElement;if(t)if(i(t,"is-disabled")||(!i(t,"pika-button")||i(t,"is-empty")||i(t.parentNode,"is-disabled")?i(t,"pika-prev")?e.prevMonth():i(t,"pika-next")&&e.nextMonth():(e.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),s.bound&&a(function(){e.hide();s.field&&s.field.blur()},100))),i(t,"pika-select"))e._c=!0;else if(n.preventDefault)n.preventDefault();else return n.returnValue=!1,!1}};e._onChange=function(n){n=n||window.event;var t=n.target||n.srcElement;t&&(i(t,"pika-select-month")?e.gotoMonth(t.value):i(t,"pika-select-year")&&e.gotoYear(t.value))};e._onKeyChange=function(n){if(n=n||window.event,e.isVisible())switch(n.keyCode){case 13:case 27:s.field.blur();break;case 37:n.preventDefault();e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7)}};e._onInputChange=function(t){var i;t.firedBy!==e&&(o?(i=n(s.field.value,s.format,s.formatStrict),i=i&&i.isValid()?i.toDate():null):i=new Date(Date.parse(s.field.value)),r(i)&&e.setDate(i),e._v||e.show())};e._onInputFocus=function(){e.show()};e._onInputClick=function(){e.show()};e._onInputBlur=function(){var n=t.activeElement;do if(i(n,"pika-single"))return;while(n=n.parentNode);e._c||(e._b=a(function(){e.hide()},50));e._c=!1};e._onClick=function(n){n=n||window.event;var t=n.target||n.srcElement,r=t;if(t){!l&&i(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),u(t,"change",e._onChange)));do if(i(r,"pika-single")||r===s.trigger)return;while(r=r.parentNode);e._v&&t!==s.trigger&&r!==s.trigger&&e.hide()}};e.el=t.createElement("div");e.el.className="pika-single"+(s.isRTL?" is-rtl":"")+(s.theme?" "+s.theme:"");u(e.el,"mousedown",e._onMouseDown,!0);u(e.el,"touchend",e._onMouseDown,!0);u(e.el,"change",e._onChange);u(t,"keydown",e._onKeyChange);s.field&&(s.container?s.container.appendChild(e.el):s.bound?t.body.appendChild(e.el):s.field.parentNode.insertBefore(e.el,s.field.nextSibling),u(s.field,"change",e._onInputChange),s.defaultDate||(s.defaultDate=o&&s.field.value?n(s.field.value,s.format).toDate():new Date(Date.parse(s.field.value)),s.setDefaultDate=!0));h=s.defaultDate;r(h)?s.setDefaultDate?e.setDate(h,!0):e.gotoDate(h):e.gotoDate(new Date);s.bound?(this.hide(),e.el.className+=" is-bound",u(s.trigger,"click",e._onInputClick),u(s.trigger,"focus",e._onInputFocus),u(s.trigger,"blur",e._onInputBlur)):this.show()};return k.prototype={config:function(n){var t,i,u;return this._o||(this._o=s({},f,!0)),t=s(this._o,n,!0),t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme=typeof t.theme=="string"&&t.theme?t.theme:null,t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn=typeof t.disableDayFn=="function"?t.disableDayFn:null,i=parseInt(t.numberOfMonths,10)||1,t.numberOfMonths=i>4?4:i,r(t.minDate)||(t.minDate=!1),r(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),v(t.yearRange)?(u=(new Date).getFullYear()-10,t.yearRange[0]=parseInt(t.yearRange[0],10)||u,t.yearRange[1]=parseInt(t.yearRange[1],10)||u):(t.yearRange=Math.abs(parseInt(t.yearRange,10))||f.yearRange,t.yearRange>100&&(t.yearRange=100)),t},toString:function(t){return r(this._d)?o?n(this._d).format(t||this._o.format):this._d.toDateString():""},getMoment:function(){return o?n(this._d):null},setMoment:function(t,i){o&&n.isMoment(t)&&this.setDate(t.toDate(),i)},getDate:function(){return r(this._d)?new Date(this._d.getTime()):new Date},setDate:function(n,t){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",y(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),r(n)){var i=this._o.minDate,u=this._o.maxDate;r(i)&&n<i?n=i:r(u)&&n>u&&(n=u);this._d=new Date(n.getTime());h(this._d);this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString(),y(this._o.field,"change",{firedBy:this}));t||typeof this._o.onSelect!="function"||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(n){var i=!0;if(r(n)){if(this.calendars){var f=new Date(this.calendars[0].year,this.calendars[0].month,1),t=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),u=n.getTime();t.setMonth(t.getMonth()+1);t.setDate(t.getDate()-1);i=u<f.getTime()||t.getTime()<u}i&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths));this.adjustCalendars()}},adjustDate:function(t,i){var u=this.getDate(),f=parseInt(i)*864e5,r;t==="add"?r=new Date(u.valueOf()+f):t==="subtract"&&(r=new Date(u.valueOf()-f));o&&(t==="add"?r=n(u).add(i,"days").toDate():t==="subtract"&&(r=n(u).subtract(i,"days").toDate()));this.setDate(r)},adjustCalendars:function(){this.calendars[0]=w(this.calendars[0]);for(var n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=w({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){n instanceof Date?(h(n),this._o.minDate=n,this._o.minYear=n.getFullYear(),this._o.minMonth=n.getMonth()):(this._o.minDate=f.minDate,this._o.minYear=f.minYear,this._o.minMonth=f.minMonth,this._o.startRange=f.startRange);this.draw()},setMaxDate:function(n){n instanceof Date?(h(n),this._o.maxDate=n,this._o.maxYear=n.getFullYear(),this._o.maxMonth=n.getMonth()):(this._o.maxDate=f.maxDate,this._o.maxYear=f.maxYear,this._o.maxMonth=f.maxMonth,this._o.endRange=f.endRange);this.draw()},setStartRange:function(n){this._o.startRange=n},setEndRange:function(n){this._o.endRange=n},draw:function(n){var i;if(this._v||n){var t=this._o,e=t.minYear,o=t.maxYear,r=t.minMonth,u=t.maxMonth,s="",f;for(this._y<=e&&(this._y=e,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=o&&(this._y=o,!isNaN(u)&&this._m>u&&(this._m=u)),f="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),i=0;i<t.numberOfMonths;i++)s+='<div class="pika-lendar">'+st(this,i,this.calendars[i].year,this.calendars[i].month,this.calendars[0].year,f)+this.render(this.calendars[i].year,this.calendars[i].month,f)+"<\/div>";if(this.el.innerHTML=s,t.bound&&t.field.type!=="hidden"&&a(function(){t.trigger.focus()},1),typeof this._o.onDraw=="function")this._o.onDraw(this);this._o.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var n,i,f,e,s,h,c,r,u,o;if(!this._o.container){if(this.el.style.position="absolute",n=this._o.trigger,i=n,f=this.el.offsetWidth,e=this.el.offsetHeight,s=window.innerWidth||t.documentElement.clientWidth,h=window.innerHeight||t.documentElement.clientHeight,c=window.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop,typeof n.getBoundingClientRect=="function")o=n.getBoundingClientRect(),r=o.left+window.pageXOffset,u=o.bottom+window.pageYOffset;else for(r=i.offsetLeft,u=i.offsetTop+i.offsetHeight;i=i.offsetParent;)r+=i.offsetLeft,u+=i.offsetTop;(this._o.reposition&&r+f>s||this._o.position.indexOf("right")>-1&&r-f+n.offsetWidth>0)&&(r=r-f+n.offsetWidth);(this._o.reposition&&u+e>h+c||this._o.position.indexOf("top")>-1&&u-e-n.offsetHeight>0)&&(u=u-e-n.offsetHeight);this.el.style.left=r+"px";this.el.style.top=u+"px"}},render:function(n,t,i){var u=this._o,d=new Date,a=p(n,t),f=new Date(n,t,1).getDay(),g=[],l=[],o,w,ot;h(d);u.firstDay>0&&(f-=u.firstDay,f<0&&(f+=7));for(var nt=t===0?11:t-1,st=t===11?0:t+1,it=t===0?n-1:n,ct=t===11?n+1:n,lt=p(it,nt),v=a+f,y=v;y>7;)y-=7;for(v+=7-y,o=0,w=0;o<v;o++){var e=new Date(n,t,1+(o-f)),at=r(this._d)?c(e,this._d):!1,vt=c(e,d),et=o<f||o>=a+f,s=1+(o-f),b=t,k=n,yt=u.startRange&&c(u.startRange,e),pt=u.endRange&&c(u.endRange,e),wt=u.startRange&&u.endRange&&u.startRange<e&&e<u.endRange,bt=u.minDate&&e<u.minDate||u.maxDate&&e>u.maxDate||u.disableWeekends&&tt(e)||u.disableDayFn&&u.disableDayFn(e);et&&(o<f?(s=lt+s,b=nt,k=it):(s=s-a,b=st,k=ct));ot={day:s,month:b,year:k,isSelected:at,isToday:vt,isDisabled:bt,isEmpty:et,isStartRange:yt,isEndRange:pt,isInRange:wt,showDaysInNextAndPreviousMonths:u.showDaysInNextAndPreviousMonths};l.push(rt(ot));++w==7&&(u.showWeekNumber&&l.unshift(ut(o-f,t,n)),g.push(ft(l,u.isRTL)),l=[],w=0)}return ht(u,g,i)},isVisible:function(){return this._v},show:function(){this.isVisible()||(nt(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(u(t,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var n=this._v;n!==!1&&(this._o.bound&&e(t,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",g(this.el,"is-hidden"),this._v=!1,n!==undefined&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){this.hide();e(this.el,"mousedown",this._onMouseDown,!0);e(this.el,"touchend",this._onMouseDown,!0);e(this.el,"change",this._onChange);this._o.field&&(e(this._o.field,"change",this._onInputChange),this._o.bound&&(e(this._o.trigger,"click",this._onInputClick),e(this._o.trigger,"focus",this._onInputFocus),e(this._o.trigger,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},k});
/*!
	autosize 4.0.2
	license: MIT
	http://www.jacklmoore.com/autosize
*/
(function(n,t){if(typeof define=="function"&&define.amd)define(["module","exports"],t);else if(typeof exports!="undefined")t(module,exports);else{var i={exports:{}};t(i,i.exports);n.autosize=i.exports}})(this,function(n,t){"use strict";function f(n){function l(){var r=window.getComputedStyle(n,null);r.resize==="vertical"?n.style.resize="none":r.resize==="both"&&(n.style.resize="horizontal");i=r.boxSizing==="content-box"?-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)):parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth);isNaN(i)&&(i=0);t()}function c(t){var i=n.style.width;n.style.width="0px";n.offsetWidth;n.style.width=i;n.style.overflowY=t}function a(n){for(var t=[];n&&n.parentNode&&n.parentNode instanceof Element;)n.parentNode.scrollTop&&t.push({node:n.parentNode,scrollTop:n.parentNode.scrollTop}),n=n.parentNode;return t}function e(){if(n.scrollHeight!==0){var r=a(n),t=document.documentElement&&document.documentElement.scrollTop;n.style.height="";n.style.height=n.scrollHeight+i+"px";s=n.clientWidth;r.forEach(function(n){n.node.scrollTop=n.scrollTop});t&&(document.documentElement.scrollTop=t)}}function t(){var r;e();var f=Math.round(parseFloat(n.style.height)),t=window.getComputedStyle(n,null),i=t.boxSizing==="content-box"?Math.round(parseFloat(t.height)):n.offsetHeight;if(i<f?t.overflowY==="hidden"&&(c("scroll"),e(),i=t.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight):t.overflowY!=="hidden"&&(c("hidden"),e(),i=t.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight),h!==i){h=i;r=u("autosize:resized");try{n.dispatchEvent(r)}catch(o){}}}var o,f;if(n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!r.has(n)){var i=null,s=null,h=null;o=function(){n.clientWidth!==s&&t()};f=function(i){window.removeEventListener("resize",o,!1);n.removeEventListener("input",t,!1);n.removeEventListener("keyup",t,!1);n.removeEventListener("autosize:destroy",f,!1);n.removeEventListener("autosize:update",t,!1);Object.keys(i).forEach(function(t){n.style[t]=i[t]});r.delete(n)}.bind(n,{height:n.style.height,resize:n.style.resize,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",f,!1);"onpropertychange"in n&&"oninput"in n&&n.addEventListener("keyup",t,!1);window.addEventListener("resize",o,!1);n.addEventListener("input",t,!1);n.addEventListener("autosize:update",t,!1);n.style.overflowX="hidden";n.style.wordWrap="break-word";r.set(n,{destroy:f,update:t});l()}}function e(n){var t=r.get(n);t&&t.destroy()}function o(n){var t=r.get(n);t&&t.update()}var r=typeof Map=="function"?new Map:function(){var n=[],t=[];return{has:function(t){return n.indexOf(t)>-1},get:function(i){return t[n.indexOf(i)]},set:function(i,r){n.indexOf(i)===-1&&(n.push(i),t.push(r))},"delete":function(i){var r=n.indexOf(i);r>-1&&(n.splice(r,1),t.splice(r,1))}}}(),u=function(n){return new Event(n,{bubbles:!0})},i;try{new Event("test")}catch(s){u=function(n){var t=document.createEvent("Event");return t.initEvent(n,!0,!1),t}}i=null;typeof window=="undefined"||typeof getComputedStyle!="function"?(i=function(n){return n},i.destroy=function(n){return n},i.update=function(n){return n}):(i=function(n,t){return n&&Array.prototype.forEach.call(n.length?n:[n],function(n){return f(n,t)}),n},i.destroy=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],e),n},i.update=function(n){return n&&Array.prototype.forEach.call(n.length?n:[n],o),n});t.default=i;n.exports=t["default"]});$(window).on("unload",function(){});String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(n,t){return this.substr(!t||t<0?0:+t,n.length)===n}});angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.modal","ui.bootstrap.stackedMap","ui.bootstrap.position"]);angular.module("ui.bootstrap.tpls",["uib/template/modal/backdrop.html","uib/template/modal/window.html"]);angular.module("ui.bootstrap.modal",["ui.bootstrap.stackedMap","ui.bootstrap.position"]).factory("$$multiMap",function(){return{createNew:function(){var n={};return{entries:function(){return Object.keys(n).map(function(t){return{key:t,value:n[t]}})},get:function(t){return n[t]},hasKey:function(t){return!!n[t]},keys:function(){return Object.keys(n)},put:function(t,i){n[t]||(n[t]=[]);n[t].push(i)},remove:function(t,i){var r=n[t],u;r&&(u=r.indexOf(i),u!==-1&&r.splice(u,1),r.length||delete n[t])}}}}}).provider("$uibResolve",function(){var n=this;this.resolver=null;this.setResolver=function(n){this.resolver=n};this.$get=["$injector","$q",function(t,i){var r=n.resolver?t.get(n.resolver):null;return{resolve:function(n,u,f,e){if(r)return r.resolve(n,u,f,e);var o=[];return angular.forEach(n,function(n){angular.isFunction(n)||angular.isArray(n)?o.push(i.resolve(t.invoke(n))):angular.isString(n)?o.push(i.resolve(t.get(n))):o.push(i.resolve(n))}),i.all(o).then(function(t){var i={},r=0;return angular.forEach(n,function(n,u){i[u]=t[r++]}),i})}}}]}).directive("uibModalBackdrop",["$animate","$injector","$uibModalStack",function(n,t,i){function r(t,r,u){u.modalInClass&&(n.addClass(r,u.modalInClass),t.$on(i.NOW_CLOSING_EVENT,function(i,f){var e=f();t.modalOptions.animation?n.removeClass(r,u.modalInClass).then(e):e()}))}return{replace:!0,templateUrl:"uib/template/modal/backdrop.html",compile:function(n,t){return n.addClass(t.backdropClass),r}}}]).directive("uibModalWindow",["$uibModalStack","$q","$animateCss","$document",function(n,t,i,r){return{scope:{index:"@"},replace:!0,transclude:!0,templateUrl:function(n,t){return t.templateUrl||"uib/template/modal/window.html"},link:function(u,f,e){f.addClass(e.windowClass||"");f.addClass(e.windowTopClass||"");u.size=e.size;u.close=function(t){var i=n.getTop();i&&i.value.backdrop&&i.value.backdrop!=="static"&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),n.dismiss(i.key,"backdrop click"))};f.on("click",u.close);u.$isRendered=!0;var o=t.defer();e.$observe("modalRender",function(n){n==="true"&&o.resolve()});o.promise.then(function(){var o=null;e.modalInClass&&(o=i(f,{addClass:e.modalInClass}).start(),u.$on(n.NOW_CLOSING_EVENT,function(n,t){var r=t();i(f,{removeClass:e.modalInClass}).start().then(r)}));t.when(o).then(function(){var i=n.getTop(),t;i&&n.modalRendered(i.key);r[0].activeElement&&f[0].contains(r[0].activeElement)||(t=f[0].querySelector("[autofocus]"),t?t.focus():f[0].focus())})})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(n,t){t.modalAnimation&&n.addClass(t.uibModalAnimationClass)}}}).directive("uibModalTransclude",function(){return{link:function(n,t,i,r,u){u(n.$parent,function(n){t.empty();t.append(n)})}}}).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap","$uibPosition",function(n,t,i,r,u,f,e,o,s){function ut(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)}function b(){for(var n=-1,i=c.keys(),t=0;t<i.length;t++)c.get(i[t]).value.backdrop&&(n=t);return n>-1&&n<p&&(n=p),n}function d(n,t){var i=c.get(n).value,r=i.appendTo;c.remove(n);y=c.top();y&&(p=parseInt(y.value.modalDomEl.attr("index"),10));nt(i.modalDomEl,i.modalScope,function(){var t=i.openedClass||k,u;w.remove(t,n);u=w.hasKey(t);r.toggleClass(t,u);!u&&l&&l.heightOverflow&&l.scrollbarWidth&&(l.originalRight?r.css({paddingRight:l.originalRight+"px"}):r.css({paddingRight:""}),l=null);g(!0)},i.closedDeferred);ft();t&&t.focus?t.focus():r.focus&&r.focus()}function g(n){var t;c.length()>0&&(t=c.top().value,t.modalDomEl.toggleClass(t.windowTopClass||"",n))}function ft(){if(a&&b()===-1){var n=v;nt(a,v,function(){n=null});a=undefined;v=undefined}}function nt(t,i,r,u){function o(){o.done||(o.done=!0,n.leave(t).then(function(){t.remove();u&&u.resolve()}),i.$destroy(),r&&r())}var e,s=null,c=function(){return e||(e=f.defer(),s=e.promise),function(){e.resolve()}};return i.$broadcast(h.NOW_CLOSING_EVENT,c),f.when(s).then(o)}function tt(n){var t,i,r;if(n.isDefaultPrevented())return n;if(t=c.top(),t)switch(n.which){case 27:t.value.keyboard&&(n.preventDefault(),u.$apply(function(){h.dismiss(t.key,"escape key press")}));break;case 9:i=h.loadFocusElementList(t);r=!1;n.shiftKey?(h.isFocusInFirstItem(n,i)||h.isModalFocused(n,t))&&(r=h.focusLastFocusableElement(i)):h.isFocusInLastItem(n,i)&&(r=h.focusFirstFocusableElement(i));r&&(n.preventDefault(),n.stopPropagation())}}function it(n,t,i){return!n.value.modalScope.$broadcast("modal.closing",t,i).defaultPrevented}var k="modal-open",a,v,c=o.createNew(),w=e.createNew(),h={NOW_CLOSING_EVENT:"modal.stack.now-closing"},p=0,y=null,rt="a[href], area[href], input:not([disabled]), button:not([disabled]),select:not([disabled]), textarea:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable=true]",l;u.$watch(b,function(n){v&&(v.index=n)});i.on("keydown",tt);return u.$on("$destroy",function(){i.off("keydown",tt)}),h.open=function(t,f){var nt=i[0].activeElement,d=f.openedClass||k,e,h,o;if(g(!1),y=c.top(),c.add(t,{deferred:f.deferred,renderDeferred:f.renderDeferred,closedDeferred:f.closedDeferred,modalScope:f.scope,backdrop:f.backdrop,keyboard:f.keyboard,openedClass:f.openedClass,windowTopClass:f.windowTopClass,animation:f.animation,appendTo:f.appendTo}),w.put(d,t),e=f.appendTo,h=b(),!e.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");h>=0&&!a&&(v=u.$new(!0),v.modalOptions=f,v.index=h,a=angular.element('<div uib-modal-backdrop="modal-backdrop"><\/div>'),a.attr("backdrop-class",f.backdropClass),f.animation&&a.attr("modal-animation","true"),r(a)(v),n.enter(a,e),l=s.scrollbarPadding(e),l.heightOverflow&&l.scrollbarWidth&&e.css({paddingRight:l.right+"px"}));p=y?parseInt(y.value.modalDomEl.attr("index"),10)+1:0;o=angular.element('<div uib-modal-window="modal-window"><\/div>');o.attr({"template-url":f.windowTemplateUrl,"window-class":f.windowClass,"window-top-class":f.windowTopClass,size:f.size,index:p,animate:"animate"}).html(f.content);f.animation&&o.attr("modal-animation","true");e.addClass(d);n.enter(r(o)(f.scope),e);c.top().value.modalDomEl=o;c.top().value.modalOpener=nt},h.close=function(n,t){var i=c.get(n);return i&&it(i,t,!0)?(i.value.modalScope.$$uibDestructionScheduled=!0,i.value.deferred.resolve(t),d(n,i.value.modalOpener),!0):!i},h.dismiss=function(n,t){var i=c.get(n);return i&&it(i,t,!1)?(i.value.modalScope.$$uibDestructionScheduled=!0,i.value.deferred.reject(t),d(n,i.value.modalOpener),!0):!i},h.dismissAll=function(n){for(var t=this.getTop();t&&this.dismiss(t.key,n);)t=this.getTop()},h.getTop=function(){return c.top()},h.modalRendered=function(n){var t=c.get(n);t&&t.value.renderDeferred.resolve()},h.focusFirstFocusableElement=function(n){return n.length>0?(n[0].focus(),!0):!1},h.focusLastFocusableElement=function(n){return n.length>0?(n[n.length-1].focus(),!0):!1},h.isModalFocused=function(n,t){if(n&&t){var i=t.value.modalDomEl;if(i&&i.length)return(n.target||n.srcElement)===i[0]}return!1},h.isFocusInFirstItem=function(n,t){return t.length>0?(n.target||n.srcElement)===t[0]:!1},h.isFocusInLastItem=function(n,t){return t.length>0?(n.target||n.srcElement)===t[t.length-1]:!1},h.loadFocusElementList=function(n){var t,i;if(n&&(t=n.value.modalDomEl,t&&t.length))return i=t[0].querySelectorAll(rt),i?Array.prototype.filter.call(i,function(n){return ut(n)}):i},h}]).provider("$uibModal",function(){var n={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(t,i,r,u,f,e,o){function c(n){return n.template?i.when(n.template):u(angular.isFunction(n.templateUrl)?n.templateUrl():n.templateUrl)}var h={},s=null;return h.getPromiseChain=function(){return s},h.open=function(u){function w(){return p}var l=i.defer(),a=i.defer(),v=i.defer(),y=i.defer(),h={result:l.promise,opened:a.promise,closed:v.promise,rendered:y.promise,close:function(n){return o.close(h,n)},dismiss:function(n){return o.dismiss(h,n)}},p,b;if(u=angular.extend({},n.options,u),u.resolve=u.resolve||{},u.appendTo=u.appendTo||r.find("body").eq(0),!u.template&&!u.templateUrl)throw new Error("One of template or templateUrl options is required.");return p=i.all([c(u),e.resolve(u.resolve,{},null,null)]),b=s=i.all([s]).then(w,w).then(function(n){var c=u.scope||t,i=c.$new(),e,s,r;i.$close=h.close;i.$dismiss=h.dismiss;i.$on("$destroy",function(){i.$$uibDestructionScheduled||i.$dismiss("$uibUnscheduledDestruction")});r={};u.controller&&(r.$scope=i,r.$scope.$resolve={},r.$uibModalInstance=h,angular.forEach(n[1],function(n,t){r[t]=n;r.$scope.$resolve[t]=n}),s=f(u.controller,r,!0,u.controllerAs),u.controllerAs&&u.bindToController&&(e=s.instance,e.$close=i.$close,e.$dismiss=i.$dismiss,angular.extend(e,{$resolve:r.$scope.$resolve},c)),e=s(),angular.isFunction(e.$onInit)&&e.$onInit());o.open(h,{scope:i,deferred:l,renderDeferred:y,closedDeferred:v,content:n[0],animation:u.animation,backdrop:u.backdrop,keyboard:u.keyboard,backdropClass:u.backdropClass,windowTopClass:u.windowTopClass,windowClass:u.windowClass,windowTemplateUrl:u.windowTemplateUrl,size:u.size,openedClass:u.openedClass,appendTo:u.appendTo});a.resolve(!0)},function(n){a.reject(n);l.reject(n)})["finally"](function(){s===b&&(s=null)}),h},h}]};return n});angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var n=[];return{add:function(t,i){n.push({key:t,value:i})},get:function(t){for(var i=0;i<n.length;i++)if(t===n[i].key)return n[i]},keys:function(){for(var i=[],t=0;t<n.length;t++)i.push(n[t].key);return i},top:function(){return n[n.length-1]},remove:function(t){for(var r=-1,i=0;i<n.length;i++)if(t===n[i].key){r=i;break}return n.splice(r,1)[0]},removeTop:function(){return n.splice(n.length-1,1)[0]},length:function(){return n.length}}}}});angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(n,t){var r,u,f={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},i={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},e=/(HTML|BODY)/;return{getRawNode:function(n){return n.nodeName?n:n[0]||n},parseStyle:function(n){return n=parseFloat(n),isFinite(n)?n:0},offsetParent:function(i){function u(n){return(t.getComputedStyle(n).position||"static")==="static"}i=this.getRawNode(i);for(var r=i.offsetParent||n[0].documentElement;r&&r!==n[0].documentElement&&u(r);)r=r.offsetParent;return r||n[0].documentElement},scrollbarWidth:function(i){var e,f;return i?(angular.isUndefined(u)&&(e=n.find("body"),e.addClass("uib-position-body-scrollbar-measure"),u=t.innerWidth-e[0].clientWidth,u=isFinite(u)?u:0,e.removeClass("uib-position-body-scrollbar-measure")),u):(angular.isUndefined(r)&&(f=angular.element('<div class="uib-position-scrollbar-measure"><\/div>'),n.find("body").append(f),r=f[0].offsetWidth-f[0].clientWidth,r=isFinite(r)?r:0,f.remove()),r)},scrollbarPadding:function(n){n=this.getRawNode(n);var u=t.getComputedStyle(n),f=this.parseStyle(u.paddingRight),o=this.parseStyle(u.paddingBottom),i=this.scrollParent(n,!1,!0),r=this.scrollbarWidth(i,e.test(i.tagName));return{scrollbarWidth:r,widthOverflow:i.scrollWidth>i.clientWidth,right:f+r,originalRight:f,heightOverflow:i.scrollHeight>i.clientHeight,bottom:o+r,originalBottom:o}},isScrollable:function(n,i){n=this.getRawNode(n);var u=i?f.hidden:f.normal,r=t.getComputedStyle(n);return u.test(r.overflow+r.overflowY+r.overflowX)},scrollParent:function(i,r,u){var c,e,s;i=this.getRawNode(i);var l=r?f.hidden:f.normal,h=n[0].documentElement,o=t.getComputedStyle(i);if(u&&l.test(o.overflow+o.overflowY+o.overflowX))return i;if(c=o.position==="absolute",e=i.parentElement||h,e===h||o.position==="fixed")return h;while(e.parentElement&&e!==h){if(s=t.getComputedStyle(e),c&&s.position!=="static"&&(c=!1),!c&&l.test(s.overflow+s.overflowY+s.overflowX))break;e=e.parentElement}return e},position:function(i,r){var u,o,f,e;return i=this.getRawNode(i),u=this.offset(i),r&&(o=t.getComputedStyle(i),u.top-=this.parseStyle(o.marginTop),u.left-=this.parseStyle(o.marginLeft)),f=this.offsetParent(i),e={top:0,left:0},f!==n[0].documentElement&&(e=this.offset(f),e.top+=f.clientTop-f.scrollTop,e.left+=f.clientLeft-f.scrollLeft),{width:Math.round(angular.isNumber(u.width)?u.width:i.offsetWidth),height:Math.round(angular.isNumber(u.height)?u.height:i.offsetHeight),top:Math.round(u.top-e.top),left:Math.round(u.left-e.left)}},offset:function(i){i=this.getRawNode(i);var r=i.getBoundingClientRect();return{width:Math.round(angular.isNumber(r.width)?r.width:i.offsetWidth),height:Math.round(angular.isNumber(r.height)?r.height:i.offsetHeight),top:Math.round(r.top+(t.pageYOffset||n[0].documentElement.scrollTop)),left:Math.round(r.left+(t.pageXOffset||n[0].documentElement.scrollLeft))}},viewportOffset:function(i,r,u){var o;i=this.getRawNode(i);u=u!==!1?!0:!1;var s=i.getBoundingClientRect(),f={top:0,left:0,bottom:0,right:0},e=r?n[0].documentElement:this.scrollParent(i),h=e.getBoundingClientRect();return f.top=h.top+e.clientTop,f.left=h.left+e.clientLeft,e===n[0].documentElement&&(f.top+=t.pageYOffset,f.left+=t.pageXOffset),f.bottom=f.top+e.clientHeight,f.right=f.left+e.clientWidth,u&&(o=t.getComputedStyle(e),f.top+=this.parseStyle(o.paddingTop),f.bottom-=this.parseStyle(o.paddingBottom),f.left+=this.parseStyle(o.paddingLeft),f.right-=this.parseStyle(o.paddingRight)),{top:Math.round(s.top-f.top),bottom:Math.round(f.bottom-s.bottom),left:Math.round(s.left-f.left),right:Math.round(f.right-s.right)}},parsePlacement:function(n){var t=i.auto.test(n);return t&&(n=n.replace(i.auto,"")),n=n.split("-"),n[0]=n[0]||"top",i.primary.test(n[0])||(n[0]="top"),n[1]=n[1]||"center",i.secondary.test(n[1])||(n[1]="center"),n[2]=t?!0:!1,n},positionElements:function(n,r,u,f){var c,l,e,h,v,y;if(n=this.getRawNode(n),r=this.getRawNode(r),c=angular.isDefined(r.offsetWidth)?r.offsetWidth:r.prop("offsetWidth"),l=angular.isDefined(r.offsetHeight)?r.offsetHeight:r.prop("offsetHeight"),u=this.parsePlacement(u),e=f?this.offset(n):this.position(n),h={top:0,left:0,placement:""},u[2]){var o=this.viewportOffset(n,f),a=t.getComputedStyle(r),s={width:c+Math.round(Math.abs(this.parseStyle(a.marginLeft)+this.parseStyle(a.marginRight))),height:l+Math.round(Math.abs(this.parseStyle(a.marginTop)+this.parseStyle(a.marginBottom)))};u[0]=u[0]==="top"&&s.height>o.top&&s.height<=o.bottom?"bottom":u[0]==="bottom"&&s.height>o.bottom&&s.height<=o.top?"top":u[0]==="left"&&s.width>o.left&&s.width<=o.right?"right":u[0]==="right"&&s.width>o.right&&s.width<=o.left?"left":u[0];u[1]=u[1]==="top"&&s.height-e.height>o.bottom&&s.height-e.height<=o.top?"bottom":u[1]==="bottom"&&s.height-e.height>o.top&&s.height-e.height<=o.bottom?"top":u[1]==="left"&&s.width-e.width>o.right&&s.width-e.width<=o.left?"right":u[1]==="right"&&s.width-e.width>o.left&&s.width-e.width<=o.right?"left":u[1];u[1]==="center"&&(i.vertical.test(u[0])?(v=e.width/2-c/2,o.left+v<0&&s.width-e.width<=o.right?u[1]="left":o.right+v<0&&s.width-e.width<=o.left&&(u[1]="right")):(y=e.height/2-s.height/2,o.top+y<0&&s.height-e.height<=o.bottom?u[1]="top":o.bottom+y<0&&s.height-e.height<=o.top&&(u[1]="bottom")))}switch(u[0]){case"top":h.top=e.top-l;break;case"bottom":h.top=e.top+e.height;break;case"left":h.left=e.left-c;break;case"right":h.left=e.left+e.width}switch(u[1]){case"top":h.top=e.top;break;case"bottom":h.top=e.top+e.height-l;break;case"left":h.left=e.left;break;case"right":h.left=e.left+e.width-c;break;case"center":i.vertical.test(u[0])?h.left=e.left+e.width/2-c/2:h.top=e.top+e.height/2-l/2}return h.top=Math.round(h.top),h.left=Math.round(h.left),h.placement=u[1]==="center"?u[0]:u[0]+"-"+u[1],h},positionArrow:function(n,r){var o,f,e,u,c;if((n=this.getRawNode(n),o=n.querySelector(".tooltip-inner, .popover-inner"),o)&&(f=angular.element(o).hasClass("tooltip-inner"),e=f?n.querySelector(".tooltip-arrow"):n.querySelector(".arrow"),e)){if(u={top:"",bottom:"",left:"",right:""},r=this.parsePlacement(r),r[1]==="center"){angular.element(e).css(u);return}var l="border-"+r[0]+"-width",s=t.getComputedStyle(e)[l],h="border-";h+=i.vertical.test(r[0])?r[0]+"-"+r[1]:r[1]+"-"+r[0];h+="-radius";c=t.getComputedStyle(f?o:n)[h];switch(r[0]){case"top":u.bottom=f?"0":"-"+s;break;case"bottom":u.top=f?"0":"-"+s;break;case"left":u.right=f?"0":"-"+s;break;case"right":u.left=f?"0":"-"+s}u[r[1]]=c;angular.element(e).css(u)}}}}]);angular.module("uib/template/modal/backdrop.html",[]).run(["$templateCache",function(n){n.put("uib/template/modal/backdrop.html",'<div class="modal-backdrop"\n     uib-modal-animation-class="fade"\n     modal-in-class="in"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n><\/div>\n')}]);angular.module("uib/template/modal/window.html",[]).run(["$templateCache",function(n){n.put("uib/template/modal/window.html",'<div modal-render="{{$isRendered}}" tabindex="-1" role="dialog" class="modal"\n    uib-modal-animation-class="fade"\n    modal-in-class="in"\n    ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}">\n    <div class="modal-dialog {{size ? \'modal-\' + size : \'\'}}"><div class="modal-content" uib-modal-transclude><\/div><\/div>\n<\/div>\n')}]);angular.module("ui.bootstrap.position").run(function(){angular.$$csp().noInlineStyle||angular.$$uibPositionCss||angular.element(document).find("head").prepend('<style type="text/css">.uib-position-measure{display:block !important;visibility:hidden !important;position:absolute !important;top:-9999px !important;left:-9999px !important;}.uib-position-scrollbar-measure{position:absolute !important;top:-9999px !important;width:50px !important;height:50px !important;overflow:scroll !important;}.uib-position-body-scrollbar-measure{overflow:scroll !important;}<\/style>');angular.$$uibPositionCss=!0});angular.module("reCommon",["ui.bootstrap","ngTouch","ngCookies"]);angular.module("reApp",["reCommon"]);angular.module("reMailThread",["reCommon"]);angular.module("reVideo",["reCommon"]);angular.module("reAd",["reCommon"]);angular.module("reAdSearch",["reCommon"]);angular.module("reServices",["reCommon"]);angular.module("realescort.common",["reCommon"]);angular.module("realescort.forms",["realescort.common"]);angular.module("realescort.views.default",["realescort.common"]);angular.module("realescort.views.wallet",["realescort.common"]);angular.module("realescort.views.cart",["realescort.common"]);angular.module("realescort.views.contact",["realescort.forms","realescort.common"]);angular.module("realescort.views.user",["realescort.common"]);angular.module("realescort.views.news",["realescort.common"]);angular.module("realescort.views.ads",["realescort.forms","realescort.common"]);angular.module("realescort.views.updates",["realescort.common"]);angular.module("realescort.views.reviews",["realescort.forms","realescort.common"]);angular.module("realescort.views.blogs",["realescort.common"]);angular.module("realescort.views.status",["realescort.common"]);angular.module("realescort.views.user.reviews",["realescort.common"]);angular.module("realescort.views.user.ads",["realescort.forms","realescort.common"]);angular.module("realescort.views.services",["realescort.common"]);angular.module("realescort.views.accounts.common",["realescort.forms","realescort.common"]);angular.module("realescort.views.accounts.login",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.account",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.ads",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.edit",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.forgot",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.messages",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.orders",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.dashboard",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.blogs",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.fakes",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.reviews",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.wallet",["realescort.views.accounts.common"]);angular.module("realescort.views.accounts.settings",["realescort.views.accounts.common"]);angular.module("reAd").controller("TravelPlanCtrl",["$scope","$http","$window","$element","$timeout","translate","blockUI","helpText","modal2",function(n,t,i,r,u,f,e,o,s){n.travelPlan=[];n.regionIds=[];n.cityIds=[];n.days=[];n.helpText=o;n.selectedRegion="";n.isLoading=!0;n.init=function(){t({method:"GET",url:n.url}).success(function(t){n.travelPlan=t;u(function(){n.isLoading=!1;n.$broadcast("travelPlanLoaded")})}).error(function(){i.alert(f("unknownError"))})};n.getDayClass=function(n){return n.isSelected?"selected":null};n.getOnlineClass=function(n){return n.isOnline?"online":"offline"};n.toggleDay=function(t){if(t.isSelected=!t.isSelected,t.isSelected)n.days.push(t.dayString);else{var i=n.days.indexOf(t.dayString);i>-1&&n.days.splice(i,1)}};n.showCities=function(n,t){t.stopPropagation();i.alert(n.longTitle)};n.getDays=function(t){for(var u,i,f,e=[],r=0;r<n.travelPlan.months.length;r++)for(u=n.travelPlan.months[r],i=0;i<u.days.length;i++)f=u.days[i],(!t||f.isSelected)&&e.push(f);return e};n.hasSelectedDays=function(){return n.days.length>0};n.hasSelectedRegions=function(){return n.regionIds.length>0};n.hasDisallowedRegions=function(){};n.remove=function(){if(n.hasSelectedDays()){if(!n.confirmPriorityChange())return}else{i.alert(f("daysNotSelected"));return}n.submitChanges("Remove")};n.add=function(){if(n.hasSelectedDays())if(n.hasSelectedRegions()){if(!n.confirmPriorityChange())return}else{i.alert(f("regionsNotSelected"));return}else{i.alert(f("daysNotSelected"));return}n.submitChanges("Add")};n.confirmPriorityChange=function(){for(var t,e,r,s,o=n.getDays(!0),u=0;u<o.length;u++){for(t=o[u],e=!1,r=0;r<t.locations.length;r++)if(s=t.locations[r],s.priorityNumber!=null){e=!0;break}if(e)return t.isToday?i.confirm(f("confirmPriorityChangeToday")):i.confirm(f("confirmPriorityChange"))}return!0};n.submitChanges=function(r){var u=n.getChangeSet(r);e.block();t({method:"POST",url:n.changeUrl,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(u,!0)}).success(function(t){console.log(t.errorUrl);t.errorMessage?i.alert(t.errorMessage):t.errorUrl?s({url:t.errorUrl,scope:n}):(n.days=[],n.travelPlan=t);e.unblock()}).error(function(){i.alert(f("unknownError"));e.unblock()})};n.getChangeSet=function(t){return{adId:n.travelPlan.adId,action:t,regionIds:n.regionIds,cityIds:n.cityIds,days:n.days}};n.selectAll=function(){return n.days=[],angular.forEach(n.getDays(!1),function(t){t.isSelected=!0;n.days.push(t.dayString)}),!1};n.clearAll=function(){return n.days=[],angular.forEach(n.getDays(!1),function(n){n.isSelected=!1}),!1};n.bookOrCancel=function(r,u,e,o){var s={adId:n.travelPlan.adId,day:u.dayString};e&&(s.regionId=e.regionId);t({method:"POST",url:r,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(s,!0)}).success(function(n){o(n)}).error(function(){i.alert(f("unknownError"))})};n.bookFrontPage=function(t,r){if(r.stopPropagation(),!t.isOnline){i.alert(f("adOffline"));return}if(n.travelPlan.frontPageDaysLeft==0){i.confirm(f("noFrontPageDaysWarning"))&&(i.location.href=n.orderUrl+"#frontpage");return}(!t.isToday||i.confirm(f("bookFrontPageTodayWarning")))&&(t.isFrontPageBooking=!0,n.bookOrCancel("/AdTravelPlan/BookFrontPage",t,null,function(i){t.isFrontPageBooking=!1;i.result=="Success"&&(t.frontPageNumber=i.frontPageNumber,t.frontPageNext=i.frontPageNext,n.travelPlan.frontPageDaysLeft=i.frontPageDaysLeft)}))};n.cancelFrontPage=function(t,r){(r.stopPropagation(),!t.isToday||i.confirm(f("cancelFrontPageTodayWarning")))&&(t.isFrontPageBooking=!0,n.bookOrCancel("/AdTravelPlan/CancelFrontPage",t,null,function(i){t.isFrontPageBooking=!1;i.result=="Success"&&(t.frontPageNumber=i.frontPageNumber,t.frontPageNext=i.frontPageNext,n.travelPlan.frontPageDaysLeft=i.frontPageDaysLeft)}))};n.bookCategory=function(t,r){if(r.stopPropagation(),!t.isOnline){i.alert(f("adOffline"));return}if(t.categoryNext>n.travelPlan.categoryAdLimit){i.alert(f("noAvailableCategory"));return}if(n.travelPlan.categoryDaysLeft==0){i.confirm(f("noCategoryDaysWarning"))&&(i.location.href=n.orderUrl+"#category");return}(!t.isToday||i.confirm(f("bookCategoryTodayWarning")))&&(t.isCategoryBooking=!0,n.bookOrCancel("/AdTravelPlan/BookCategory",t,null,function(i){t.isCategoryBooking=!1;i.result=="Success"&&(t.categoryNumber=i.categoryNumber,t.categoryNext=i.categoryNext,n.travelPlan.categoryDaysLeft=i.categoryDaysLeft)}))};n.cancelCategory=function(t,r){(r.stopPropagation(),!t.isToday||i.confirm(f("cancelCategoryTodayWarning")))&&(t.isCategoryBooking=!0,n.bookOrCancel("/AdTravelPlan/CancelCategory",t,null,function(i){t.isCategoryBooking=!1;i.result=="Success"&&(t.categoryNumber=i.categoryNumber,t.categoryNext=i.categoryNext,n.travelPlan.categoryDaysLeft=i.categoryDaysLeft)}))};n.bookPriority=function(t,r,u){if(u.stopPropagation(),t.locations.length===0){i.alert(f("travelPlanNeeded"));return}if(!t.isOnline){i.alert(f("adOffline"));return}if(n.travelPlan.priorityDaysLeft==0){i.confirm(f("noPriorityDaysWarning"))&&(i.location.href=n.orderUrl+"#priority");return}(!t.isToday||i.confirm(f("bookPriorityTodayWarning")))&&(r.isPriorityBooking=!0,n.bookOrCancel("/AdTravelPlan/BookPriority",t,r,function(t){r.isPriorityBooking=!1;t.result=="Success"&&(r.priorityNumber=t.priorityNumber,r.priorityNext=t.priorityNext,n.travelPlan.priorityDaysLeft=t.priorityDaysLeft)}))};n.cancelPriority=function(t,r,u){(u.stopPropagation(),!t.isToday||i.confirm(f("cancelPriorityTodayWarning")))&&(r.isPriorityBooking=!0,n.bookOrCancel("/AdTravelPlan/CancelPriority",t,r,function(t){r.isPriorityBooking=!1;t.result=="Success"&&(r.priorityNumber=t.priorityNumber,r.priorityNext=t.priorityNext,n.travelPlan.priorityDaysLeft=t.priorityDaysLeft)}))};n.getCityCount=function(){var i=0,t;if(n.regionOptions)for(t=0;t<n.regionOptions.length;t++)i+=n.regionOptions[t].cities.length+1;return i};n.loadCities=function(){var r={regionIds:n.regionIds};t({method:"POST",url:"/AdTravelPlan/GetCities",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:$.param(r,!0)}).success(function(t){n.regionOptions=t;n.cityIds=[]}).error(function(){i.alert(f("unknownError"))})}}]);angular.module("reAd").directive("reTravelPlan",["$window",function(n){return{controller:"TravelPlanCtrl",link:function(t,i,r){t.url=r.url;t.changeUrl=r.changeUrl;t.orderUrl=r.orderUrl;t.init();t.$on("travelPlanLoaded",function(){i.find("div.iconContainer .text").on("click",function(t){var i=$(this).closest("div.iconContainer"),r=i.find("[title]").attr("title");n.alert(r);t.stopPropagation();t.stopImmediatePropagation();t.preventDefault()})})}}}]);angular.module("reAdSearch").directive("reSearch",["$timeout",function(n){return{restrict:"A",link:function(){n(function(){var n=$(".content-box.location");n.find("a.clear").on("click",function(){return $(this).prev("input").val(""),!1});n.find("a.expand").on("click",function(){var n=$(this).closest("div.region"),t=n.next("ul.cities");$(this).toggleClass("on");t.toggleClass("expanded")});n.find("input.city").on("click",function(){var t=$(this).closest(".cities"),i=t.prev(".region"),n=!0;t.find("input.city").each(function(){return n=$(this).prop("checked"),n?void 0:!1});i.find("input").prop("checked",n)});n.find(".region input").on("click",function(){var n=$(this).closest(".region"),t=n.next(".cities"),i=$(this).prop("checked");t.find("input.city").prop("checked",i)})})}}}]);angular.module("reCommon").controller("SiteCtrl",[function(){var n=this;n.menu={};n.toggleMenu=function(t){var i={};i[t]=!n.menu[t];n.menu=i}}]);angular.module("reCommon").controller("SlideshowCtrl",["$scope","$sce","$uibModalInstance","keyboard","modalData",function(n,t,i,r,u){n.index=u.index;n.urls=u.urls;n.titles=u.titles;n.types=u.types;n.url=null;n.title=null;n.type=null;n.update=function(){n.url=t.trustAsResourceUrl(n.urls[n.index]);n.title=n.titles[n.index];n.type=n.types[n.index]};n.prev=function(){n.index=n.index>0?n.index-1:n.urls.length-1;n.update()};n.next=function(){n.index=n.index<n.urls.length-1?n.index+1:0;n.update()};r.on(function(t){n.$apply(function(){switch(t.which){case 37:n.prev();break;case 39:n.next()}})});n.$on("$destroy",function(){r.destroy()});n.update()}]);angular.module("reCommon").directive("reAjaxForm",["$window","$parse",function(n,t){return{restrict:"A",scope:!0,link:function(i,r,u){var o=t(u.formSuccess),s=t(u.formError),f=function(n){i.busy=n;r.toggleClass("busy",n);var t=r.find("button[re-busy]");n?(t.data("re-busy-on")||(t.data("re-busy-on",t.attr("re-busy")),t.data("re-busy-off",t.text())),t.text(t.data("re-busy-on"))):t.text(t.data("re-busy-off"))},e=function(t){var y=r.find("input,select,textarea"),e=r.find(".re-messages"),p=r.find("small.input"),a,l,c,h,v;if(t.type=="redirect")n.location.href=t.redirectUrl;else if(t.type=="reload")n.location.reload(!0);else if(t.type=="error"||t.type=="warning"){for(e.empty(),y.removeClass("re-invalid"),p.hide(),c=$("<ul>"),c.addClass("error"),t.type=="warning"&&y.filter("[warn]").val("false"),h=0;h<t.controls.length;h++)a=r.find("[name='"+t.controls[h].name+"']"),a.length>0&&(l=a.next("small.input"),a.addClass("re-invalid"),l.length==0&&(l=$("<small />",{"class":"input"}),l.insertAfter(a)),l.addClass("invalid"),l.text(t.controls[h].message),l.show()),v=$("<li />",{text:t.controls[h].message}),c.append(v);e.addClass("error");e.append(c);e.show();e.length>0&&$(n).scrollTop(e.offset().top);n.grecaptcha&&grecaptcha.reset();i.$apply(function(){s(i)});f(!1)}else if(t.messages.length>0){for(e.empty(),y.removeClass("re-invalid"),p.hide(),c=$("<ul>"),h=0;h<t.messages.length;h++)v=$("<li />",{text:t.messages[h]}),c.append(v);e.removeClass("error");e.append(c);e.show();n.grecaptcha&&grecaptcha.reset();"formClear"in u&&r[0].reset();i.$apply(function(){o(i)});f(!1)}};r.ajaxForm({dataType:"json",beforeSubmit:function(){if(i.busy)return!1;f(!0)},success:e,error:function(n){var t={type:"error",controls:[{name:""}]};t.controls[0].message=n.status==503?"We are updating our systems, please try again in a few minutes.":"An unknown error occurred. Please try again.";e(t)}})}}}]);angular.module("reCommon").directive("reDatepicker",["$filter",function(){return{restrict:"A",link:function(n,t){var i=new Pikaday({defaultDate:moment(t.val(),"DD-MM-YYYY").toDate(),format:"DD-MM-YYYY",field:t[0]})}}}]);angular.module("reCommon").directive("reHelp",["helpText",function(n){return{restrict:"A",scope:{textId:"@reHelp"},link:function(t,i){i.on("click",function(){return n(t.textId),!1})}}}]);angular.module("reCommon").directive("hls",[function(){return{restrict:"A",link:function(n,t,i){var u=i.hls,r;if(Hls.isSupported()){r=new Hls({autoStartLoad:!0});function n(t,i){i.frag.start>0&&(r.off(Hls.Events.FRAG_LOADED,n),r.stopLoad())}function i(){t.off("play",i);r.off(Hls.Events.FRAG_LOADED,n);r.startLoad()}r.on(Hls.Events.FRAG_LOADED,n);t.on("play",i);r.loadSource(u);r.attachMedia(t[0])}else t[0].canPlayType("application/vnd.apple.mpegurl")&&(t[0].src=u)}}}]);angular.module("reCommon").directive("reModal1",["modal1",function(n){return{restrict:"A",scope:{success:"&reModal"},link:function(t,i,r){i.on("click",function(){var i=n(r.href);return i.result.then(function(){t.success()}),!1})}}}]);angular.module("reCommon").directive("reModal2",["modal2",function(n){return{restrict:"A",link:function(t,i,r){i.unbind().on("click",function(){if(r.reModal2||r.href){var i={url:r.reModal2||r.href,scope:t,mode:r.mode};r.size==="small"&&(i.style="small");n(i)}return!1})}}}]);angular.module("reCommon").directive("rePopup",["$window","colorbox",function(n,t){return{link:function(n,i,r){i.on("click",function(){return t.openUrl(r.href,r.popupWidth,r.iframe||!1),!1})}}}]);angular.module("reCommon").directive("rePrint",["$window",function(n){return{link:function(){n.print()}}}]);angular.module("reCommon").directive("reSlideshow",["$timeout","modal1",function(n,t){return{restrict:"A",link:function(i,r,u){function f(n){var e=n.attr("rel")||"",f=r.find("a[rel='"+e+"']"),i={urls:[],titles:[],types:[],index:f.index(n)};f.each(function(){i.urls.push($(this).attr("href"));i.titles.push($(this).attr("title"));i.types.push($(this).attr("reltype")||"image")});t(u.reSlideshow,i,"SlideshowCtrl").result.catch(angular.noop)}n(function(){var n=r.find("a[rel]");n.each(function(){$(this).on("click",function(){return f($(this)),!1})})})}}}]);angular.module("reCommon").directive("reToggle",["$http",function(n){return{restrict:"A",scope:!0,link:function(t,i,r){var o=r.href,f=r.toggleOn,e=r.toggleOff,h=r.toggleType,u=r.reToggle=="true",s=function(){h==="class"?i.removeClass(f+" "+e).addClass(u?f:e):i.text(u?f:e)};if(t.toggle=function(){u=!u;s()},s(),o)i.on("click",function(){return n.get(o),t.toggle(),!1})}}}]);angular.module("reCommon").directive("reTooltip",["$http","colorbox",function(n,t){return{scope:{headline:"@headline",content:"@reTooltip"},link:function(i,r){r.attr("title",i.content);r.css("cursor","pointer");r.on("click",function(){var r={headline:i.headline,content:i.content};return n.post("/Shared/AlertBox",r).success(function(n){t.openHtml(n)}),!1})}}}]);angular.module("reCommon").directive("reTranslation",["$rootScope",function(n){return{restrict:"E",link:function(t,i,r){n.translate||(n.translate={});n.translate[r.key]=r.value;i.remove()}}}]);angular.module("reCommon").factory("blockUI",[function(){return{block:function(){$.blockUI({message:"<Image src='/Content/Images2/Loaders/Loader32x32.gif' alt='Loading' style='margin:10px;' /><br /><span>Loading...<\/span>",bindEvents:!1})},unblock:function(){$.unblockUI()}}}]);angular.module("reCommon").factory("colorbox",[function(){return{openUrl:function(n,t,i){$.colorbox({href:n,iframe:i,overlayClose:!0,width:t||"875px",onComplete:function(){$(this).colorbox.resize()}})},openHtml:function(n,t,i){$.colorbox({html:n,iframe:i,overlayClose:!0,width:t||"875px",onComplete:function(){$(this).colorbox.resize()}})}}}]);angular.module("reCommon").factory("helpText",["colorbox",function(n){return function(t){var i="/Help/Text/?helpTextIDs="+t;n.openUrl(i)}}]);angular.module("reCommon").factory("inject",["$parse",function(){return function(n){var r="script#"+(n||"vm"),t=angular.element(r),i=null;return t.length>0&&(i=angular.fromJson(t.html())),i}}]);angular.module("reCommon").factory("keyboard",["$document",function(n){var i={},t=null;return i.destroy=function(){t&&(n.off("keydown",t),t=null)},i.on=function(i){if(!t)n.on("keydown",t=i)},i}]);angular.module("reCommon").factory("list",[function(){return{map:function(n,t){for(var r=[],i=0;i<n.length;i++)r.push(t(n[i]));return r},sum:function(n,t){for(var r=0,i=0;n&&i<n.length;i++)r+=t(n[i]);return r},any:function(n,t){for(var i=0;i<n.length;i++)if(t(n[i]))return!0;return!1},all:function(n,t){for(var i=0;i<n.length;i++)if(!t(n[i]))return!1;return!0},indexOf:function(n,t){for(var i=0;i<n.length;i++)t(n[i])&&i;return-1},first:function(n,t){for(var i=0;i<n.length;i++)if(t(n[i]))return n[i];return null},replace:function(n,t){for(var i=0;i<t.length;i++)i<n.length?n[i]=t[i]:n.push(t[i])},add:function(n,t){for(var i=0;i<t.length;i++)n.push(t[i])},remove:function(n,t){for(var i=0;i<n.length;i++)t(n[i])&&n.splice(i,1);return n},removeItem:function(n,t){for(var i=0;i<n.length;i++)n[i]===t&&n.splice(i,1);return n},filter:function(n,t){for(var r=[],i=0;i<n.length;i++)t(n[i])&&r.push(n[i]);return r}}}]);angular.module("reCommon").factory("loading",["$timeout",function(){var n=angular.element("div#loading");return function(t,i){n.toggleClass(i,t);n.toggle(t)}}]);angular.module("reCommon").factory("modal1",["$uibModal","loading",function(n,t){return function(i,r,u,f){var o,s,e;return f=f||{},t(!0,f.className),i.startsWith("data:")?s=$("<Image />",{src:i})[0]:o=i,e=n.open({animation:!1,templateUrl:o,template:s,size:"lg",controller:u,backdropClass:f.className,backdrop:f.backdrop||!0,resolve:{modalData:function(){return r}}}),e.rendered.then(function(){t(!1,f.className)}),e}}]);angular.module("reCommon").factory("modal2",["$http","$compile",function(n,t){return function(i){function o(){var n=r.children(".x-stacked");n.first().remove();n.length===1&&s()}function s(){r.removeClass("loading loaded");r.children(".x-stacked").remove();f.removeClass("fixed");h=!0}function c(){var t,r;if(i.urlData){t=new FormData;for(r in i.urlData)t.append(r,i.urlData[r]);return n.post(i.url,t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}})}return n.get(i.url)}var f=$(document.body),r=f.children(".x-modals"),u=$("<div />",{"class":"x-stacked"}),e=r.find(".x-backdrop"),h=!1;i.style&&u.addClass(i.style);u.on("click",function(n){$(this).is(n.target)&&!i.lock&&s()});if(r.length===0&&(r=$("<div />",{"class":"x-modals"}),e=$("<div />",{"class":"x-backdrop"}),i.style&&e.addClass(i.style),r.prepend(e),f.append(r),!i.lock))e.on("click",s);r.addClass("loading");f.addClass("fixed");r.prepend(u);i.mode==="replace"&&u.next().remove();c().then(function(n){if(h)return n;r.removeClass("loading");r.addClass("loaded");u.append(n.data);i.scope.modals=i.scope.modals||{};var f=i.scope.$new(!1);if(f.$dismiss=function(){return o(),!1},f.$accept=function(n){return o(),f.modals.accepted=!0,i.accept&&i.accept(n),!1},f.$decline=function(n){o();f.modals.accepted=!1;i.decline&&i.decline(n)},t(u)(f),i.scrollTo){const n=u.find("> *:visible .content").first();setTimeout(function(){const t=n.find(i.scrollTo)[0];t.scrollIntoView(!0)})}return n}).catch(function(){})}}]);angular.module("reCommon").factory("rest",["$http","$q",function(n,t){return{post:function(i,r){return t(function(t,u){n.post(i,r).then(function(n){t(n.data)},function(n){u(n.data)})})},get:function(i){return t(function(t,r){n.get(i).then(function(n){t(n.data)},function(n){r(n.data)})})}}}]);angular.module("reCommon").factory("translate",["$rootScope",function(n){return function(t){return n.translate[t]}}]);angular.module("reServices").directive("reByAd",["$timeout","autoscroll",function(n,t){return{restrict:"A",scope:{serviceId:"@"},link:function(i,r){var u=function(n){var i="[data-id='"+n+"']",u=r.find("div.links a"),f=r.find(".service-list-item"),o=r.find("div.no-longer"),e=f.filter(i),s=u.filter(i),h=r.find(".vocabulary");u.removeClass("selected");s.addClass("selected");f.hide();e.show();o.toggle(e.length==0);t(h)};n(function(){r.find("div.links a").on("click",function(){var n=$(this).data("id");return u(n),!1});i.serviceId&&u(i.serviceId)})}}}]);angular.module("realescort.common").config(["$compileProvider",function(n){n.aHrefSanitizationWhitelist(/^\s*(https?|tel|sms|whatsapp|skype|snapchat|sgnl|instagram|kik):/)}]);angular.module("realescort.common").controller("AcceptCtrl",["$scope","$uibModalInstance","$http","modalData","modal1","loading",function(n,t,i,r,u,f){n.accept=function(){t.close();f(!0);i.post(r.acceptUrl).then(function(){u(r.confirmUrl)})}}]);angular.module("realescort.common").controller("PagingCtrl",["$scope","rest","inject",function(n,t,i){function u(n){var t=$.Deferred();return t.reject(n),t.promise()}var r=i();n.loading=!1;n.initializing=!0;n.done=!1;n.scrollId=r.scrollId||r.searchUrl;n.payload=r.payload||{};n.load=function(i,f){function o(t){return n.initializing=n.loading=!1,t}function s(){n.initializing=n.loading=!1;n.done=!0}if(n.loading||n.done)return u();n.loading=!0;var e=angular.extend({},n.payload,{page:i,reload:f});return t.post(r.searchUrl,e).then(o,s)};n.restore=function(){var t=sessionStorage.getItem("scrollId:"+n.scrollId);return t?JSON.parse(t):null};n.store=function(t){var i=JSON.stringify(t);sessionStorage.setItem("scrollId:"+n.scrollId,i)}}]);angular.module("realescort.common").controller("PagingCtrl2",["$scope","$http","$q","inject",function(n,t,i,r){var f=r(),u=null;n.loading=!1;n.initializing=!0;n.done=!1;n.payload=f.payload||{};n.load=function(r,e,o){function s(t){return n.initializing=n.loading=!1,t}function h(t){t.status===404&&(n.initializing=n.loading=!1,n.done=!0);throw t;}if(!o&&(n.loading||n.done))return i.reject({status:42});n.loading=!0;u!==null&&u.resolve();var c=angular.extend({},n.payload,{page:r,reload:e}),l={timeout:(u=i.defer()).promise};return t.post(f.searchUrl,c,l).then(s,h)}}]);angular.module("realescort.common").controller("PanelCtrl",["$scope","$http","$q","inject",function(n,t,i,r){var f=r(),u=null;n.loading=!1;n.initializing=!0;n.done=!1;n.payload=f.payload||{};n.load=function(r,e,o){function s(t){return n.initializing=n.loading=!1,t}function h(t){t.status===404&&(n.initializing=n.loading=!1,n.done=!0);throw t;}if(!o&&(n.loading||n.done))return i.reject({status:42});n.loading=!0;u!==null&&u.resolve();var c=angular.extend({},n.payload,{page:r,reload:e}),l={timeout:(u=i.defer()).promise};return t.post(f.searchUrl,c,l).then(s,h)}}]);angular.module("realescort.common").directive("reAccept",["modal1",function(n){return{restrict:"A",link:function(t,i,r){var u={acceptUrl:r.reAccept,confirmUrl:r.confirmUrl};i.on("click",function(){return n(r.href,u,"AcceptCtrl"),!1})}}}]);angular.module("realescort.common").directive("reAutoscroll",["$timeout","autoscroll",function(n,t){return{restrict:"A",link:function(i,r){n(function(){t(r,!0)})}}}]);angular.module("realescort.common").directive("autosize",[function(){return{restrict:"A",link:function(n,t){autosize(t)}}}]);angular.module("realescort.common").directive("reChars",[function(){return{restrict:"A",scope:{data:"=reChars"},link:function(n,t,i){function u(){var i=t.val().length;n.data={count:i,left:r-i,max:r}}var r=parseInt(i.maxlength)||0;u();t.on("input",function(){n.$apply(function(){u()})})}}}]);angular.module("realescort.common").directive("reClick",["$parse",function(n){return{restrict:"A",link:function(t,i,r){for(var u,o=n(r.reClick),f={},e=0;e<i[0].attributes.length;e++)u=i[0].attributes[e],u.name.substring(0,4)==="arg-"&&(f[u.name.substr(4)]=u.value);r.arg!==undefined&&(f=r.arg);i.on("click",function(){return t.$apply(function(){o(t,{$args:f})}),!1})}}}]);angular.module("realescort.common").directive("reConfirm",[function(){return{restrict:"A",link:function(n,t,i){t.on("click",function(){return confirm(i.reConfirm)})}}}]);angular.module("realescort.common").directive("reConfirm2",["modal2",function(n){return{restrict:"A",link:function(t,i,r){if(r.reConfirm2)i.on("click",function(){if(r.confirmV2&&i.data("accepted")||!r.confirmV2&&t.modals&&t.modals.accepted)return!0;var u={url:r.reConfirm2,scope:t,accept:function(){i.data("accepted",!0);setTimeout(function(){i[0].focus();i[0].click?i[0].click():i.trigger("click")})}};return n(u),!1})}}}]);angular.module("realescort.common").directive("reCopy",[function(){return{restrict:"A",link:function(n,t,i){t.on("click",function(){return navigator.clipboard&&window.isSecureContext&&navigator.clipboard.writeText(i.reCopy),t.addClass("done"),setTimeout(function(){t.removeClass("done")},1500),n.$apply(function(){n.copied=!0}),!1})}}}]);angular.module("realescort.common").directive("reCountdown",["$interval",function(n){return{restrict:"A",link:function(t,i,r){function u(){var t=moment.utc(r.reCountdown),u=moment.utc(),n=t.diff(u,"seconds");n>0?i.attr("count",f(n)):i.removeAttr("count")}function f(n){var t=parseInt(n,10),i=Math.floor(t/3600),r=Math.floor(t/60)%60,u=t%60;return[i,r,u].map(n=>n<10?"0"+n:n).filter((n,t)=>n!=="00"||t>0).join(":")}u();var e=n(u,1e3);t.$on("$destroy",function(){n.cancel(e)})}}}]);angular.module("realescort.common").directive("reCounter",[function(){return{restrict:"A",link:function(n,t,i){const r=t.find("input, textarea");if(r.length>0){const f=parseInt(i.reCounter||"0"),u=parseInt(r.attr("maxlength")||"0"),n=$("<div class='chars'><\/div>");t.append(n);r.on("input",function(){const t=($(this).val()||"").length;u>0?n.text(`${t} / ${u}`):n.text(t);n.toggleClass("error",t<f)});r.trigger("input")}}}}]);angular.module("realescort.common").directive("reDatepick",["$filter",function(){function n(n){return n===undefined||n===""?undefined:n==="today"?moment().toDate():moment(n,"YYYY-MM-DD").toDate()}return{restrict:"A",link:function(t,i,r){i.attr("readonly","");var u=new Pikaday({defaultDate:moment(i.val(),"DD-MM-YYYY").toDate(),format:"DD-MM-YYYY",field:i[0],maxDate:n(r.max),minDate:n(r.min)})}}}]);angular.module("realescort.common").directive("reDisclaimer",["$cookies","modal2","$http",function(n,t,i){return{restrict:"A",scope:{reDisclaimer:"@"},link:function(r){function e(){f.forEach(function(n){var t=window.getComputedStyle(n);t&&t.display==="none"&&(r.hasAdBlocker=!0)});var n={url:r.reDisclaimer,scope:r,lock:!0,style:"disclaimer",accept:function(){i.get("/enter")}};t(n)}if(n.get("18")!=="1"){var u=location.host.split("."),o=u[u.length-2]+"."+u[u.length-1],f=document.querySelectorAll("#ad-detector > *");setTimeout(e)}}}}]);angular.module("realescort.common").directive("reFile",[function(){return{restrict:"A",link:function(n,t){var i=t.find("input[type=file]"),r=t.find("img.file"),u=t.find("input.remove-input"),f=t.find(".remove");t.append(i);i.on("change",function(){var i=this.files?this.files[0]:null,n;if(i!==null){n=new FileReader;$(n).on("load",function(){t.addClass("has-file has-preview");r.attr("src",n.result)});n.readAsDataURL(i)}});f.on("click",function(n){return i.attr("src",""),t.removeClass("has-file has-preview"),u.val("true"),n.preventDefault(),n.stopPropagation(),!1})}}}]);angular.module("reCommon").directive("reFilter",["$http",function(){return{restrict:"A",scope:{},link:function(n,t){var i=t.find("input"),r=t.find(".filterable");i.on("input",function(){var n=$(this).val().toLowerCase();n.length===0?r.removeClass("hidden"):r.each(function(){var t=$(this).text().toLowerCase().includes(n);return $(this).toggleClass("hidden",!t)})});i.trigger("input")}}}]);angular.module("realescort.common").directive("hCaptcha",["$parse",function(n){return{restrict:"A",require:"?ngModel",link:function(t,i,r,u){function e(){i.find("iframe").remove();hcaptcha.render(i[0],s);i.append(f)}var f=i.find("input").detach(),o=n(r.ngVerify),s={sitekey:r.hCaptcha,callback:function(n){f.val(n);r.autosubmit&&f.closest("form").trigger("submit");u&&(u.$setViewValue(n),o(t))}};e();$(window).on("recaptcha_reset",function(){e()})}}}]);angular.module("realescort.common").directive("hls",[function(){return{restrict:"A",link:function(n,t,i){var u=i.hls,r;if(Hls.isSupported()){r=new Hls({autoStartLoad:!0});function n(t,i){i.frag.start>0&&(r.off(Hls.Events.FRAG_LOADED,n),r.stopLoad())}function i(){t.off("play",i);r.off(Hls.Events.FRAG_LOADED,n);r.startLoad()}r.on(Hls.Events.FRAG_LOADED,n);t.on("play",i);r.loadSource(u);r.attachMedia(t[0])}else t[0].canPlayType("application/vnd.apple.mpegurl")&&(t[0].src=u)}}}]);angular.module("realescort.common").directive("reModal2",["modal2",function(n){return{restrict:"A",link:function(t,i,r){i.unbind().on("click",function(){if(r.reModal2||r.href){var i={url:r.reModal2||r.href,scope:t,mode:r.mode};r.size==="small"&&(i.style="small");console.log("miav!");n(i)}return!1})}}}]);angular.module("realescort.common").directive("reModel",[function(){return{restrict:"A",link:function(n,t,i){function f(){n[i.reModel]=r.is(":checked")}function e(){n[i.reModel]=u.val()}var r=t.find("input[type=checkbox]").first(),u=t.find("input[type=radio]").first();t.on("click",function(){r.length>0&&n.$apply(f);u.length>0&&n.$apply(e)});r.length>0&&f()}}}]);angular.module("realescort.common").directive("paging",["$window","$compile",function(n,t){function h(){i.scrollMin=u.scrollTop();i.scrollMax=i.scrollMin+u.height()}function o(){r.store(i)}function e(n){f.toggleClass("busy",n)}function s(n){f.toggleClass("empty",n)}function c(n){var i=t(n)(r);f.append(i)}function a(){h();var n=f.offset().top+f.height();i.scrollMax+100>=n&&v();o()}function v(){r.loading||r.done||(e(!0),s(!1),r.load(i.pages+1,!1).then(function(n){c(n);e(!1);i.pages++;o()},function(){e(!1)}))}function y(){h()}function p(){i.scrollMin=0;i.scrollMax=0;i.pages=1;r.done=!1;f.empty();o();l()}function l(){var n=r.restore()||i,t=n.scrollMin>0;t||(n.pages=1);e(!0);s(!1);r.load(n.pages,t).then(function(t){c(t);e(!1);u.scrollTop(n.scrollMin);i=n;u.trigger("scroll")},function(){e(!1);n.pages===1&&s(!0)})}var u=$(n),r,f,i={scrollMin:0,scrollMax:0,pages:1};return{restrict:"A",controller:"PagingCtrl",link:function(n,t){if(f=t,r=n,r.reset=p,t.attr("no-autoscroll")===undefined){u.on("resize",y);u.on("scroll",function(){a(n)})}setTimeout(function(){u.scrollTop(0)});l()}}}]);angular.module("realescort.common").directive("paging2",["$window","$compile",function(n,t){function y(){i.scrollMin=h.scrollTop();i.scrollMax=i.scrollMin+h.height();i.elementMin=f.offset().top;i.elementMax=i.elementMin+f.height()}function p(n){var t,u;e&&(t=sessionStorage.getItem(e),t&&(i=JSON.parse(t)));n&&o&&(u=sessionStorage.getItem(o),u&&(r.payload=JSON.parse(u)))}function l(n){var t,u;e&&(t=JSON.stringify(i),sessionStorage.setItem(e,t));n&&o&&(u=JSON.stringify(r.payload),sessionStorage.setItem(o,u))}function u(n){f.toggleClass("busy",n)}function s(n){f.toggleClass("empty",n)}function a(n){var i=t(n)(r);f.append(i)}function v(){y();i.scrollMax+250>=i.elementMax&&b();l()}function w(){h.on("scroll resize",function(){c=!0});setInterval(function(){c&&(c=!1,v())},250);v()}function b(){r.loading||r.done||(u(!0),s(!1),r.load(i.pages+1,!1).then(function(n){a(n.data);u(!1);i.pages++;l()},function(n){n.status!==42&&u(!1)}))}function k(){i.pages=1;r.done=!1;u(!0);s(!1);f.empty();l(!0);r.load(i.pages,!1,!0).then(function(n){a(n.data);u(!1)},function(n){n.status!==-1&&u(!1);n.status===404&&(i.pages===1||reload)&&s(!0)})}function d(){var n=i.scrollMin>=i.elementMin,t=n?i.pages:1;i.pages=t;u(!0);s(!1);r.load(t,n,!0).then(function(n){a(n.data);u(!1);h.scrollTop(i.scrollMin);e&&w()},function(t){t.status!==-1&&u(!1);t.status===404&&(i.pages===1||n)&&s(!0)})}var h=$(n),r,f,o,e,c=!1,i={scrollMin:0,scrollMax:0,elementMin:0,elementMax:0,pages:1};return{restrict:"A",controller:"PagingCtrl2",link:function(n,t,i){f=t;r=n;r.reset=k;u(!0);i.store&&t.attr("no-scroll")===undefined&&(e=i.store+"@paging.scroll");i.store&&t.attr("no-store")===undefined&&(o=i.store+"@paging.data");p(!0);d()}}}]);angular.module("realescort.common").directive("panel",["$compile","component","injector","request","spy",function(n,t,i,r,u){return{restrict:"A",link:function(f,e,o){function b(t){return e=$(t),a.render.forEach(function(n){n(e)}),n(e)(f)}function nt(n){h.scrollMin=n.scrollMin;h.scrollMax=n.scrollMax;h.elementMin=l.offset().top;h.elementMax=h.elementMin+l.height();h.count=c.offset();var t=(h.scrollMax-h.elementMin)/(h.elementMax-h.elementMin);h.smartCount=Math.min(Math.max(Math.ceil(h.count*t),w.size),1e4)}function tt(){sessionStorage.setItem(p,JSON.stringify(h))}function it(){var n=sessionStorage.getItem(p);n&&(h=JSON.parse(n))}function rt(){v&&a.payload&&sessionStorage.setItem(v,JSON.stringify(a.payload))}function ut(){if(v){var n=sessionStorage.getItem(v);n&&(a.payload=JSON.parse(n)||{})}}function d(){return s.addClass("is-loading"),s.removeClass("is-empty"),c.next().then(function(n){l.append(b(n.data));s.removeClass("is-loading")}).catch(function(n){n.status!==42&&n.status!==-1&&s.removeClass("is-loading");(n.status===404||c.state.finished)&&s.addClass("is-done");throw n;})}function ft(){return s.addClass("is-loading"),s.removeClass("is-empty"),c.next().then(function(n){l.prepend(b(n.data));s.removeClass("is-loading");s.toggleClass("is-done",c.state.finished)}).catch(function(n){n.status!==42&&n.status!==-1&&s.removeClass("is-loading");n.status===404&&s.addClass("is-done");throw n;})}function g(n){return s.addClass("is-loading"),s.removeClass("is-empty is-done"),l.empty(),v&&rt(),c.reset(n).then(function(n){l.html(b(n.data));s.removeClass("is-loading");s.toggleClass("is-done",c.state.finished)}).catch(function(n){n.status!==42&&n.status!==-1&&s.removeClass("is-loading");n.status===404&&s.addClass("is-empty");throw n;})}function et(n){nt(n);tt();h.scrollMax>h.elementMax-200&&d().catch(angular.noop)}function ot(){ut();c=r(k,a.payload,w);s.attr("no-load")===undefined&&(it(),g(h.smartCount).then(function(){s.attr("no-scroll")===undefined&&(u.move(h.scrollMin),u.trigger(),u.track(et));a.load()}).catch(angular.noop))}var s,l,a,y={},c,h={},p,v,w,k;i(y);a=t(o,f,{reset:function(){g().catch(angular.noop)},render:[],prev:function(){ft().catch(angular.noop)},next:function(){d().catch(angular.noop)},payload:y.payload||{},load:function(){}});s=e;l=e.children(".results");emptyElement=e.children(".empty");loaderElement=e.children(".loader");k=s.attr("url")||y.searchUrl;w={size:parseInt(s.attr("size"))||10,total:parseInt(s.attr("total"))||0};o.store&&e.attr("no-scroll")===undefined&&(p=(o.store||o.url)+"@panel.scroll");o.store&&e.attr("no-store")===undefined&&(v=(o.store||o.url)+"@panel.data");ot()}}}]);angular.module("realescort.common").directive("recaptcha",["$parse",function(n){return{restrict:"A",require:"?ngModel",link:function(t,i,r,u){var f=n(r.ngVerify),e={sitekey:r.recaptcha,callback:function(n){u.$setViewValue(n);f(t)}};$(function(){if(grecaptcha.render(i[0],e),navigator.userAgent&&navigator.userAgent.includes("Chrome/59")){var n=$("<a><\/a>",{href:"/faq/256/phone-number-recaptcha-is-not-working","class":"recaptcha-info",target:"_blank",text:"Not working? Click here for help."});n.insertAfter(i.find("iframe"))}})}}}]);angular.module("realescort.common").directive("rCaptcha",[function(){return{restrict:"A",link:function(n,t,i){function u(){if(navigator.userAgent&&navigator.userAgent.includes("Chrome/59")){var n=$("<a><\/a>",{href:"/faq/256/phone-number-recaptcha-is-not-working","class":"recaptcha-info",target:"_blank",text:"Not working? Click here for help."});n.insertAfter(t.find("iframe"))}t.append(r)}var r=t.find("input").detach(),f={sitekey:i.rCaptcha,callback:function(n){r.val(n)}};grecaptcha.ready(function(){grecaptcha.render(t[0],f);u()});$(window).on("recaptcha_reset",function(){u()})}}}]);angular.module("reCommon").directive("reSlide",["modal1",function(n){return{restrict:"A",link:function(t,i,r){var u=r.reSlide;i.on("click",function(){var t={urls:[$(this).attr("href")],titles:[$(this).attr("title")],types:[$(this).attr("reltype")||"image"],index:0};return n(u,t,"SlideshowCtrl"),!1})}}}]);angular.module("realescort.common").directive("reTags",[function(){return{scope:{filterBy:"="},link:function(n,t){function r(n){var t=i.filter(function(){return(n=$.trim(n),!n)?!0:$(this).text().toLowerCase().includes(n)});i.hide();t.show()}var i=t.find(".x-tag");n.$watch("filterBy",r);i.on("click",function(){return $(this).toggleClass("on"),!1})}}}]);angular.module("realescort.common").directive("reTerms",["modal1",function(n){return{restrict:"A",link:function(t,i,r){function f(){n(u).result.then(function(){i.data("accepted","truex");i.trigger("click")})}var u=r.reTerms;i.on("click",function(){if(!$(this).data("accepted"))return f(),!1})}}}]);angular.module("realescort.common").directive("reTerms2",["modal2",function(n){return{restrict:"A",link:function(t,i,r){var u={url:r.reTerms2,scope:t,accept:function(){i.data("accepted","truex");i.find("input").prop("checked",!0)}};i.on("click",function(){if(!$(this).data("accepted"))return n(u),!1})}}}]);angular.module("realescort.common").directive("reTooltip",["modal1",function(n){return{link:function(t,i,r){i.attr("title",r.reTooltip);i.css("cursor","pointer");i.removeAttr("re-tooltip");i.on("click",function(){var t="/modals/text?s="+encodeURIComponent(r.reTooltip);return n(t),!1})}}}]);angular.module("realescort.common").directive("reToplink",["$window",function(n){var t=angular.element(n);return{restrict:"A",link:function(n,i){t.on("scroll",function(){i.toggleClass("active",t.scrollTop()>0)})}}}]);angular.module("realescort.common").filter("html",["$sce",function(n){return function(t){return n.trustAsHtml(t)}}]);angular.module("realescort.common").factory("autoscroll",["$window",function(n){return function(t,i){var r=$(n),u=t.offset(),f=r.scrollTop()+r.height();u&&(!i||u.top>f)&&r.scrollTop(u.top)}}]);angular.module("realescort.common").factory("component",["$parse",function(n){return function(t,i,r){var u=t.ngAttach?n(t.ngAttach)(i):i;return angular.extend(u,r),u.init&&u.init.apply(u),u}}]);angular.module("realescort.common").factory("injector",[function(){return function(n,t){var u="script#"+(t||"vm"),i=angular.element(u),r;i.length>0&&(r=angular.fromJson(i.html()),angular.extend(n,r))}}]);angular.module("realescort.common").factory("modal2",["$http","$compile",function(n,t){return function(i){function o(){var n=r.children(".x-stacked");n.first().remove();n.length===1&&s()}function s(){r.removeClass("loading loaded");r.children(".x-stacked").remove();f.removeClass("fixed");h=!0}function c(){var t,r;if(i.urlData){t=new FormData;for(r in i.urlData)t.append(r,i.urlData[r]);return n.post(i.url,t,{transformRequest:angular.identity,headers:{"Content-Type":undefined}})}return n.get(i.url)}var f=$(document.body),r=f.children(".x-modals"),u=$("<div />",{"class":"x-stacked"}),e=r.find(".x-backdrop"),h=!1;i.style&&u.addClass(i.style);u.on("click",function(n){$(this).is(n.target)&&!i.lock&&s()});if(r.length===0&&(r=$("<div />",{"class":"x-modals"}),e=$("<div />",{"class":"x-backdrop"}),i.style&&e.addClass(i.style),r.prepend(e),f.append(r),!i.lock))e.on("click",s);r.addClass("loading");f.addClass("fixed");r.prepend(u);i.mode==="replace"&&u.next().remove();c().then(function(n){if(h)return n;r.removeClass("loading");r.addClass("loaded");u.append(n.data);i.scope.modals=i.scope.modals||{};var f=i.scope.$new(!1);if(f.$dismiss=function(){return o(),!1},f.$accept=function(n){return o(),f.modals.accepted=!0,i.accept&&i.accept(n),!1},f.$decline=function(n){o();f.modals.accepted=!1;i.decline&&i.decline(n)},t(u)(f),i.scrollTo){const n=u.find("> *:visible .content").first();setTimeout(function(){const t=n.find(i.scrollTo)[0];t.scrollIntoView(!0)})}return n}).catch(function(){})}}]);angular.module("realescort.common").factory("recaptcha",[function(){return{reset:function(){window.grecaptcha&&window.grecaptcha.reset();$(window).trigger("recaptcha_reset")}}}]);angular.module("realescort.common").factory("request",["$http","$q",function(n,t){function i(i,r,u){function f(n){return r.fetching=!1,r.paging&&r.paging.total&&u.offset+u.count>=r.paging.total&&(r.finished=!0),n}function e(n){r.fetching=!1;n.status===404&&(r.finished=!0);throw n;}r.fetching=!0;r.finished=!1;r.timeout!==null&&r.timeout.resolve();var o={timeout:(r.timeout=t.defer()).promise};return n.post(i,u,o).then(f,e)}function r(n){throw n;}return function(n,u,f){var e=0,o={fetching:!1,finished:!1,timeout:null,paging:f};return{state:o,offset:function(){return e},reset:function(t){e=0;var s=angular.extend({},u);return f&&(s.offset=e,s.count=t||f.size),i(n,o,s).then(function(n){return e+=s.count,n}).catch(r)},next:function(s){if(o.fetching||o.finished)return t.reject({status:42});var h=angular.extend({},u);return f&&(h.offset=e,h.count=s||f.size),i(n,o,h).then(function(n){return e+=h.count,n}).catch(r)}}}}]);angular.module("realescort.common").factory("spy",["$window",function(n){function e(){r=setInterval(function(){if(i){i=!1;var n={scrollMin:t.scrollTop(),scrollMax:t.scrollTop()+t.height()};u.forEach(function(t){t(n)})}},100);f.on("scroll resize",function(){i=!0})}var t=$(n),r=null,i=!1,u=[],f=n.frameElement?$(n.frameElement).contents():$(n);return{track:function(n){u.push(n);r===null&&e()},move:function(n){n!==undefined&&t.scrollTop(n)},align:function(n,i,r){var f=this.move,u=function(){var o=Array.isArray(n)?n:[n],r;for(let n of o)if(r=$(n),r.length!=0){var u=r.offset(),s=r.height(),e=0;if(!u)return;e=i==="bottom"?u.top-t.height()+s:u.top;f(e);break}};r?$(r).imagesLoaded(u):u()},trigger:function(){f.trigger("scroll")}}}]);angular.module("realescort.forms").directive("reDuperform",["$http","component","recaptcha","modal2",function(n,t,i,r){function s(n){e.busy=n;u.toggleClass("busy",n);f.toggleClass("busy",n);n?(f.attr("disabled","disabled"),f.data("busy-on")&&f.text(f.data("busy-on"))):(f.removeAttr("disabled"),f.data("busy-off")&&f.text(f.data("busy-off")))}function y(){location.reload(!0)}function p(n){location.href=n.redirectUrl}function l(n){var t=u.find("input[name=Warned]");n&&t.length===0?u.append($("<input />",{name:"Warned",value:"true",type:"hidden"})):!n&&t.length>0&&t.remove()}function w(n){var v=u.find("input,select,textarea"),r;for(it(),a(),l(!1),i.reset(),r=0;r<n.controls.length;r++){var f=n.controls[r],h=u.find("[re-validate='"+f.name+"']"),e=v.filter("[name='"+f.name+"']"),o=e.closest("[re-validate],.x-annotate,.x-checkbox").add(h).add(e).first(),t=o.next(".x-message");t.length===0&&(t=$("<div />"),t.insertAfter(o));t.attr("class","x-message");t.addClass(n.type==="warning"?"warning":"error");t.html(f.message);o.addClass("x-invalid");e.addClass("x-invalid");h.addClass("x-invalid");t.show();rt(f.message)}n.type==="warning"&&l(!0);c?(nt(),g()):d();s(!1)}function b(){var n=f=u.find("button[busy]");n.attr("busy")&&(n.data("busy-on",n.attr("busy")),n.data("busy-off",n.text()))}function k(n,i){b();h=t(n,i,{success:[],submit:ft,reset:tt});c=u.attr("no-summary")===undefined}function a(){u.find(".x-invalid").removeClass("x-invalid");u.find(".x-message").hide()}function o(){var n=u.find(".x-summary");return n.length===0&&(n=$("<div><ul /><\/div>"),n.prependTo(u)),n.attr("class","x-summary"),n.addClass("error"),n}function d(){var n=u.find(".x-invalid");n.length>0&&n[0].scrollIntoView(!1)}function g(){var n=o();n[0].scrollIntoView(!1)}function nt(){var n=o();n.show()}function tt(){u.trigger("reset");a()}function it(){var n=o();n.children("ul").empty();n.hide()}function rt(n){var t=o(),i=$("<li />",{html:n});t.find("ul").append(i)}function ut(){h.success.forEach(function(n){n()});s(!1)}function ft(){u.trigger("submit")}function v(n){switch(n.type){case"redirect":p(n);break;case"reload":y(n);break;case"action":et(n.actionName,n.payload);break;case"error":case"warning":w(n);break;default:ut()}}function et(n,t){switch(n){case"modal":r({url:t.url,scope:e,mode:t.mode});break;case"$close":e.$accept(t);break;case"event":var i=new CustomEvent("submitted",{detail:t});u[0].dispatchEvent(i)}}var e,u,f,h,c;return{restrict:"A",link:function(t,i,r){e=t;u=i;attrs=r;k(attrs,e);i.on("submit",function(t){if(t.preventDefault(),e.busy)return!1;s(!0);var u={transformRequest:angular.identity,headers:{"Content-Type":undefined}};return n.post(r.action,new FormData(i[0]),u).then(function(n){v(n.data)}).catch(function(n){var t={type:"error",controls:[{name:""}]};t.controls[0].message=n.status===503?"We are updating our systems, please try again in a few minutes.":"An unknown error occurred. Please try again.";v(t)}),!1})}}}]);angular.module("realescort.forms").directive("reFiles",["$compile",function(n){return{restrict:"A",link:function(t,i,r){function f(){var n=$("<input />",{type:"file",accept:r.accept,multiple:"multiple"});i.append(n);n.on("change",function(){for(var t,n=0;n<this.files.length;n++)t=this.files[n],r.accept==="image/*"&&this.files[0].type.startsWith("image/")&&l(t)});return n}function c(){$(this).remove()}function l(i){var e=$("<div />",{"class":"file"}).html(o.html()),s=t.$new(),l=new FileReader;$(l).on("load",function(){s.previewUrl=l.result;s.fileName=i.name;s.remove=function(){c.apply(e[0])};n(e)(s);u.remove();u.attr("name",r.name);e.append(u);e.find("img.preview").attr("src",l.result);h.append(e);u=f();t.$apply()});l.readAsDataURL(i)}var e=i.closest("form"),o=i.find(".template"),s=i.find("a"),u=f(),h=i.find(".files");e.on("reset",function(){i.find(".file").remove()});s.on("click",function(){return u.trigger("click"),!1})}}}]);angular.module("realescort.forms").directive("reTurboform",["$http","component","recaptcha","modal2",function(n,t,i,r){function f(n,t){n.scope.busy=t;n.element.toggleClass("busy",t);n.button.toggleClass("busy",t);t?(n.button.attr("disabled","disabled"),n.button.data("busy-on")&&n.button.text(n.button.data("busy-on"))):(n.button.removeAttr("disabled"),n.button.data("busy-off")&&n.button.text(n.button.data("busy-off")))}function h(){location.reload(!0)}function c(n){location.href=n.redirectUrl}function e(n,t){var i=n.element.find("input[name=Warned]");t&&i.length===0?n.element.append($("<input />",{name:"Warned",value:"true",type:"hidden"})):!t&&i.length>0&&i.remove()}function l(n,t){var a=n.element.find("input,select,textarea"),s;for(k(n),o(n),e(n,!1),i.reset(),n.scope.errors={},s=0;s<t.controls.length;s++){var u=t.controls[s],l=n.element.find("[re-validate='"+u.name+"']"),h=a.filter("[name='"+u.name+"']"),c=h.closest("[re-validate],.x-annotate,.x-checkbox").add(l).add(h).first(),r=c.next(".x-message");r.length===0&&(r=$("<div />"),r.insertAfter(c));r.attr("class","x-message");r.addClass(t.type==="warning"?"warning":"error");r.html(u.message);c.addClass("x-invalid");h.addClass("x-invalid");l.addClass("x-invalid");n.scope.errors[u.name]=u.message;r.show();d(n,u.message)}t.type==="warning"&&e(n,!0);n.useSummary?(w(n),p(n)):y(n);f(n,!1)}function a(n){var t=n.button=n.element.find("button[busy]");t.attr("busy")&&(t.data("busy-on",t.attr("busy")),t.data("busy-off",t.text()))}function v(n){a(n);n.controller=t(n.attrs,n.scope,{success:[],submit:nt,reset:b});n.useSummary=n.element.attr("no-summary")===undefined}function o(n){n.element.find(".x-invalid").removeClass("x-invalid");n.element.find(".x-message").hide()}function u(n){var t=n.element.find(".x-summary");return t.length===0&&(t=$("<div><ul /><\/div>"),t.prependTo(n.element)),t.attr("class","x-summary"),t.addClass("error"),t}function y(n){var t=n.element.find(".x-invalid");t.length>0&&t[0].scrollIntoView(!1)}function p(n){var t=u(n);t[0].scrollIntoView(!1)}function w(n){var t=u(n);t.show()}function b(n){n.element.trigger("reset");o(n)}function k(n){var t=u(n);t.children("ul").empty();t.hide()}function d(n,t){var i=u(n),r=$("<li />",{html:t});i.find("ul").append(r)}function g(n){n.controller.success.forEach(function(n){n()});f(n,!1)}function nt(n){n.element.trigger("submit")}function s(n,t){switch(t.type){case"redirect":c(t);break;case"reload":h(t);break;case"action":tt(n,t.actionName,t.payload);break;case"error":case"warning":l(n,t);break;default:g(n)}}function tt(n,t,i){var u,f;switch(t){case"modal":u=i.mode=="replace"?n.scope.$parent:n.scope;r({url:i.url,scope:u,mode:i.mode,urlData:i.urlData});break;case"$close":n.scope.$accept(i);break;case"event":f=new CustomEvent("submitted",{detail:i});n.element[0].dispatchEvent(f)}}return{restrict:"A",link:function(t,i,r){var u={scope:t,element:i,attrs:r};v(u,r,t);i.on("submit",function(e){if(e.preventDefault(),t.busy)return!1;f(u,!0);var o={transformRequest:angular.identity,headers:{"Content-Type":undefined}};return n.post(r.action,new FormData(i[0]),o).then(function(n){s(u,n.data)}).catch(function(n){var t={type:"error",controls:[{name:""}]};t.controls[0].message=n.status===503?"We are updating our systems, please try again in a few minutes.":"An unknown error occurred. Please try again.";s(u,t)}),!1})}}}]);angular.module("realescort.views.accounts.ads").controller("AdContactCtrl",["$scope","injector","modal1",function(n,t){t(n);n.verifying=!1;n.doStuff=function(t){n.verifying=!t.originalEvent.detail.verified}}]);angular.module("realescort.views.accounts.ads").controller("AdEditCtrl",["$scope","injector","modal1","modal2","$http",function(n,t,i,r,u){t(n);n.contactMethods=n.contactMethods||[];n.contactType=n.contactTypes.find(n=>n.type=="phone");n.openServices=function(t){var i={url:"/account/ads/services",scope:n};t&&(i.scrollTo="#s-"+t);r(i)};n.updateContacts=function(){return u.get(n.listContactsUrl).then(function(t){n.contactMethods=t.data})};n.addWebsite=function(){var t={url:n.addWebsiteUrl,scope:n,accept:function(t){n.website=t},decline:function(){n.website=null}};r(t)};n.addContact=function(){var t={url:n.addContactUrl,scope:n,accept:function(t){n.contactMethods.push(t);t.verifyUrl&&n.verifyContact(t)}};r(t)};n.verifyContact=function(t){var i={url:t.verifyUrl,scope:n,accept:function(t){t.mode=="verify"?n.contactMethods=t.methods:t.mode=="resend"&&n.verifyContact(t.method)}};r(i)};n.hasPrimary=function(){return n.contactMethods.some(n=>n.isPrimary)};n.hasVerified=function(){return n.contactMethods.some(n=>n.mustVerify&&!n.verifyUrl)};n.hasPrimaryVerified=function(){return n.contactMethods.some(n=>n.isPrimary&&!n.verifyUrl)};n.removeContact=function(t){var r=n.contactMethods.indexOf(t),i;r>-1&&(n.contactMethods.splice(r,1),i=new FormData,i.append("contactId",t.id),u.post(n.removeContactUrl,i,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}))}}]);angular.module("realescort.views.accounts.ads").controller("AdRetentionCtrl",["$scope","injector","modal1","modal2","$http",function(n,t){function i(){var t=localStorage.getItem("retention");try{t=JSON.parse(t)||[];n.ads.forEach(function(n){n.selected=t.includes(n.id)});n.updatePrice()}catch{}}t(n);n.price=0;n.updatePrice=function(){n.price=n.ads.filter(n=>n.selected).reduce((n,t)=>n+t.price,0)};n.selectChanged=function(){n.updatePrice();var t=n.ads.filter(n=>n.selected).map(n=>n.id);localStorage.setItem("retention",JSON.stringify(t))};i()}]);angular.module("realescort.views.accounts.forgot").controller("ForgotCtrl",["$scope","injector",function(n,t){t(n)}]);angular.module("realescort.views.accounts.ads").directive("reEditView",[function(){return{restrict:"A",link:function(n,t){function r(){var f=i.filter(".day"),e=i.filter(".month"),o=i.filter(".year"),n=t.find(".bd.age");if(f.val()&&e.val()&&o.val()){var r=new Date,u=new Date(o.val(),e.val()-1,f.val()),s=r.getFullYear()-u.getFullYear(),h=r.getMonth()-u.getMonth(),c=r.getDate()-u.getDate();h<0||h==0&&c<0?n.val(s-1):n.val(s)}else n.val("")}var i=t.find(".bd.day, .bd.month, .bd.year");i.on("change",function(){r()});i.length&&r()}}}]);angular.module("realescort.views.accounts.ads").directive("reValidation",[function(){return{restrict:"A",link:function(n,t){function r(){var f=i.filter(".day"),e=i.filter(".month"),o=i.filter(".year"),n=t.find(".bd.age");if(f.val()&&e.val()&&o.val()){var r=new Date,u=new Date(o.val(),e.val()-1,f.val()),s=r.getFullYear()-u.getFullYear(),h=r.getMonth()-u.getMonth(),c=r.getDate()-u.getDate();h<0||h==0&&c<0?n.val(s-1):n.val(s)}else n.val("")}var i=t.find(".bd.day, .bd.month, .bd.year");i.on("change",function(){r()});i.length&&r()}}}]);angular.module("realescort.views.ads").controller("PhoneCtrl",["$scope","rest","inject","list",function(n,t,i){var r=i("vm-phone");n.model=r.verified;n.code=null;n.verify=function(){var i=r.dataUrl,u={recaptcha:n.code};t.post(i,u).then(function(t){t.error?n.error=t.error:n.model=t})}}]);angular.module("realescort.views.cart").controller("CartCtrl",["$scope","rest","inject","list","modal2",function(n,t,i,r,u){var f=i();n.refresh=function(){t.post(f.itemsUrl).then(function(t){n.showWarning=t.showWarning;n.warningUrl=t.warningUrl;n.items=t.items;n.upsell=t.upsell;n.updateTotals()})};n.updateTotals=function(){n.subtotal=r.sum(n.items,function(n){return n.price*n.quantity})};n.add=function(i,r){var e={productId:i,startDate:r};t.post(f.addUrl,e).then(function(t){t.errorUrl?u({url:t.errorUrl,scope:n}):(n.refresh(),location.href="#cart")})};n.remove=function(i){i.removing=!0;var r={itemId:i.id};t.post(f.removeUrl,r).then(function(){n.refresh()})};n.refresh()}]);angular.module("realescort.views.cart").controller("ItemCtrl",["$scope",function(n){n.addWithDate=function(t){n.add(t,n.startDate);n.startDate=null;n.showDate=!1};n.openDate=function(){n.showDate=!0}}]);angular.module("realescort.views.contact").controller("StaffCtrl",["$scope","inject",function(n,t){var i=t();n.showContact=i.showContact;n.form={init:function(){this.success.push(function(){n.showContact=!1;n.messageSent=!0})}}}]);angular.module("realescort.views.accounts.messages").directive("pop",["modal1",function(n){return{restrict:"A",link:function(t,i,r){i.on("click",function(){return n("/account/messages/image?url="+encodeURIComponent(r.pop)),!1})}}}]);angular.module("realescort.views.accounts.messages").directive("largeurl",["modal1",function(n){return{restrict:"A",link:function(t,i,r){i.on("click",function(){return r.largeurl.startsWith("data:")?n(r.largeurl):n("/account/messages/image?url="+encodeURIComponent(r.largeurl)),!1})}}}]);angular.module("realescort.views.accounts.messages").controller("ThreadCtrl",["$scope","$timeout","injector","spy","$http",function(n,t,i){i(n);n.p1={init:function(){this.load=function(){}}};n.p2={};n.form={init:function(){this.success.push(function(){n.p2.next();n.form.reset();n.ticketOpen=!0})}};n.reply=function(){n.ticketClosed=!1}}]);angular.module("realescort.views.status").controller("UnavailableCtrl",["$scope","$timeout","$http",function(n,t,i){function r(){t(f,1e4)}function f(){i(u).then(function(){location.reload(!0)},function(t){t.status===503?r():(n.ready=!0,location.reload(!0))})}n.ready=!1;var u={method:"GET",url:"/"};r()}]);angular.module("realescort.views.user").controller("AdItemCtrl",["$scope","rest",function(n,t){n.removing=!1;n.remove=function(i){n.removing=!0;t.get(i)}}]);angular.module("realescort.views.accounts.wallet").controller("TransferCtrl",["$scope","inject",function(n,t){function r(n){return Math.round(n*100)/100}var i=t();n.amount=i.amount;n.fee=0;n.deposit=0;n.update=function(){n.deposit=Math.max(r(n.amount)*i.rate,0);n.fee=Math.max(r(n.deposit*i.fee),1);n.deposit-=n.fee};n.update()}])